import{ct as Kw,cd as kw,cc as si,ca as zn,cu as st,cb as Bu,c7 as Jr,g as Hu,cv as Vw}from"./index-DnmWLAUw.js";import{e as zr,U as Ku}from"./events-DaA0pI3A.js";var ku={},sa={},Le={},Jd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,g){var p=f>>>16&65535,v=f&65535,D=g>>>16&65535,S=g&65535;return v*S+(p*S+v*D<<16>>>0)|0}i.mul=Math.imul||e;function t(f,g){return f+g|0}i.add=t;function s(f,g){return f-g|0}i.sub=s;function o(f,g){return f<<g|f>>>32-g}i.rotl=o;function c(f,g){return f<<32-g|f>>>g}i.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Jd);Object.defineProperty(Le,"__esModule",{value:!0});var Qd=Jd;function Gw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Le.readInt16BE=Gw;function Ww(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Le.readUint16BE=Ww;function Yw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Le.readInt16LE=Yw;function Jw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Le.readUint16LE=Jw;function Xd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Le.writeUint16BE=Xd;Le.writeInt16BE=Xd;function Zd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Le.writeUint16LE=Zd;Le.writeInt16LE=Zd;function lu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Le.readInt32BE=lu;function fu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Le.readUint32BE=fu;function du(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Le.readInt32LE=du;function pu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Le.readUint32LE=pu;function Xo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Le.writeUint32BE=Xo;Le.writeInt32BE=Xo;function Zo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Le.writeUint32LE=Zo;Le.writeInt32LE=Zo;function Qw(i,e){e===void 0&&(e=0);var t=lu(i,e),s=lu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=Qw;function Xw(i,e){e===void 0&&(e=0);var t=fu(i,e),s=fu(i,e+4);return t*4294967296+s}Le.readUint64BE=Xw;function Zw(i,e){e===void 0&&(e=0);var t=du(i,e),s=du(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=Zw;function eb(i,e){e===void 0&&(e=0);var t=pu(i,e),s=pu(i,e+4);return s*4294967296+t}Le.readUint64LE=eb;function ep(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Xo(i/4294967296>>>0,e,t),Xo(i>>>0,e,t+4),e}Le.writeUint64BE=ep;Le.writeInt64BE=ep;function tp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Zo(i>>>0,e,t),Zo(i/4294967296>>>0,e,t+4),e}Le.writeUint64LE=tp;Le.writeInt64LE=tp;function tb(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=tb;function rb(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=rb;function ib(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Qd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=ib;function nb(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Qd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=nb;function sb(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Le.readFloat32BE=sb;function ob(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=ob;function ab(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Le.readFloat64BE=ab;function cb(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=cb;function ub(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Le.writeFloat32BE=ub;function hb(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Le.writeFloat32LE=hb;function lb(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Le.writeFloat64BE=lb;function fb(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Le.writeFloat64LE=fb;var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function db(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Ar.wipe=db;Object.defineProperty(sa,"__esModule",{value:!0});var er=Le,gu=Ar,pb=20;function gb(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],D=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],x=t[27]<<24|t[26]<<16|t[25]<<8|t[24],O=t[31]<<24|t[30]<<16|t[29]<<8|t[28],F=e[3]<<24|e[2]<<16|e[1]<<8|e[0],H=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,C=o,T=c,E=l,u=f,w=g,G=p,W=v,se=D,ue=S,de=x,b=O,A=F,ee=H,Q=ie,k=$,V=0;V<pb;V+=2)M=M+u|0,A^=M,A=A>>>16|A<<16,se=se+A|0,u^=se,u=u>>>20|u<<12,C=C+w|0,ee^=C,ee=ee>>>16|ee<<16,ue=ue+ee|0,w^=ue,w=w>>>20|w<<12,T=T+G|0,Q^=T,Q=Q>>>16|Q<<16,de=de+Q|0,G^=de,G=G>>>20|G<<12,E=E+W|0,k^=E,k=k>>>16|k<<16,b=b+k|0,W^=b,W=W>>>20|W<<12,T=T+G|0,Q^=T,Q=Q>>>24|Q<<8,de=de+Q|0,G^=de,G=G>>>25|G<<7,E=E+W|0,k^=E,k=k>>>24|k<<8,b=b+k|0,W^=b,W=W>>>25|W<<7,C=C+w|0,ee^=C,ee=ee>>>24|ee<<8,ue=ue+ee|0,w^=ue,w=w>>>25|w<<7,M=M+u|0,A^=M,A=A>>>24|A<<8,se=se+A|0,u^=se,u=u>>>25|u<<7,M=M+w|0,k^=M,k=k>>>16|k<<16,de=de+k|0,w^=de,w=w>>>20|w<<12,C=C+G|0,A^=C,A=A>>>16|A<<16,b=b+A|0,G^=b,G=G>>>20|G<<12,T=T+W|0,ee^=T,ee=ee>>>16|ee<<16,se=se+ee|0,W^=se,W=W>>>20|W<<12,E=E+u|0,Q^=E,Q=Q>>>16|Q<<16,ue=ue+Q|0,u^=ue,u=u>>>20|u<<12,T=T+W|0,ee^=T,ee=ee>>>24|ee<<8,se=se+ee|0,W^=se,W=W>>>25|W<<7,E=E+u|0,Q^=E,Q=Q>>>24|Q<<8,ue=ue+Q|0,u^=ue,u=u>>>25|u<<7,C=C+G|0,A^=C,A=A>>>24|A<<8,b=b+A|0,G^=b,G=G>>>25|G<<7,M=M+w|0,k^=M,k=k>>>24|k<<8,de=de+k|0,w^=de,w=w>>>25|w<<7;er.writeUint32LE(M+s|0,i,0),er.writeUint32LE(C+o|0,i,4),er.writeUint32LE(T+c|0,i,8),er.writeUint32LE(E+l|0,i,12),er.writeUint32LE(u+f|0,i,16),er.writeUint32LE(w+g|0,i,20),er.writeUint32LE(G+p|0,i,24),er.writeUint32LE(W+v|0,i,28),er.writeUint32LE(se+D|0,i,32),er.writeUint32LE(ue+S|0,i,36),er.writeUint32LE(de+x|0,i,40),er.writeUint32LE(b+O|0,i,44),er.writeUint32LE(A+F|0,i,48),er.writeUint32LE(ee+H|0,i,52),er.writeUint32LE(Q+ie|0,i,56),er.writeUint32LE(k+$|0,i,60)}function rp(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),g=0;g<t.length;g+=64){gb(f,c,i);for(var p=g;p<g+64&&p<t.length;p++)s[p]=t[p]^f[p-g];vb(c,0,l)}return gu.wipe(f),o===0&&gu.wipe(c),s}sa.streamXOR=rp;function yb(i,e,t,s){return s===void 0&&(s=0),gu.wipe(t),rp(i,e,t,t,s)}sa.stream=yb;function vb(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var ip={},zi={};Object.defineProperty(zi,"__esModule",{value:!0});function _b(i,e,t){return~(i-1)&e|i-1&t}zi.select=_b;function mb(i,e){return(i|0)-(e|0)-1>>>31&1}zi.lessOrEqual=mb;function np(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}zi.compare=np;function wb(i,e){return i.length===0||e.length===0?!1:np(i,e)!==0}zi.equal=wb;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=zi,t=Ar;i.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var p=f[2]|f[3]<<8;this._r[1]=(g>>>13|p<<3)&8191;var v=f[4]|f[5]<<8;this._r[2]=(p>>>10|v<<6)&7939;var D=f[6]|f[7]<<8;this._r[3]=(v>>>7|D<<9)&8191;var S=f[8]|f[9]<<8;this._r[4]=(D>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var x=f[10]|f[11]<<8;this._r[6]=(S>>>14|x<<2)&8191;var O=f[12]|f[13]<<8;this._r[7]=(x>>>11|O<<5)&8065;var F=f[14]|f[15]<<8;this._r[8]=(O>>>8|F<<8)&8191,this._r[9]=F>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,g,p){for(var v=this._fin?0:2048,D=this._h[0],S=this._h[1],x=this._h[2],O=this._h[3],F=this._h[4],H=this._h[5],ie=this._h[6],$=this._h[7],M=this._h[8],C=this._h[9],T=this._r[0],E=this._r[1],u=this._r[2],w=this._r[3],G=this._r[4],W=this._r[5],se=this._r[6],ue=this._r[7],de=this._r[8],b=this._r[9];p>=16;){var A=f[g+0]|f[g+1]<<8;D+=A&8191;var ee=f[g+2]|f[g+3]<<8;S+=(A>>>13|ee<<3)&8191;var Q=f[g+4]|f[g+5]<<8;x+=(ee>>>10|Q<<6)&8191;var k=f[g+6]|f[g+7]<<8;O+=(Q>>>7|k<<9)&8191;var V=f[g+8]|f[g+9]<<8;F+=(k>>>4|V<<12)&8191,H+=V>>>1&8191;var J=f[g+10]|f[g+11]<<8;ie+=(V>>>14|J<<2)&8191;var re=f[g+12]|f[g+13]<<8;$+=(J>>>11|re<<5)&8191;var we=f[g+14]|f[g+15]<<8;M+=(re>>>8|we<<8)&8191,C+=we>>>5|v;var oe=0,be=oe;be+=D*T,be+=S*(5*b),be+=x*(5*de),be+=O*(5*ue),be+=F*(5*se),oe=be>>>13,be&=8191,be+=H*(5*W),be+=ie*(5*G),be+=$*(5*w),be+=M*(5*u),be+=C*(5*E),oe+=be>>>13,be&=8191;var le=oe;le+=D*E,le+=S*T,le+=x*(5*b),le+=O*(5*de),le+=F*(5*ue),oe=le>>>13,le&=8191,le+=H*(5*se),le+=ie*(5*W),le+=$*(5*G),le+=M*(5*w),le+=C*(5*u),oe+=le>>>13,le&=8191;var _e=oe;_e+=D*u,_e+=S*E,_e+=x*T,_e+=O*(5*b),_e+=F*(5*de),oe=_e>>>13,_e&=8191,_e+=H*(5*ue),_e+=ie*(5*se),_e+=$*(5*W),_e+=M*(5*G),_e+=C*(5*w),oe+=_e>>>13,_e&=8191;var B=oe;B+=D*w,B+=S*u,B+=x*E,B+=O*T,B+=F*(5*b),oe=B>>>13,B&=8191,B+=H*(5*de),B+=ie*(5*ue),B+=$*(5*se),B+=M*(5*W),B+=C*(5*G),oe+=B>>>13,B&=8191;var z=oe;z+=D*G,z+=S*w,z+=x*u,z+=O*E,z+=F*T,oe=z>>>13,z&=8191,z+=H*(5*b),z+=ie*(5*de),z+=$*(5*ue),z+=M*(5*se),z+=C*(5*W),oe+=z>>>13,z&=8191;var U=oe;U+=D*W,U+=S*G,U+=x*w,U+=O*u,U+=F*E,oe=U>>>13,U&=8191,U+=H*T,U+=ie*(5*b),U+=$*(5*de),U+=M*(5*ue),U+=C*(5*se),oe+=U>>>13,U&=8191;var d=oe;d+=D*se,d+=S*W,d+=x*G,d+=O*w,d+=F*u,oe=d>>>13,d&=8191,d+=H*E,d+=ie*T,d+=$*(5*b),d+=M*(5*de),d+=C*(5*ue),oe+=d>>>13,d&=8191;var R=oe;R+=D*ue,R+=S*se,R+=x*W,R+=O*G,R+=F*w,oe=R>>>13,R&=8191,R+=H*u,R+=ie*E,R+=$*T,R+=M*(5*b),R+=C*(5*de),oe+=R>>>13,R&=8191;var ae=oe;ae+=D*de,ae+=S*ue,ae+=x*se,ae+=O*W,ae+=F*G,oe=ae>>>13,ae&=8191,ae+=H*w,ae+=ie*u,ae+=$*E,ae+=M*T,ae+=C*(5*b),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=D*b,fe+=S*de,fe+=x*ue,fe+=O*se,fe+=F*W,oe=fe>>>13,fe&=8191,fe+=H*G,fe+=ie*w,fe+=$*u,fe+=M*E,fe+=C*T,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+be|0,be=oe&8191,oe=oe>>>13,le+=oe,D=be,S=le,x=_e,O=B,F=z,H=U,ie=d,$=R,M=ae,C=fe,g+=16,p-=16}this._h[0]=D,this._h[1]=S,this._h[2]=x,this._h[3]=O,this._h[4]=F,this._h[5]=H,this._h[6]=ie,this._h[7]=$,this._h[8]=M,this._h[9]=C},l.prototype.finish=function(f,g){g===void 0&&(g=0);var p=new Uint16Array(10),v,D,S,x;if(this._leftover){for(x=this._leftover,this._buffer[x++]=1;x<16;x++)this._buffer[x]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(v=this._h[1]>>>13,this._h[1]&=8191,x=2;x<10;x++)this._h[x]+=v,v=this._h[x]>>>13,this._h[x]&=8191;for(this._h[0]+=v*5,v=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=v,v=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=v,p[0]=this._h[0]+5,v=p[0]>>>13,p[0]&=8191,x=1;x<10;x++)p[x]=this._h[x]+v,v=p[x]>>>13,p[x]&=8191;for(p[9]-=8192,D=(v^1)-1,x=0;x<10;x++)p[x]&=D;for(D=~D,x=0;x<10;x++)this._h[x]=this._h[x]&D|p[x];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,x=1;x<8;x++)S=(this._h[x]+this._pad[x]|0)+(S>>>16)|0,this._h[x]=S&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var g=0,p=f.length,v;if(this._leftover){v=16-this._leftover,v>p&&(v=p);for(var D=0;D<v;D++)this._buffer[this._leftover+D]=f[g+D];if(p-=v,g+=v,this._leftover+=v,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(v=p-p%16,this._blocks(f,g,v),g+=v,p-=v),p){for(var D=0;D<p;D++)this._buffer[this._leftover+D]=f[g+D];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,f){var g=new s(l);g.update(f);var p=g.digest();return g.clean(),p}i.oneTimeAuth=o;function c(l,f){return l.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(l,f)}i.equal=c})(ip);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=sa,t=ip,s=Ar,o=Le,c=zi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function g(p){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,p.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return g.prototype.seal=function(p,v,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var F=v.length+this.tagLength,H;if(S){if(S.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");H=S}else H=new Uint8Array(F);return e.streamXOR(this._key,x,v,H,4),this._authenticate(H.subarray(H.length-this.tagLength,H.length),O,H.subarray(0,H.length-this.tagLength),D),s.wipe(x),H},g.prototype.open=function(p,v,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(v.length<this.tagLength)return null;var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var F=new Uint8Array(this.tagLength);if(this._authenticate(F,O,v.subarray(0,v.length-this.tagLength),D),!c.equal(F,v.subarray(v.length-this.tagLength,v.length)))return null;var H=v.length-this.tagLength,ie;if(S){if(S.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=S}else ie=new Uint8Array(H);return e.streamXOR(this._key,x,v.subarray(0,v.length-this.tagLength),ie,4),s.wipe(x),ie},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(p,v,D,S){var x=new t.Poly1305(v);S&&(x.update(S),S.length%16>0&&x.update(l.subarray(S.length%16))),x.update(D),D.length%16>0&&x.update(l.subarray(D.length%16));var O=new Uint8Array(8);S&&o.writeUint64LE(S.length,O),x.update(O),o.writeUint64LE(D.length,O),x.update(O);for(var F=x.digest(),H=0;H<F.length;H++)p[H]=F[H];x.clean(),s.wipe(F),s.wipe(O)},g}();i.ChaCha20Poly1305=f})(ku);var sp={},Ts={},Vu={};Object.defineProperty(Vu,"__esModule",{value:!0});function bb(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Vu.isSerializableHash=bb;Object.defineProperty(Ts,"__esModule",{value:!0});var ii=Vu,Eb=zi,Db=Ar,op=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ii.isSerializableHash(this._inner)&&ii.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Db.wipe(s)}return i.prototype.reset=function(){if(!ii.isSerializableHash(this._inner)||!ii.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ii.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ii.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ii.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ii.isSerializableHash(this._inner)||!ii.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ii.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Ts.HMAC=op;function Sb(i,e,t){var s=new op(i,e);s.update(t);var o=s.digest();return s.clean(),o}Ts.hmac=Sb;Ts.equal=Eb.equal;Object.defineProperty(sp,"__esModule",{value:!0});var ff=Ts,df=Ar,Ib=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=ff.hmac(this._hash,s,t);this._hmac=new ff.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),df.wipe(this._buffer),df.wipe(this._counter),this._bufpos=0},i}(),xb=sp.HKDF=Ib,Bn={},oa={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.BrowserRandomSource=void 0;const pf=65536;class Ob{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=pf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,pf)));return t}}aa.BrowserRandomSource=Ob;var ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.NodeRandomSource=void 0;const Pb=Ar;class Cb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Kw<"u"){const e=kw;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,Pb.wipe)(t),s}}ca.NodeRandomSource=Cb;Object.defineProperty(oa,"__esModule",{value:!0});oa.SystemRandomSource=void 0;const Ab=aa,Tb=ca;class Rb{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ab.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Tb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}oa.SystemRandomSource=Rb;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=oa,t=Le,s=Ar;i.defaultRandomSource=new e.SystemRandomSource;function o(p,v=i.defaultRandomSource){return v.randomBytes(p)}i.randomBytes=o;function c(p=i.defaultRandomSource){const v=o(4,p),D=(0,t.readUint32LE)(v);return(0,s.wipe)(v),D}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,v=l,D=i.defaultRandomSource){if(v.length<2)throw new Error("randomString charset is too short");if(v.length>256)throw new Error("randomString charset is too long");let S="";const x=v.length,O=256-256%x;for(;p>0;){const F=o(Math.ceil(p*256/O),D);for(let H=0;H<F.length&&p>0;H++){const ie=F[H];ie<O&&(S+=v.charAt(ie%x),p--)}(0,s.wipe)(F)}return S}i.randomString=f;function g(p,v=l,D=i.defaultRandomSource){const S=Math.ceil(p/(Math.log(v.length)/Math.LN2));return f(S,v,D)}i.randomStringForEntropy=g})(Bn);var ua={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Ar;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._temp,this._state,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,D=p/536870912|0,S=p<<3,x=p%64<56?64:128;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,x-8),e.writeUint32BE(S,this._buffer,x-4),c(this._temp,this._state,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],g,O*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,g,p,v,D){for(;D>=64;){for(var S=g[0],x=g[1],O=g[2],F=g[3],H=g[4],ie=g[5],$=g[6],M=g[7],C=0;C<16;C++){var T=v+C*4;f[C]=e.readUint32BE(p,T)}for(var C=16;C<64;C++){var E=f[C-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[C-15];var w=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[C]=(u+f[C-7]|0)+(w+f[C-16]|0)}for(var C=0;C<64;C++){var u=(((H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7))+(H&ie^~H&$)|0)+(M+(o[C]+f[C]|0)|0)|0,w=((S>>>2|S<<30)^(S>>>13|S<<19)^(S>>>22|S<<10))+(S&x^S&O^x&O)|0;M=$,$=ie,ie=H,H=F+u|0,F=O,O=x,x=S,S=u+w|0}g[0]+=S,g[1]+=x,g[2]+=O,g[3]+=F,g[4]+=H,g[5]+=ie,g[6]+=$,g[7]+=M,v+=64,D-=64}return v}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})(ua);var Gu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=Bn,t=Ar;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(C){const T=new Float64Array(16);if(C)for(let E=0;E<C.length;E++)T[E]=C[E];return T}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(C){let T=1;for(let E=0;E<16;E++){let u=C[E]+T+65535;T=Math.floor(u/65536),C[E]=u-T*65536}C[0]+=T-1+37*(T-1)}function f(C,T,E){const u=~(E-1);for(let w=0;w<16;w++){const G=u&(C[w]^T[w]);C[w]^=G,T[w]^=G}}function g(C,T){const E=s(),u=s();for(let w=0;w<16;w++)u[w]=T[w];l(u),l(u),l(u);for(let w=0;w<2;w++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const G=E[15]>>16&1;E[14]&=65535,f(u,E,1-G)}for(let w=0;w<16;w++)C[2*w]=u[w]&255,C[2*w+1]=u[w]>>8}function p(C,T){for(let E=0;E<16;E++)C[E]=T[2*E]+(T[2*E+1]<<8);C[15]&=32767}function v(C,T,E){for(let u=0;u<16;u++)C[u]=T[u]+E[u]}function D(C,T,E){for(let u=0;u<16;u++)C[u]=T[u]-E[u]}function S(C,T,E){let u,w,G=0,W=0,se=0,ue=0,de=0,b=0,A=0,ee=0,Q=0,k=0,V=0,J=0,re=0,we=0,oe=0,be=0,le=0,_e=0,B=0,z=0,U=0,d=0,R=0,ae=0,fe=0,Ie=0,Be=0,ke=0,je=0,gt=0,yt=0,qe=E[0],xe=E[1],Ne=E[2],$e=E[3],Fe=E[4],Pe=E[5],Ue=E[6],Se=E[7],Ce=E[8],He=E[9],Oe=E[10],Ve=E[11],We=E[12],et=E[13],tt=E[14],Qe=E[15];u=T[0],G+=u*qe,W+=u*xe,se+=u*Ne,ue+=u*$e,de+=u*Fe,b+=u*Pe,A+=u*Ue,ee+=u*Se,Q+=u*Ce,k+=u*He,V+=u*Oe,J+=u*Ve,re+=u*We,we+=u*et,oe+=u*tt,be+=u*Qe,u=T[1],W+=u*qe,se+=u*xe,ue+=u*Ne,de+=u*$e,b+=u*Fe,A+=u*Pe,ee+=u*Ue,Q+=u*Se,k+=u*Ce,V+=u*He,J+=u*Oe,re+=u*Ve,we+=u*We,oe+=u*et,be+=u*tt,le+=u*Qe,u=T[2],se+=u*qe,ue+=u*xe,de+=u*Ne,b+=u*$e,A+=u*Fe,ee+=u*Pe,Q+=u*Ue,k+=u*Se,V+=u*Ce,J+=u*He,re+=u*Oe,we+=u*Ve,oe+=u*We,be+=u*et,le+=u*tt,_e+=u*Qe,u=T[3],ue+=u*qe,de+=u*xe,b+=u*Ne,A+=u*$e,ee+=u*Fe,Q+=u*Pe,k+=u*Ue,V+=u*Se,J+=u*Ce,re+=u*He,we+=u*Oe,oe+=u*Ve,be+=u*We,le+=u*et,_e+=u*tt,B+=u*Qe,u=T[4],de+=u*qe,b+=u*xe,A+=u*Ne,ee+=u*$e,Q+=u*Fe,k+=u*Pe,V+=u*Ue,J+=u*Se,re+=u*Ce,we+=u*He,oe+=u*Oe,be+=u*Ve,le+=u*We,_e+=u*et,B+=u*tt,z+=u*Qe,u=T[5],b+=u*qe,A+=u*xe,ee+=u*Ne,Q+=u*$e,k+=u*Fe,V+=u*Pe,J+=u*Ue,re+=u*Se,we+=u*Ce,oe+=u*He,be+=u*Oe,le+=u*Ve,_e+=u*We,B+=u*et,z+=u*tt,U+=u*Qe,u=T[6],A+=u*qe,ee+=u*xe,Q+=u*Ne,k+=u*$e,V+=u*Fe,J+=u*Pe,re+=u*Ue,we+=u*Se,oe+=u*Ce,be+=u*He,le+=u*Oe,_e+=u*Ve,B+=u*We,z+=u*et,U+=u*tt,d+=u*Qe,u=T[7],ee+=u*qe,Q+=u*xe,k+=u*Ne,V+=u*$e,J+=u*Fe,re+=u*Pe,we+=u*Ue,oe+=u*Se,be+=u*Ce,le+=u*He,_e+=u*Oe,B+=u*Ve,z+=u*We,U+=u*et,d+=u*tt,R+=u*Qe,u=T[8],Q+=u*qe,k+=u*xe,V+=u*Ne,J+=u*$e,re+=u*Fe,we+=u*Pe,oe+=u*Ue,be+=u*Se,le+=u*Ce,_e+=u*He,B+=u*Oe,z+=u*Ve,U+=u*We,d+=u*et,R+=u*tt,ae+=u*Qe,u=T[9],k+=u*qe,V+=u*xe,J+=u*Ne,re+=u*$e,we+=u*Fe,oe+=u*Pe,be+=u*Ue,le+=u*Se,_e+=u*Ce,B+=u*He,z+=u*Oe,U+=u*Ve,d+=u*We,R+=u*et,ae+=u*tt,fe+=u*Qe,u=T[10],V+=u*qe,J+=u*xe,re+=u*Ne,we+=u*$e,oe+=u*Fe,be+=u*Pe,le+=u*Ue,_e+=u*Se,B+=u*Ce,z+=u*He,U+=u*Oe,d+=u*Ve,R+=u*We,ae+=u*et,fe+=u*tt,Ie+=u*Qe,u=T[11],J+=u*qe,re+=u*xe,we+=u*Ne,oe+=u*$e,be+=u*Fe,le+=u*Pe,_e+=u*Ue,B+=u*Se,z+=u*Ce,U+=u*He,d+=u*Oe,R+=u*Ve,ae+=u*We,fe+=u*et,Ie+=u*tt,Be+=u*Qe,u=T[12],re+=u*qe,we+=u*xe,oe+=u*Ne,be+=u*$e,le+=u*Fe,_e+=u*Pe,B+=u*Ue,z+=u*Se,U+=u*Ce,d+=u*He,R+=u*Oe,ae+=u*Ve,fe+=u*We,Ie+=u*et,Be+=u*tt,ke+=u*Qe,u=T[13],we+=u*qe,oe+=u*xe,be+=u*Ne,le+=u*$e,_e+=u*Fe,B+=u*Pe,z+=u*Ue,U+=u*Se,d+=u*Ce,R+=u*He,ae+=u*Oe,fe+=u*Ve,Ie+=u*We,Be+=u*et,ke+=u*tt,je+=u*Qe,u=T[14],oe+=u*qe,be+=u*xe,le+=u*Ne,_e+=u*$e,B+=u*Fe,z+=u*Pe,U+=u*Ue,d+=u*Se,R+=u*Ce,ae+=u*He,fe+=u*Oe,Ie+=u*Ve,Be+=u*We,ke+=u*et,je+=u*tt,gt+=u*Qe,u=T[15],be+=u*qe,le+=u*xe,_e+=u*Ne,B+=u*$e,z+=u*Fe,U+=u*Pe,d+=u*Ue,R+=u*Se,ae+=u*Ce,fe+=u*He,Ie+=u*Oe,Be+=u*Ve,ke+=u*We,je+=u*et,gt+=u*tt,yt+=u*Qe,G+=38*le,W+=38*_e,se+=38*B,ue+=38*z,de+=38*U,b+=38*d,A+=38*R,ee+=38*ae,Q+=38*fe,k+=38*Ie,V+=38*Be,J+=38*ke,re+=38*je,we+=38*gt,oe+=38*yt,w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=se+w+65535,w=Math.floor(u/65536),se=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=de+w+65535,w=Math.floor(u/65536),de=u-w*65536,u=b+w+65535,w=Math.floor(u/65536),b=u-w*65536,u=A+w+65535,w=Math.floor(u/65536),A=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=k+w+65535,w=Math.floor(u/65536),k=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=J+w+65535,w=Math.floor(u/65536),J=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=be+w+65535,w=Math.floor(u/65536),be=u-w*65536,G+=w-1+37*(w-1),w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=se+w+65535,w=Math.floor(u/65536),se=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=de+w+65535,w=Math.floor(u/65536),de=u-w*65536,u=b+w+65535,w=Math.floor(u/65536),b=u-w*65536,u=A+w+65535,w=Math.floor(u/65536),A=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=k+w+65535,w=Math.floor(u/65536),k=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=J+w+65535,w=Math.floor(u/65536),J=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=be+w+65535,w=Math.floor(u/65536),be=u-w*65536,G+=w-1+37*(w-1),C[0]=G,C[1]=W,C[2]=se,C[3]=ue,C[4]=de,C[5]=b,C[6]=A,C[7]=ee,C[8]=Q,C[9]=k,C[10]=V,C[11]=J,C[12]=re,C[13]=we,C[14]=oe,C[15]=be}function x(C,T){S(C,T,T)}function O(C,T){const E=s();for(let u=0;u<16;u++)E[u]=T[u];for(let u=253;u>=0;u--)x(E,E),u!==2&&u!==4&&S(E,E,T);for(let u=0;u<16;u++)C[u]=E[u]}function F(C,T){const E=new Uint8Array(32),u=new Float64Array(80),w=s(),G=s(),W=s(),se=s(),ue=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=C[Q];E[31]=C[31]&127|64,E[0]&=248,p(u,T);for(let Q=0;Q<16;Q++)G[Q]=u[Q];w[0]=se[0]=1;for(let Q=254;Q>=0;--Q){const k=E[Q>>>3]>>>(Q&7)&1;f(w,G,k),f(W,se,k),v(ue,w,W),D(w,w,W),v(W,G,se),D(G,G,se),x(se,ue),x(de,w),S(w,W,w),S(W,G,ue),v(ue,w,W),D(w,w,W),x(G,w),D(W,se,de),S(w,W,c),v(w,w,se),S(W,W,w),S(w,se,de),S(se,G,u),x(G,ue),f(w,G,k),f(W,se,k)}for(let Q=0;Q<16;Q++)u[Q+16]=w[Q],u[Q+32]=W[Q],u[Q+48]=G[Q],u[Q+64]=se[Q];const b=u.subarray(32),A=u.subarray(16);O(b,b),S(A,A,b);const ee=new Uint8Array(32);return g(ee,A),ee}i.scalarMult=F;function H(C){return F(C,o)}i.scalarMultBase=H;function ie(C){if(C.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const T=new Uint8Array(C);return{publicKey:H(T),secretKey:T}}i.generateKeyPairFromSeed=ie;function $(C){const T=(0,e.randomBytes)(32,C),E=ie(T);return(0,t.wipe)(T),E}i.generateKeyPair=$;function M(C,T,E=!1){if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(T.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=F(C,T);if(E){let w=0;for(let G=0;G<u.length;G++)w|=u[G];if(w===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=M})(Gu);function Wu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function ap(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function yu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=ap(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return Wu(t)}function Nb(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var F=0,H=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,F++;for(var M=($-ie)*v+1>>>0,C=new Uint8Array(M);ie!==$;){for(var T=O[ie],E=0,u=M-1;(T!==0||E<H)&&u!==-1;u--,E++)T+=256*C[u]>>>0,C[u]=T%f>>>0,T=T/f>>>0;if(T!==0)throw new Error("Non-zero carry");H=E,ie++}for(var w=M-H;w!==M&&C[w]===0;)w++;for(var G=g.repeat(F);w<M;++w)G+=i.charAt(C[w]);return G}function S(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var F=0;if(O[F]!==" "){for(var H=0,ie=0;O[F]===g;)H++,F++;for(var $=(O.length-F)*p+1>>>0,M=new Uint8Array($);O[F];){var C=t[O.charCodeAt(F)];if(C===255)return;for(var T=0,E=$-1;(C!==0||T<ie)&&E!==-1;E--,T++)C+=f*M[E]>>>0,M[E]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");ie=T,F++}if(O[F]!==" "){for(var u=$-ie;u!==$&&M[u]===0;)u++;for(var w=new Uint8Array(H+($-u)),G=H;u!==$;)w[G++]=M[u++];return w}}}function x(O){var F=S(O);if(F)return F;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:x}}var $b=Nb,Ub=$b;const Lb=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},jb=i=>new TextEncoder().encode(i),Mb=i=>new TextDecoder().decode(i);class qb{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Fb{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cp(this,e)}}class zb{constructor(e){this.decoders=e}or(e){return cp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cp=(i,e)=>new zb({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class Bb{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new qb(e,t,s),this.decoder=new Fb(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ha=({name:i,prefix:e,encode:t,decode:s})=>new Bb(i,e,t,s),Rs=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=Ub(t,e);return ha({prefix:i,name:e,encode:s,decode:c=>Lb(o(c))})},Hb=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const D=o[i[v]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|D,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},Kb=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ha({prefix:e,name:i,encode(o){return Kb(o,s,t)},decode(o){return Hb(o,s,t,i)}}),kb=ha({prefix:"\0",name:"identity",encode:i=>Mb(i),decode:i=>jb(i)}),Vb=Object.freeze(Object.defineProperty({__proto__:null,identity:kb},Symbol.toStringTag,{value:"Module"})),Gb=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Wb=Object.freeze(Object.defineProperty({__proto__:null,base2:Gb},Symbol.toStringTag,{value:"Module"})),Yb=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Jb=Object.freeze(Object.defineProperty({__proto__:null,base8:Yb},Symbol.toStringTag,{value:"Module"})),Qb=Rs({prefix:"9",name:"base10",alphabet:"0123456789"}),Xb=Object.freeze(Object.defineProperty({__proto__:null,base10:Qb},Symbol.toStringTag,{value:"Module"})),Zb=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),e1=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),t1=Object.freeze(Object.defineProperty({__proto__:null,base16:Zb,base16upper:e1},Symbol.toStringTag,{value:"Module"})),r1=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i1=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),n1=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),s1=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),o1=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),a1=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),c1=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u1=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),h1=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),l1=Object.freeze(Object.defineProperty({__proto__:null,base32:r1,base32hex:o1,base32hexpad:c1,base32hexpadupper:u1,base32hexupper:a1,base32pad:n1,base32padupper:s1,base32upper:i1,base32z:h1},Symbol.toStringTag,{value:"Module"})),f1=Rs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),d1=Rs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),p1=Object.freeze(Object.defineProperty({__proto__:null,base36:f1,base36upper:d1},Symbol.toStringTag,{value:"Module"})),g1=Rs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),y1=Rs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),v1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:g1,base58flickr:y1},Symbol.toStringTag,{value:"Module"})),_1=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),m1=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),w1=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),b1=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),E1=Object.freeze(Object.defineProperty({__proto__:null,base64:_1,base64pad:m1,base64url:w1,base64urlpad:b1},Symbol.toStringTag,{value:"Module"})),up=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),D1=up.reduce((i,e,t)=>(i[t]=e,i),[]),S1=up.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function I1(i){return i.reduce((e,t)=>(e+=D1[t],e),"")}function x1(i){const e=[];for(const t of i){const s=S1[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const O1=ha({prefix:"🚀",name:"base256emoji",encode:I1,decode:x1}),P1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:O1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const gf={...Vb,...Wb,...Jb,...Xb,...t1,...l1,...p1,...v1,...E1,...P1};function hp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const yf=hp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Bc=hp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=ap(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),lp={utf8:yf,"utf-8":yf,hex:gf.base16,latin1:Bc,ascii:Bc,binary:Bc,...gf};function br(i,e="utf8"){const t=lp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wu(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function fr(i,e="utf8"){const t=lp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var vf=function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},C1=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),A1=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=si.platform}return i}(),T1=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),R1=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),N1=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),$1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,U1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,_f=3,L1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$1]],mf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function j1(i){return i?wf(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new N1:typeof navigator<"u"?wf(navigator.userAgent):F1()}function M1(i){return i!==""&&L1.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function wf(i){var e=M1(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new R1;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<_f&&(o=vf(vf([],o,!0),z1(_f-o.length),!0)):o=[];var c=o.join("."),l=q1(i),f=U1.exec(i);return f&&f[1]?new T1(t,c,l,f[1]):new C1(t,c,l)}function q1(i){for(var e=0,t=mf.length;e<t;e++){var s=mf[e],o=s[0],c=s[1],l=c.exec(i);if(l)return o}return null}function F1(){var i=typeof si<"u"&&si.version;return i?new A1(si.version.slice(1)):null}function z1(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vu=function(i,e){return vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},vu(i,e)};function B1(i,e){vu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _u=function(){return _u=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},_u.apply(this,arguments)};function H1(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function K1(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function k1(i,e){return function(t,s){e(t,s,i)}}function V1(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function G1(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function W1(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Y1(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function J1(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function mu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Q1(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(fp(arguments[e]));return i}function X1(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ss(i){return this instanceof Ss?(this.v=i,this):new Ss(i)}function Z1(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,F){c.push([S,x,O,F])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Ss?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function eE(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ss(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function tE(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof mu=="function"?mu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function rE(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function iE(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function nE(i){return i&&i.__esModule?i:{default:i}}function sE(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function oE(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const aE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _u},__asyncDelegator:eE,__asyncGenerator:Z1,__asyncValues:tE,__await:Ss,__awaiter:G1,__classPrivateFieldGet:sE,__classPrivateFieldSet:oE,__createBinding:Y1,__decorate:K1,__exportStar:J1,__extends:B1,__generator:W1,__importDefault:nE,__importStar:iE,__makeTemplateObject:rE,__metadata:V1,__param:k1,__read:fp,__rest:H1,__spread:Q1,__spreadArrays:X1,__values:mu},Symbol.toStringTag,{value:"Module"})),la=zn(aE);var Hc={},ds={},bf;function cE(){if(bf)return ds;bf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ds.delay=i,ds}var nn={},Kc={},sn={},Ef;function uE(){return Ef||(Ef=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.ONE_THOUSAND=sn.ONE_HUNDRED=void 0,sn.ONE_HUNDRED=100,sn.ONE_THOUSAND=1e3),sn}var kc={},Df;function hE(){return Df||(Df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(kc)),kc}var Sf;function dp(){return Sf||(Sf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=la;e.__exportStar(uE(),i),e.__exportStar(hE(),i)}(Kc)),Kc}var If;function lE(){if(If)return nn;If=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.fromMiliseconds=nn.toMiliseconds=void 0;const i=dp();function e(s){return s*i.ONE_THOUSAND}nn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return nn.fromMiliseconds=t,nn}var xf;function fE(){return xf||(xf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=la;e.__exportStar(cE(),i),e.__exportStar(lE(),i)}(Hc)),Hc}var Un={},Of;function dE(){if(Of)return Un;Of=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Un.Watch=i,Un.default=i,Un}var Vc={},ps={},Pf;function pE(){if(Pf)return ps;Pf=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.IWatch=void 0;class i{}return ps.IWatch=i,ps}var Cf;function gE(){return Cf||(Cf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),la.__exportStar(pE(),i)}(Vc)),Vc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=la;e.__exportStar(fE(),i),e.__exportStar(dE(),i),e.__exportStar(gE(),i),e.__exportStar(dp(),i)})(ve);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=pp=ft.getLocation=ft.getLocationOrThrow=Ju=ft.getNavigator=ft.getNavigatorOrThrow=Yu=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function hn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}ft.getFromWindow=hn;function Hn(i){const e=hn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}ft.getFromWindowOrThrow=Hn;function yE(){return Hn("document")}ft.getDocumentOrThrow=yE;function vE(){return hn("document")}var Yu=ft.getDocument=vE;function _E(){return Hn("navigator")}ft.getNavigatorOrThrow=_E;function mE(){return hn("navigator")}var Ju=ft.getNavigator=mE;function wE(){return Hn("location")}ft.getLocationOrThrow=wE;function bE(){return hn("location")}var pp=ft.getLocation=bE;function EE(){return Hn("crypto")}ft.getCryptoOrThrow=EE;function DE(){return hn("crypto")}ft.getCrypto=DE;function SE(){return Hn("localStorage")}ft.getLocalStorageOrThrow=SE;function IE(){return hn("localStorage")}ft.getLocalStorage=IE;var Qu={};Object.defineProperty(Qu,"__esModule",{value:!0});var gp=Qu.getWindowMetadata=void 0;const Af=ft;function xE(){let i,e;try{i=Af.getDocumentOrThrow(),e=Af.getLocationOrThrow()}catch{return null}function t(){const D=i.getElementsByTagName("link"),S=[];for(let x=0;x<D.length;x++){const O=D[x],F=O.getAttribute("rel");if(F&&F.toLowerCase().indexOf("icon")>-1){const H=O.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(H.indexOf("/")===0)ie+=H;else{const $=e.pathname.split("/");$.pop();const M=$.join("/");ie+=M+"/"+H}S.push(ie)}else if(H.indexOf("//")===0){const ie=e.protocol+H;S.push(ie)}else S.push(H)}}return S}function s(...D){const S=i.getElementsByTagName("meta");for(let x=0;x<S.length;x++){const O=S[x],F=["itemprop","property","name"].map(H=>O.getAttribute(H)).filter(H=>H?D.includes(H):!1);if(F.length&&F){const H=O.getAttribute("content");if(H)return H}}return""}function o(){let D=s("name","og:site_name","og:title","twitter:title");return D||(D=i.title),D}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),g=e.origin,p=t();return{description:f,url:g,icons:p,name:l}}gp=Qu.getWindowMetadata=xE;var Is={},OE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),yp="%[a-f0-9]{2}",Tf=new RegExp("("+yp+")|([^%]+?)","gi"),Rf=new RegExp("("+yp+")+","gi");function wu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],wu(t),wu(s))}function PE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Tf)||[],t=1;t<e.length;t++)i=wu(e,t).join(""),e=i.match(Tf)||[];return i}}function CE(i){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Rf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=PE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Rf.exec(i)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var AE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return CE(i)}},TE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},RE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=i[l];(o?e.indexOf(l)!==-1:e(l,f,i))&&(t[l]=f)}return t};(function(i){const e=OE,t=AE,s=TE,o=RE,c=$=>$==null,l=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return M=>(C,T)=>{const E=C.length;return T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(M,$),"[",E,"]"].join("")]:[...C,[v(M,$),"[",v(E,$),"]=",v(T,$)].join("")]};case"bracket":return M=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(M,$),"[]"].join("")]:[...C,[v(M,$),"[]=",v(T,$)].join("")];case"colon-list-separator":return M=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(M,$),":list="].join("")]:[...C,[v(M,$),":list=",v(T,$)].join("")];case"comma":case"separator":case"bracket-separator":{const M=$.arrayFormat==="bracket-separator"?"[]=":"=";return C=>(T,E)=>E===void 0||$.skipNull&&E===null||$.skipEmptyString&&E===""?T:(E=E===null?"":E,T.length===0?[[v(C,$),M,v(E,$)].join("")]:[[T,v(E,$)].join($.arrayFormatSeparator)])}default:return M=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,v(M,$)]:[...C,[v(M,$),"=",v(T,$)].join("")]}}function g($){let M;switch($.arrayFormat){case"index":return(C,T,E)=>{if(M=/\[(\d*)\]$/.exec(C),C=C.replace(/\[\d*\]$/,""),!M){E[C]=T;return}E[C]===void 0&&(E[C]={}),E[C][M[1]]=T};case"bracket":return(C,T,E)=>{if(M=/(\[\])$/.exec(C),C=C.replace(/\[\]$/,""),!M){E[C]=T;return}if(E[C]===void 0){E[C]=[T];return}E[C]=[].concat(E[C],T)};case"colon-list-separator":return(C,T,E)=>{if(M=/(:list)$/.exec(C),C=C.replace(/:list$/,""),!M){E[C]=T;return}if(E[C]===void 0){E[C]=[T];return}E[C]=[].concat(E[C],T)};case"comma":case"separator":return(C,T,E)=>{const u=typeof T=="string"&&T.includes($.arrayFormatSeparator),w=typeof T=="string"&&!u&&D(T,$).includes($.arrayFormatSeparator);T=w?D(T,$):T;const G=u||w?T.split($.arrayFormatSeparator).map(W=>D(W,$)):T===null?T:D(T,$);E[C]=G};case"bracket-separator":return(C,T,E)=>{const u=/(\[\])$/.test(C);if(C=C.replace(/\[\]$/,""),!u){E[C]=T&&D(T,$);return}const w=T===null?[]:T.split($.arrayFormatSeparator).map(G=>D(G,$));if(E[C]===void 0){E[C]=w;return}E[C]=[].concat(E[C],w)};default:return(C,T,E)=>{if(E[C]===void 0){E[C]=T;return}E[C]=[].concat(E[C],T)}}}function p($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function v($,M){return M.encode?M.strict?e($):encodeURIComponent($):$}function D($,M){return M.decode?t($):$}function S($){return Array.isArray($)?$.sort():typeof $=="object"?S(Object.keys($)).sort((M,C)=>Number(M)-Number(C)).map(M=>$[M]):$}function x($){const M=$.indexOf("#");return M!==-1&&($=$.slice(0,M)),$}function O($){let M="";const C=$.indexOf("#");return C!==-1&&(M=$.slice(C)),M}function F($){$=x($);const M=$.indexOf("?");return M===-1?"":$.slice(M+1)}function H($,M){return M.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):M.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function ie($,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),p(M.arrayFormatSeparator);const C=g(M),T=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return T;for(const E of $.split("&")){if(E==="")continue;let[u,w]=s(M.decode?E.replace(/\+/g," "):E,"=");w=w===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?w:D(w,M),C(D(u,M),w,T)}for(const E of Object.keys(T)){const u=T[E];if(typeof u=="object"&&u!==null)for(const w of Object.keys(u))u[w]=H(u[w],M);else T[E]=H(u,M)}return M.sort===!1?T:(M.sort===!0?Object.keys(T).sort():Object.keys(T).sort(M.sort)).reduce((E,u)=>{const w=T[u];return w&&typeof w=="object"&&!Array.isArray(w)?E[u]=S(w):E[u]=w,E},Object.create(null))}i.extract=F,i.parse=ie,i.stringify=($,M)=>{if(!$)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),p(M.arrayFormatSeparator);const C=w=>M.skipNull&&c($[w])||M.skipEmptyString&&$[w]==="",T=f(M),E={};for(const w of Object.keys($))C(w)||(E[w]=$[w]);const u=Object.keys(E);return M.sort!==!1&&u.sort(M.sort),u.map(w=>{const G=$[w];return G===void 0?"":G===null?v(w,M):Array.isArray(G)?G.length===0&&M.arrayFormat==="bracket-separator"?v(w,M)+"[]":G.reduce(T(w),[]).join("&"):v(w,M)+"="+v(G,M)}).filter(w=>w.length>0).join("&")},i.parseUrl=($,M)=>{M=Object.assign({decode:!0},M);const[C,T]=s($,"#");return Object.assign({url:C.split("?")[0]||"",query:ie(F($),M)},M&&M.parseFragmentIdentifier&&T?{fragmentIdentifier:D(T,M)}:{})},i.stringifyUrl=($,M)=>{M=Object.assign({encode:!0,strict:!0,[l]:!0},M);const C=x($.url).split("?")[0]||"",T=i.extract($.url),E=i.parse(T,{sort:!1}),u=Object.assign(E,$.query);let w=i.stringify(u,M);w&&(w=`?${w}`);let G=O($.url);return $.fragmentIdentifier&&(G=`#${M[l]?v($.fragmentIdentifier,M):$.fragmentIdentifier}`),`${C}${w}${G}`},i.pick=($,M,C)=>{C=Object.assign({parseFragmentIdentifier:!0,[l]:!1},C);const{url:T,query:E,fragmentIdentifier:u}=i.parseUrl($,C);return i.stringifyUrl({url:T,query:o(E,M),fragmentIdentifier:u},C)},i.exclude=($,M,C)=>{const T=Array.isArray(M)?E=>!M.includes(E):(E,u)=>!M(E,u);return i.pick($,T,C)}})(Is);const NE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},$E=":";function UE(i){const[e,t]=i.split($E);return{namespace:e,reference:t}}function LE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function vp(i,e){return i.includes(":")?[i]:e.chains||[]}const _p="base10",lr="base16",bu="base64pad",Xu="utf8",mp=0,ln=1,jE=0,Nf=1,Eu=12,Zu=32;function ME(){const i=Gu.generateKeyPair();return{privateKey:fr(i.secretKey,lr),publicKey:fr(i.publicKey,lr)}}function Du(){const i=Bn.randomBytes(Zu);return fr(i,lr)}function qE(i,e){const t=Gu.sharedKey(br(i,lr),br(e,lr),!0),s=new xb(ua.SHA256,t).expand(Zu);return fr(s,lr)}function FE(i){const e=ua.hash(br(i,lr));return fr(e,lr)}function qn(i){const e=ua.hash(br(i,Xu));return fr(e,lr)}function zE(i){return br(`${i}`,_p)}function Ns(i){return Number(fr(i,_p))}function BE(i){const e=zE(typeof i.type<"u"?i.type:mp);if(Ns(e)===ln&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?br(i.senderPublicKey,lr):void 0,s=typeof i.iv<"u"?br(i.iv,lr):Bn.randomBytes(Eu),o=new ku.ChaCha20Poly1305(br(i.symKey,lr)).seal(s,br(i.message,Xu));return KE({type:e,sealed:o,iv:s,senderPublicKey:t})}function HE(i){const e=new ku.ChaCha20Poly1305(br(i.symKey,lr)),{sealed:t,iv:s}=ea(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return fr(o,Xu)}function KE(i){if(Ns(i.type)===ln){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return fr(yu([i.type,i.senderPublicKey,i.iv,i.sealed]),bu)}return fr(yu([i.type,i.iv,i.sealed]),bu)}function ea(i){const e=br(i,bu),t=e.slice(jE,Nf),s=Nf;if(Ns(t)===ln){const f=s+Zu,g=f+Eu,p=e.slice(s,f),v=e.slice(f,g),D=e.slice(g);return{type:t,sealed:D,iv:v,senderPublicKey:p}}const o=s+Eu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function kE(i,e){const t=ea(i);return wp({type:Ns(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?fr(t.senderPublicKey,lr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function wp(i){const e=(i==null?void 0:i.type)||mp;if(e===ln){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function $f(i){return i.type===ln&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var VE=Object.defineProperty,Uf=Object.getOwnPropertySymbols,GE=Object.prototype.hasOwnProperty,WE=Object.prototype.propertyIsEnumerable,Lf=(i,e,t)=>e in i?VE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,jf=(i,e)=>{for(var t in e||(e={}))GE.call(e,t)&&Lf(i,t,e[t]);if(Uf)for(var t of Uf(e))WE.call(e,t)&&Lf(i,t,e[t]);return i};const YE="ReactNative",Cr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},JE="js";function eh(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}function Kn(){return!Yu()&&!!Ju()&&navigator.product===YE}function kn(){return!eh()&&!!Ju()&&!!Yu()}function $s(){return Kn()?Cr.reactNative:eh()?Cr.node:kn()?Cr.browser:Cr.unknown}function QE(){var i;try{return Kn()&&typeof st<"u"&&typeof(st==null?void 0:st.Application)<"u"?(i=st.Application)==null?void 0:i.applicationId:void 0}catch{return}}function XE(i,e){let t=Is.parse(i);return t=jf(jf({},t),e),i=Is.stringify(t),i}function ZE(){return gp()||{name:"",description:"",url:"",icons:[""]}}function e3(){if($s()===Cr.reactNative&&typeof st<"u"&&typeof(st==null?void 0:st.Platform)<"u"){const{OS:t,Version:s}=st.Platform;return[t,s].join("-")}const i=j1();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function t3(){var i;const e=$s();return e===Cr.browser?[e,((i=pp())==null?void 0:i.host)||"unknown"].join(":"):e}function r3(i,e,t){const s=e3(),o=t3();return[[i,e].join("-"),[JE,t].join("-"),s,o].join("/")}function i3({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l,bundleId:f}){const g=t.split("?"),p=r3(i,e,s),v={auth:o,ua:p,projectId:c,useOnCloseEvent:l||void 0,origin:f||void 0},D=XE(g[1]||"",v);return g[0]+"?"+D}function cn(i,e){return i.filter(t=>e.includes(t)).length===i.length}function bp(i){return Object.fromEntries(i.entries())}function Ep(i){return new Map(Object.entries(i))}function jn(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function xs(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function Dp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function n3(i){return Dp("topic",i)}function s3(i){return Dp("id",i)}function Sp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Pr(i,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(i))}function Mi(i){return Date.now()>=ve.toMiliseconds(i)}function Ut(i,e){return`${i}${e?`:${e}`:""}`}function Gc(i=[],e=[]){return[...new Set([...i,...e])]}async function o3({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=$s();l===Cr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Cr.reactNative&&typeof(st==null?void 0:st.Linking)<"u"&&await st.Linking.openURL(c)}catch(s){console.error(s)}}async function a3(i,e){try{return await i.getItem(e)||(kn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const c3="irn";function Su(i){return(i==null?void 0:i.relay)||{protocol:c3}}function Yo(i){const e=NE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var u3=Object.defineProperty,h3=Object.defineProperties,l3=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,f3=Object.prototype.hasOwnProperty,d3=Object.prototype.propertyIsEnumerable,qf=(i,e,t)=>e in i?u3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,p3=(i,e)=>{for(var t in e||(e={}))f3.call(e,t)&&qf(i,t,e[t]);if(Mf)for(var t of Mf(e))d3.call(e,t)&&qf(i,t,e[t]);return i},g3=(i,e)=>h3(i,l3(e));function y3(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function Ff(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=Is.parse(c);return{protocol:s,topic:v3(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:y3(l),expiryTimestamp:l.expiryTimestamp?parseInt(l.expiryTimestamp,10):void 0}}function v3(i){return i.startsWith("//")?i.substring(2):i}function _3(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function m3(i){return`${i.protocol}:${i.topic}@${i.version}?`+Is.stringify(g3(p3({symKey:i.symKey},_3(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function Vn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function w3(i){const e=[];return Object.values(i).forEach(t=>{e.push(...Vn(t.accounts))}),e}function b3(i,e){const t=[];return Object.values(i).forEach(s=>{Vn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function E3(i,e){const t=[];return Object.values(i).forEach(s=>{Vn(s.accounts).includes(e)&&t.push(...s.events)}),t}function th(i){return i.includes(":")}function ws(i){return th(i)?i.split(":")[0]:i}const D3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},S3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(i,e){const{message:t,code:s}=S3[i];return{message:e?`${t} ${e}`:t,code:s}}function wt(i,e){const{message:t,code:s}=D3[i];return{message:e?`${t} ${e}`:t,code:s}}function oi(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Os(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function hr(i){return typeof i>"u"}function Wt(i,e){return e&&hr(i)?!0:typeof i=="string"&&!!i.trim().length}function rh(i,e){return e&&hr(i)?!0:typeof i=="number"&&!isNaN(i)}function I3(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return cn(o,s)?(s.forEach(l=>{const{accounts:f,methods:g,events:p}=i.namespaces[l],v=Vn(f),D=t[l];(!cn(vp(l,D),v)||!cn(D.methods,g)||!cn(D.events,p))&&(c=!1)}),c):!1}function ta(i){return Wt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function x3(i){if(Wt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ta(t)}}return!1}function O3(i){if(Wt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function P3(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function C3(i){return i==null?void 0:i.topic}function A3(i,e){let t=null;return Wt(i==null?void 0:i.publicKey,!1)||(t=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function zf(i){let e=!0;return oi(i)?i.length&&(e=i.every(t=>Wt(t,!1))):e=!1,e}function T3(i,e,t){let s=null;return oi(e)&&e.length?e.forEach(o=>{s||ta(o)||(s=wt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ta(i)||(s=wt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function R3(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=T3(o,vp(o,c),`${e} ${t}`);l&&(s=l)}),s}function N3(i,e){let t=null;return oi(i)?i.forEach(s=>{t||x3(s)||(t=wt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=wt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function $3(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=N3(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function U3(i,e){let t=null;return zf(i==null?void 0:i.methods)?zf(i==null?void 0:i.events)||(t=wt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=wt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Ip(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=U3(s,`${e}, namespace`);o&&(t=o)}),t}function L3(i,e,t){let s=null;if(i&&Os(i)){const o=Ip(i,e);o&&(s=o);const c=R3(i,e,t);c&&(s=c)}else s=ce("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Wc(i,e){let t=null;if(i&&Os(i)){const s=Ip(i,e);s&&(t=s);const o=$3(i,e);o&&(t=o)}else t=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function xp(i){return Wt(i.protocol,!0)}function j3(i,e){let t=!1;return e&&!i?t=!0:i&&oi(i)&&i.length&&i.forEach(s=>{t=xp(s)}),t}function M3(i){return typeof i=="number"}function wr(i){return typeof i<"u"&&typeof i!==null}function q3(i){return!(!i||typeof i!="object"||!i.code||!rh(i.code,!1)||!i.message||!Wt(i.message,!1))}function F3(i){return!(hr(i)||!Wt(i.method,!1))}function z3(i){return!(hr(i)||hr(i.result)&&hr(i.error)||!rh(i.id,!1)||!Wt(i.jsonrpc,!1))}function B3(i){return!(hr(i)||!Wt(i.name,!1))}function Bf(i,e){return!(!ta(e)||!w3(i).includes(e))}function H3(i,e,t){return Wt(t,!1)?b3(i,e).includes(t):!1}function K3(i,e,t){return Wt(t,!1)?E3(i,e).includes(t):!1}function Hf(i,e,t){let s=null;const o=k3(i),c=V3(e),l=Object.keys(o),f=Object.keys(c),g=Kf(Object.keys(i)),p=Kf(Object.keys(e)),v=g.filter(D=>!p.includes(D));return v.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(e).toString()}`)),cn(l,f)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(D=>{if(!D.includes(":")||s)return;const S=Vn(e[D].accounts);S.includes(D)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${D}
        Required: ${D}
        Approved: ${S.toString()}`))}),l.forEach(D=>{s||(cn(o[D].methods,c[D].methods)?cn(o[D].events,c[D].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${D}`)):s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${D}`))}),s}function k3(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Kf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function V3(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=Vn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function G3(i,e){return rh(i,!1)&&i<=e.max&&i>=e.min}function kf(){const i=$s();return new Promise(e=>{switch(i){case Cr.browser:e(W3());break;case Cr.reactNative:e(Y3());break;case Cr.node:e(J3());break;default:e(!0)}})}function W3(){return kn()&&(navigator==null?void 0:navigator.onLine)}async function Y3(){if(Kn()&&typeof st<"u"&&st!=null&&st.NetInfo){const i=await(st==null?void 0:st.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function J3(){return!0}function Q3(i){switch($s()){case Cr.browser:X3(i);break;case Cr.reactNative:Z3(i);break}}function X3(i){!Kn()&&kn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function Z3(i){var e;Kn()&&typeof st<"u"&&st!=null&&st.NetInfo&&((e=st)==null||e.NetInfo.addEventListener(t=>i(t==null?void 0:t.isConnected)))}const Yc={};let Ho=class{static get(e){return Yc[e]}static set(e,t){Yc[e]=t}static delete(e){delete Yc[e]}};const eD=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,tD=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,rD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function iD(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){nD(i);return}return e}function nD(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Ko(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!rD.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(eD.test(i)||tD.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,iD)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function sD(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Gt(i,...e){try{return sD(i(...e))}catch(t){return Promise.reject(t)}}function oD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function aD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Jo(i){if(oD(i))return String(i);if(aD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Jo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Op(){if(typeof Bu===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Iu="base64:";function cD(i){if(typeof i=="string")return i;Op();const e=Bu.from(i).toString("base64");return Iu+e}function uD(i){return typeof i!="string"||!i.startsWith(Iu)?i:(Op(),Bu.from(i.slice(Iu.length),"base64"))}function mr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function hD(...i){return mr(i.join(":"))}function ko(i){return i=mr(i),i?i+":":""}const lD="memory",fD=()=>{const i=new Map;return{name:lD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function dD(i={}){const e={mounts:{"":i.driver||fD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const v of e.mountpoints)if(p.startsWith(v))return{base:v,relativeKey:p.slice(v.length),driver:e.mounts[v]};return{base:"",relativeKey:p,driver:e.mounts[""]}},s=(p,v)=>e.mountpoints.filter(D=>D.startsWith(p)||v&&p.startsWith(D)).map(D=>({relativeBase:p.length>D.length?p.slice(D.length):void 0,mountpoint:D,driver:e.mounts[D]})),o=(p,v)=>{if(e.watching){v=mr(v);for(const D of e.watchListeners)D(p,v)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await Vf(e.mounts[p],o,p)}},l=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},f=(p,v,D)=>{const S=new Map,x=O=>{let F=S.get(O.base);return F||(F={driver:O.driver,base:O.base,items:[]},S.set(O.base,F)),F};for(const O of p){const F=typeof O=="string",H=mr(F?O:O.key),ie=F?void 0:O.value,$=F||!O.options?v:{...v,...O.options},M=t(H);x(M).items.push({key:H,value:ie,relativeKey:M.relativeKey,options:$})}return Promise.all([...S.values()].map(O=>D(O))).then(O=>O.flat())},g={hasItem(p,v={}){p=mr(p);const{relativeKey:D,driver:S}=t(p);return Gt(S.hasItem,D,v)},getItem(p,v={}){p=mr(p);const{relativeKey:D,driver:S}=t(p);return Gt(S.getItem,D,v).then(x=>Ko(x))},getItems(p,v){return f(p,v,D=>D.driver.getItems?Gt(D.driver.getItems,D.items.map(S=>({key:S.relativeKey,options:S.options})),v).then(S=>S.map(x=>({key:hD(D.base,x.key),value:Ko(x.value)}))):Promise.all(D.items.map(S=>Gt(D.driver.getItem,S.relativeKey,S.options).then(x=>({key:S.key,value:Ko(x)})))))},getItemRaw(p,v={}){p=mr(p);const{relativeKey:D,driver:S}=t(p);return S.getItemRaw?Gt(S.getItemRaw,D,v):Gt(S.getItem,D,v).then(x=>uD(x))},async setItem(p,v,D={}){if(v===void 0)return g.removeItem(p);p=mr(p);const{relativeKey:S,driver:x}=t(p);x.setItem&&(await Gt(x.setItem,S,Jo(v),D),x.watch||o("update",p))},async setItems(p,v){await f(p,v,async D=>{D.driver.setItems&&await Gt(D.driver.setItems,D.items.map(S=>({key:S.relativeKey,value:Jo(S.value),options:S.options})),v),D.driver.setItem&&await Promise.all(D.items.map(S=>Gt(D.driver.setItem,S.relativeKey,Jo(S.value),S.options)))})},async setItemRaw(p,v,D={}){if(v===void 0)return g.removeItem(p,D);p=mr(p);const{relativeKey:S,driver:x}=t(p);if(x.setItemRaw)await Gt(x.setItemRaw,S,v,D);else if(x.setItem)await Gt(x.setItem,S,cD(v),D);else return;x.watch||o("update",p)},async removeItem(p,v={}){typeof v=="boolean"&&(v={removeMeta:v}),p=mr(p);const{relativeKey:D,driver:S}=t(p);S.removeItem&&(await Gt(S.removeItem,D,v),(v.removeMeta||v.removeMata)&&await Gt(S.removeItem,D+"$",v),S.watch||o("remove",p))},async getMeta(p,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),p=mr(p);const{relativeKey:D,driver:S}=t(p),x=Object.create(null);if(S.getMeta&&Object.assign(x,await Gt(S.getMeta,D,v)),!v.nativeOnly){const O=await Gt(S.getItem,D+"$",v).then(F=>Ko(F));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(x,O))}return x},setMeta(p,v,D={}){return this.setItem(p+"$",v,D)},removeMeta(p,v={}){return this.removeItem(p+"$",v)},async getKeys(p,v={}){p=ko(p);const D=s(p,!0);let S=[];const x=[];for(const O of D){const H=(await Gt(O.driver.getKeys,O.relativeBase,v)).map(ie=>O.mountpoint+mr(ie)).filter(ie=>!S.some($=>ie.startsWith($)));x.push(...H),S=[O.mountpoint,...S.filter(ie=>!ie.startsWith(O.mountpoint))]}return p?x.filter(O=>O.startsWith(p)&&!O.endsWith("$")):x.filter(O=>!O.endsWith("$"))},async clear(p,v={}){p=ko(p),await Promise.all(s(p,!1).map(async D=>{if(D.driver.clear)return Gt(D.driver.clear,D.relativeBase,v);if(D.driver.removeItem){const S=await D.driver.getKeys(D.relativeBase||"",v);return Promise.all(S.map(x=>D.driver.removeItem(x,v)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>Gf(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(v=>v!==p),e.watchListeners.length===0&&await l()}},async unwatch(){e.watchListeners=[],await l()},mount(p,v){if(p=ko(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((D,S)=>S.length-D.length)),e.mounts[p]=v,e.watching&&Promise.resolve(Vf(v,o,p)).then(D=>{e.unwatch[p]=D}).catch(console.error),g},async unmount(p,v=!0){p=ko(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),v&&await Gf(e.mounts[p]),e.mountpoints=e.mountpoints.filter(D=>D!==p),delete e.mounts[p])},getMount(p=""){p=mr(p)+":";const v=t(p);return{driver:v.driver,base:v.base}},getMounts(p="",v={}){return p=mr(p),s(p,v.parents).map(S=>({driver:S.driver,base:S.mountpoint}))}};return g}function Vf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Gf(i){typeof i.dispose=="function"&&await Gt(i.dispose)}function fn(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function Pp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=fn(t);return(o,c)=>s.then(l=>c(l.transaction(e,o).objectStore(e)))}let Jc;function Us(){return Jc||(Jc=Pp("keyval-store","keyval")),Jc}function Wf(i,e=Us()){return e("readonly",t=>fn(t.get(i)))}function pD(i,e,t=Us()){return t("readwrite",s=>(s.put(e,i),fn(s.transaction)))}function gD(i,e=Us()){return e("readwrite",t=>(t.delete(i),fn(t.transaction)))}function yD(i=Us()){return i("readwrite",e=>(e.clear(),fn(e.transaction)))}function vD(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},fn(i.transaction)}function _D(i=Us()){return i("readonly",e=>{if(e.getAllKeys)return fn(e.getAllKeys());const t=[];return vD(e,s=>t.push(s.key)).then(()=>t)})}const mD=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),wD=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ls(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return wD(i)}catch{return i}}function un(i){return typeof i=="string"?i:mD(i)||""}const bD="idb-keyval";var ED=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=Pp(i.dbName,i.storeName)),{name:bD,options:i,async hasItem(o){return!(typeof await Wf(t(o),s)>"u")},async getItem(o){return await Wf(t(o),s)??null},setItem(o,c){return pD(t(o),c,s)},removeItem(o){return gD(t(o),s)},getKeys(){return _D(s)},clear(){return yD(s)}}};const DD="WALLET_CONNECT_V2_INDEXED_DB",SD="keyvaluestorage";let ID=class{constructor(){this.indexedDb=dD({driver:ED({dbName:DD,storeName:SD})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,un(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},Qo={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Qc<"u"&&Qc.localStorage?Qo.exports=Qc.localStorage:typeof window<"u"&&window.localStorage?Qo.exports=window.localStorage:Qo.exports=new e})();function xD(i){var e;return[i[0],Ls((e=i[1])!=null?e:"")]}class OD{constructor(){this.localStorage=Qo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(xD)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ls(t)}async setItem(e,t){this.localStorage.setItem(e,un(t))}async removeItem(e){this.localStorage.removeItem(e)}}const PD="wc_storage_version",Yf=1,CD=async(i,e,t)=>{const s=PD,o=await e.getItem(s);if(o&&o>=Yf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const l=[];for(;c.length;){const f=c.shift();if(!f)continue;const g=f.toLowerCase();if(g.includes("wc@")||g.includes("walletconnect")||g.includes("wc_")||g.includes("wallet_connect")){const p=await i.getItem(f);await e.setItem(f,p),l.push(f)}}await e.setItem(s,Yf),t(e),AD(i,l)},AD=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let TD=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new OD;this.storage=e;try{const t=new ID;CD(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Gn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xu=function(i,e){return xu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},xu(i,e)};function RD(i,e){xu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ou=function(){return Ou=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Ou.apply(this,arguments)};function ND(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function $D(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function UD(i,e){return function(t,s){e(t,s,i)}}function LD(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function jD(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function MD(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function qD(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function FD(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Pu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function zD(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Cp(arguments[e]));return i}function BD(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(i){return this instanceof Ps?(this.v=i,this):new Ps(i)}function HD(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,F){c.push([S,x,O,F])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Ps?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function KD(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ps(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function kD(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Pu=="function"?Pu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function VD(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function GD(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function WD(i){return i&&i.__esModule?i:{default:i}}function YD(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function JD(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const QD=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ou},__asyncDelegator:KD,__asyncGenerator:HD,__asyncValues:kD,__await:Ps,__awaiter:jD,__classPrivateFieldGet:YD,__classPrivateFieldSet:JD,__createBinding:qD,__decorate:$D,__exportStar:FD,__extends:RD,__generator:MD,__importDefault:WD,__importStar:GD,__makeTemplateObject:VD,__metadata:LD,__param:UD,__read:Cp,__rest:ND,__spread:zD,__spreadArrays:BD,__values:Pu},Symbol.toStringTag,{value:"Module"})),fa=zn(QD);var gs={},Xc={},ys={};let dn=class{};const XD=Object.freeze(Object.defineProperty({__proto__:null,IEvents:dn},Symbol.toStringTag,{value:"Module"})),ZD=zn(XD);var Jf;function eS(){if(Jf)return ys;Jf=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.IHeartBeat=void 0;const i=ZD;class e extends i.IEvents{constructor(s){super()}}return ys.IHeartBeat=e,ys}var Qf;function Ap(){return Qf||(Qf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),fa.__exportStar(eS(),i)}(Xc)),Xc}var Zc={},on={},Xf;function tS(){if(Xf)return on;Xf=1,Object.defineProperty(on,"__esModule",{value:!0}),on.HEARTBEAT_EVENTS=on.HEARTBEAT_INTERVAL=void 0;const i=ve;return on.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,on.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},on}var Zf;function Tp(){return Zf||(Zf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),fa.__exportStar(tS(),i)}(Zc)),Zc}var ed;function rS(){if(ed)return gs;ed=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.HeartBeat=void 0;const i=fa,e=zr,t=ve,s=Ap(),o=Tp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const g=new c(f);return yield g.init(),g})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return gs.HeartBeat=c,gs}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=fa;e.__exportStar(rS(),i),e.__exportStar(Ap(),i),e.__exportStar(Tp(),i)})(Gn);var Je={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Cu=function(i,e){return Cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Cu(i,e)};function iS(i,e){Cu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Au=function(){return Au=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Au.apply(this,arguments)};function nS(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function sS(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function oS(i,e){return function(t,s){e(t,s,i)}}function aS(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function cS(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function uS(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function hS(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function lS(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Tu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function fS(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Rp(arguments[e]));return i}function dS(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Cs(i){return this instanceof Cs?(this.v=i,this):new Cs(i)}function pS(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,F){c.push([S,x,O,F])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Cs?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function gS(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Cs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function yS(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Tu=="function"?Tu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function vS(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function _S(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function mS(i){return i&&i.__esModule?i:{default:i}}function wS(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function bS(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const ES=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Au},__asyncDelegator:gS,__asyncGenerator:pS,__asyncValues:yS,__await:Cs,__awaiter:cS,__classPrivateFieldGet:wS,__classPrivateFieldSet:bS,__createBinding:hS,__decorate:sS,__exportStar:lS,__extends:iS,__generator:uS,__importDefault:mS,__importStar:_S,__makeTemplateObject:vS,__metadata:aS,__param:oS,__read:Rp,__rest:nS,__spread:fS,__spreadArrays:dS,__values:Tu},Symbol.toStringTag,{value:"Module"})),DS=zn(ES);var eu,td;function SS(){if(td)return eu;td=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}eu=e;function e(t,s,o){var c=o&&o.stringify||i,l=1;if(typeof t=="object"&&t!==null){var f=s.length+l;if(f===1)return t;var g=new Array(f);g[0]=c(t);for(var p=1;p<f;p++)g[p]=c(s[p]);return g.join(" ")}if(typeof t!="string")return t;var v=s.length;if(v===0)return t;for(var D="",S=1-l,x=-1,O=t&&t.length||0,F=0;F<O;){if(t.charCodeAt(F)===37&&F+1<O){switch(x=x>-1?x:0,t.charCodeAt(F+1)){case 100:case 102:if(S>=v||s[S]==null)break;x<F&&(D+=t.slice(x,F)),D+=Number(s[S]),x=F+2,F++;break;case 105:if(S>=v||s[S]==null)break;x<F&&(D+=t.slice(x,F)),D+=Math.floor(Number(s[S])),x=F+2,F++;break;case 79:case 111:case 106:if(S>=v||s[S]===void 0)break;x<F&&(D+=t.slice(x,F));var H=typeof s[S];if(H==="string"){D+="'"+s[S]+"'",x=F+2,F++;break}if(H==="function"){D+=s[S].name||"<anonymous>",x=F+2,F++;break}D+=c(s[S]),x=F+2,F++;break;case 115:if(S>=v)break;x<F&&(D+=t.slice(x,F)),D+=String(s[S]),x=F+2,F++;break;case 37:x<F&&(D+=t.slice(x,F)),D+="%",x=F+2,F++,S--;break}++S}++F}return x===-1?t:(x<O&&(D+=t.slice(x)),D)}return eu}var tu,rd;function IS(){if(rd)return tu;rd=1;const i=SS();tu=o;const e=T().console||{},t={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:F,wrapResponseSerializer:F,wrapErrorSerializer:F,req:O,res:O,err:S};function s(E,u){return Array.isArray(E)?E.filter(function(G){return G!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const w=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const G=E.serializers||{},W=s(E.browser.serialize,G);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof w=="function"&&(w.error=w.fatal=w.warn=w.info=w.debug=w.trace=w),E.enabled===!1&&(E.level="silent");const de=E.level||"info",b=Object.create(w);b.log||(b.log=H),Object.defineProperty(b,"levelVal",{get:ee}),Object.defineProperty(b,"level",{get:Q,set:k});const A={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ue,timestamp:x(E)};b.levels=o.levels,b.level=de,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=H,b.serializers=G,b._serialize=W,b._stdErrSerialize=se,b.child=V,u&&(b._logEvent=D());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(A,b,"error","log"),c(A,b,"fatal","error"),c(A,b,"warn","error"),c(A,b,"info","log"),c(A,b,"debug","log"),c(A,b,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const we=re.serializers;if(W&&we){var oe=Object.assign({},G,we),be=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,g([J],be,oe,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=p(_e,J,"error"),this.fatal=p(_e,J,"fatal"),this.warn=p(_e,J,"warn"),this.info=p(_e,J,"info"),this.debug=p(_e,J,"debug"),this.trace=p(_e,J,"trace"),oe&&(this.serializers=oe,this._serialize=be),u&&(this._logEvent=D([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return b}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:$,unixTime:M,isoTime:C});function c(E,u,w,G){const W=Object.getPrototypeOf(u);u[w]=u.levelVal>u.levels.values[w]?H:W[w]?W[w]:e[w]||e[G]||H,l(E,u,w)}function l(E,u,w){!E.transmit&&u[w]===H||(u[w]=function(G){return function(){const se=E.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var b=0;b<ue.length;b++)ue[b]=arguments[b];if(E.serialize&&!E.asObject&&g(ue,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?G.call(de,f(this,w,ue,se)):G.apply(de,ue),E.transmit){const A=E.transmit.level||u.level,ee=o.levels.values[A],Q=o.levels.values[w];if(Q<ee)return;v(this,{ts:se,methodLevel:w,methodValue:Q,transmitLevel:A,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ue)}}}(u[w]))}function f(E,u,w,G){E._serialize&&g(w,E._serialize,E.serializers,E._stdErrSerialize);const W=w.slice();let se=W[0];const ue={};G&&(ue.time=G),ue.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ue,W.shift());se=W.length?i(W.shift(),W):void 0}else typeof se=="string"&&(se=i(W.shift(),W));return se!==void 0&&(ue.msg=se),ue}function g(E,u,w,G){for(const W in E)if(G&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const se in E[W])u&&u.indexOf(se)>-1&&se in w&&(E[W][se]=w[se](E[W][se]))}function p(E,u,w){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return E[w].apply(this,G)}}function v(E,u,w){const G=u.send,W=u.ts,se=u.methodLevel,ue=u.methodValue,de=u.val,b=E._logEvent.bindings;g(w,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=w.filter(function(A){return b.indexOf(A)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ue,G(se,E._logEvent,de),E._logEvent=D(b)}function D(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function S(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const w in E)u[w]===void 0&&(u[w]=E[w]);return u}function x(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ie:$}function O(){return{}}function F(E){return E}function H(){}function ie(){return!1}function $(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function C(){return new Date(Date.now()).toISOString()}function T(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return tu}var an={},id;function Np(){return id||(id=1,Object.defineProperty(an,"__esModule",{value:!0}),an.PINO_CUSTOM_CONTEXT_KEY=an.PINO_LOGGER_DEFAULTS=void 0,an.PINO_LOGGER_DEFAULTS={level:"info"},an.PINO_CUSTOM_CONTEXT_KEY="custom_context"),an}var cr={},nd;function xS(){if(nd)return cr;nd=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.generateChildLogger=cr.formatChildLoggerContext=cr.getLoggerContext=cr.setBrowserLoggerContext=cr.getBrowserLoggerContext=cr.getDefaultLoggerOptions=void 0;const i=Np();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}cr.getDefaultLoggerOptions=e;function t(f,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}cr.getBrowserLoggerContext=t;function s(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){return f[p]=g,f}cr.setBrowserLoggerContext=s;function o(f,g=i.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,g):p=f.bindings().context||"",p}cr.getLoggerContext=o;function c(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=o(f,p);return v.trim()?`${v}/${g}`:g}cr.formatChildLoggerContext=c;function l(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=c(f,g,p),D=f.child({context:v});return s(D,v,p)}return cr.generateChildLogger=l,cr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=DS,t=e.__importDefault(IS());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Np(),i),e.__exportStar(xS(),i)})(Je);class OS extends dn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let PS=class extends dn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},CS=class{constructor(e,t){this.logger=e,this.core=t}},AS=class extends dn{constructor(e,t){super(),this.relayer=e,this.logger=t}},TS=class extends dn{constructor(e){super()}},RS=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class NS extends dn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let $S=class extends dn{constructor(e,t){super(),this.core=e,this.logger=t}},US=class{constructor(e,t){this.projectId=e,this.logger=t}},LS=class{constructor(e,t){this.projectId=e,this.logger=t}},jS=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},MS=class{constructor(e){this.client=e}};var ih={},$p={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Ar;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,D=p/536870912|0,S=p<<3,x=p%128<112?128:256;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,x-8),e.writeUint32BE(S,this._buffer,x-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],g,O*8),e.writeUint32BE(this._stateLo[O],g,O*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,g,p,v,D,S,x){for(var O=p[0],F=p[1],H=p[2],ie=p[3],$=p[4],M=p[5],C=p[6],T=p[7],E=v[0],u=v[1],w=v[2],G=v[3],W=v[4],se=v[5],ue=v[6],de=v[7],b,A,ee,Q,k,V,J,re;x>=128;){for(var we=0;we<16;we++){var oe=8*we+S;f[we]=e.readUint32BE(D,oe),g[we]=e.readUint32BE(D,oe+4)}for(var we=0;we<80;we++){var be=O,le=F,_e=H,B=ie,z=$,U=M,d=C,R=T,ae=E,fe=u,Ie=w,Be=G,ke=W,je=se,gt=ue,yt=de;if(b=T,A=de,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=($>>>14|W<<18)^($>>>18|W<<14)^(W>>>9|$<<23),A=(W>>>14|$<<18)^(W>>>18|$<<14)^($>>>9|W<<23),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=$&M^~$&C,A=W&se^~W&ue,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=o[we*2],A=o[we*2+1],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=f[we%16],A=g[we%16],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=k&65535|V<<16,b=ee,A=Q,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=(O>>>28|E<<4)^(E>>>2|O<<30)^(E>>>7|O<<25),A=(E>>>28|O<<4)^(O>>>2|E<<30)^(O>>>7|E<<25),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=O&F^O&H^F&H,A=E&u^E&w^u&w,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,R=J&65535|re<<16,yt=k&65535|V<<16,b=B,A=Be,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=ee,A=Q,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,B=J&65535|re<<16,Be=k&65535|V<<16,F=be,H=le,ie=_e,$=B,M=z,C=U,T=d,O=R,u=ae,w=fe,G=Ie,W=Be,se=ke,ue=je,de=gt,E=yt,we%16===15)for(var oe=0;oe<16;oe++)b=f[oe],A=g[oe],k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=f[(oe+9)%16],A=g[(oe+9)%16],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+1)%16],Q=g[(oe+1)%16],b=(ee>>>1|Q<<31)^(ee>>>8|Q<<24)^ee>>>7,A=(Q>>>1|ee<<31)^(Q>>>8|ee<<24)^(Q>>>7|ee<<25),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+14)%16],Q=g[(oe+14)%16],b=(ee>>>19|Q<<13)^(Q>>>29|ee<<3)^ee>>>6,A=(Q>>>19|ee<<13)^(ee>>>29|Q<<3)^(Q>>>6|ee<<26),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,g[oe]=k&65535|V<<16}b=O,A=E,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[0],A=v[0],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[0]=O=J&65535|re<<16,v[0]=E=k&65535|V<<16,b=F,A=u,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[1],A=v[1],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[1]=F=J&65535|re<<16,v[1]=u=k&65535|V<<16,b=H,A=w,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[2],A=v[2],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[2]=H=J&65535|re<<16,v[2]=w=k&65535|V<<16,b=ie,A=G,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[3],A=v[3],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[3]=ie=J&65535|re<<16,v[3]=G=k&65535|V<<16,b=$,A=W,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[4],A=v[4],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[4]=$=J&65535|re<<16,v[4]=W=k&65535|V<<16,b=M,A=se,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[5],A=v[5],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[5]=M=J&65535|re<<16,v[5]=se=k&65535|V<<16,b=C,A=ue,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[6],A=v[6],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[6]=C=J&65535|re<<16,v[6]=ue=k&65535|V<<16,b=T,A=de,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[7],A=v[7],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[7]=T=J&65535|re<<16,v[7]=de=k&65535|V<<16,S+=128,x-=128}return S}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})($p);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=Bn,t=$p,s=Ar;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(B){const z=new Float64Array(16);if(B)for(let U=0;U<B.length;U++)z[U]=B[U];return z}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function x(B,z){for(let U=0;U<16;U++)B[U]=z[U]|0}function O(B){let z=1;for(let U=0;U<16;U++){let d=B[U]+z+65535;z=Math.floor(d/65536),B[U]=d-z*65536}B[0]+=z-1+37*(z-1)}function F(B,z,U){const d=~(U-1);for(let R=0;R<16;R++){const ae=d&(B[R]^z[R]);B[R]^=ae,z[R]^=ae}}function H(B,z){const U=o(),d=o();for(let R=0;R<16;R++)d[R]=z[R];O(d),O(d),O(d);for(let R=0;R<2;R++){U[0]=d[0]-65517;for(let fe=1;fe<15;fe++)U[fe]=d[fe]-65535-(U[fe-1]>>16&1),U[fe-1]&=65535;U[15]=d[15]-32767-(U[14]>>16&1);const ae=U[15]>>16&1;U[14]&=65535,F(d,U,1-ae)}for(let R=0;R<16;R++)B[2*R]=d[R]&255,B[2*R+1]=d[R]>>8}function ie(B,z){let U=0;for(let d=0;d<32;d++)U|=B[d]^z[d];return(1&U-1>>>8)-1}function $(B,z){const U=new Uint8Array(32),d=new Uint8Array(32);return H(U,B),H(d,z),ie(U,d)}function M(B){const z=new Uint8Array(32);return H(z,B),z[0]&1}function C(B,z){for(let U=0;U<16;U++)B[U]=z[2*U]+(z[2*U+1]<<8);B[15]&=32767}function T(B,z,U){for(let d=0;d<16;d++)B[d]=z[d]+U[d]}function E(B,z,U){for(let d=0;d<16;d++)B[d]=z[d]-U[d]}function u(B,z,U){let d,R,ae=0,fe=0,Ie=0,Be=0,ke=0,je=0,gt=0,yt=0,qe=0,xe=0,Ne=0,$e=0,Fe=0,Pe=0,Ue=0,Se=0,Ce=0,He=0,Oe=0,Ve=0,We=0,et=0,tt=0,Qe=0,rr=0,dr=0,Qr=0,ir=0,ai=0,Oi=0,Hi=0,St=U[0],vt=U[1],It=U[2],xt=U[3],Et=U[4],_t=U[5],Lt=U[6],jt=U[7],Ot=U[8],Mt=U[9],Pt=U[10],Tt=U[11],Ct=U[12],lt=U[13],qt=U[14],Ft=U[15];d=z[0],ae+=d*St,fe+=d*vt,Ie+=d*It,Be+=d*xt,ke+=d*Et,je+=d*_t,gt+=d*Lt,yt+=d*jt,qe+=d*Ot,xe+=d*Mt,Ne+=d*Pt,$e+=d*Tt,Fe+=d*Ct,Pe+=d*lt,Ue+=d*qt,Se+=d*Ft,d=z[1],fe+=d*St,Ie+=d*vt,Be+=d*It,ke+=d*xt,je+=d*Et,gt+=d*_t,yt+=d*Lt,qe+=d*jt,xe+=d*Ot,Ne+=d*Mt,$e+=d*Pt,Fe+=d*Tt,Pe+=d*Ct,Ue+=d*lt,Se+=d*qt,Ce+=d*Ft,d=z[2],Ie+=d*St,Be+=d*vt,ke+=d*It,je+=d*xt,gt+=d*Et,yt+=d*_t,qe+=d*Lt,xe+=d*jt,Ne+=d*Ot,$e+=d*Mt,Fe+=d*Pt,Pe+=d*Tt,Ue+=d*Ct,Se+=d*lt,Ce+=d*qt,He+=d*Ft,d=z[3],Be+=d*St,ke+=d*vt,je+=d*It,gt+=d*xt,yt+=d*Et,qe+=d*_t,xe+=d*Lt,Ne+=d*jt,$e+=d*Ot,Fe+=d*Mt,Pe+=d*Pt,Ue+=d*Tt,Se+=d*Ct,Ce+=d*lt,He+=d*qt,Oe+=d*Ft,d=z[4],ke+=d*St,je+=d*vt,gt+=d*It,yt+=d*xt,qe+=d*Et,xe+=d*_t,Ne+=d*Lt,$e+=d*jt,Fe+=d*Ot,Pe+=d*Mt,Ue+=d*Pt,Se+=d*Tt,Ce+=d*Ct,He+=d*lt,Oe+=d*qt,Ve+=d*Ft,d=z[5],je+=d*St,gt+=d*vt,yt+=d*It,qe+=d*xt,xe+=d*Et,Ne+=d*_t,$e+=d*Lt,Fe+=d*jt,Pe+=d*Ot,Ue+=d*Mt,Se+=d*Pt,Ce+=d*Tt,He+=d*Ct,Oe+=d*lt,Ve+=d*qt,We+=d*Ft,d=z[6],gt+=d*St,yt+=d*vt,qe+=d*It,xe+=d*xt,Ne+=d*Et,$e+=d*_t,Fe+=d*Lt,Pe+=d*jt,Ue+=d*Ot,Se+=d*Mt,Ce+=d*Pt,He+=d*Tt,Oe+=d*Ct,Ve+=d*lt,We+=d*qt,et+=d*Ft,d=z[7],yt+=d*St,qe+=d*vt,xe+=d*It,Ne+=d*xt,$e+=d*Et,Fe+=d*_t,Pe+=d*Lt,Ue+=d*jt,Se+=d*Ot,Ce+=d*Mt,He+=d*Pt,Oe+=d*Tt,Ve+=d*Ct,We+=d*lt,et+=d*qt,tt+=d*Ft,d=z[8],qe+=d*St,xe+=d*vt,Ne+=d*It,$e+=d*xt,Fe+=d*Et,Pe+=d*_t,Ue+=d*Lt,Se+=d*jt,Ce+=d*Ot,He+=d*Mt,Oe+=d*Pt,Ve+=d*Tt,We+=d*Ct,et+=d*lt,tt+=d*qt,Qe+=d*Ft,d=z[9],xe+=d*St,Ne+=d*vt,$e+=d*It,Fe+=d*xt,Pe+=d*Et,Ue+=d*_t,Se+=d*Lt,Ce+=d*jt,He+=d*Ot,Oe+=d*Mt,Ve+=d*Pt,We+=d*Tt,et+=d*Ct,tt+=d*lt,Qe+=d*qt,rr+=d*Ft,d=z[10],Ne+=d*St,$e+=d*vt,Fe+=d*It,Pe+=d*xt,Ue+=d*Et,Se+=d*_t,Ce+=d*Lt,He+=d*jt,Oe+=d*Ot,Ve+=d*Mt,We+=d*Pt,et+=d*Tt,tt+=d*Ct,Qe+=d*lt,rr+=d*qt,dr+=d*Ft,d=z[11],$e+=d*St,Fe+=d*vt,Pe+=d*It,Ue+=d*xt,Se+=d*Et,Ce+=d*_t,He+=d*Lt,Oe+=d*jt,Ve+=d*Ot,We+=d*Mt,et+=d*Pt,tt+=d*Tt,Qe+=d*Ct,rr+=d*lt,dr+=d*qt,Qr+=d*Ft,d=z[12],Fe+=d*St,Pe+=d*vt,Ue+=d*It,Se+=d*xt,Ce+=d*Et,He+=d*_t,Oe+=d*Lt,Ve+=d*jt,We+=d*Ot,et+=d*Mt,tt+=d*Pt,Qe+=d*Tt,rr+=d*Ct,dr+=d*lt,Qr+=d*qt,ir+=d*Ft,d=z[13],Pe+=d*St,Ue+=d*vt,Se+=d*It,Ce+=d*xt,He+=d*Et,Oe+=d*_t,Ve+=d*Lt,We+=d*jt,et+=d*Ot,tt+=d*Mt,Qe+=d*Pt,rr+=d*Tt,dr+=d*Ct,Qr+=d*lt,ir+=d*qt,ai+=d*Ft,d=z[14],Ue+=d*St,Se+=d*vt,Ce+=d*It,He+=d*xt,Oe+=d*Et,Ve+=d*_t,We+=d*Lt,et+=d*jt,tt+=d*Ot,Qe+=d*Mt,rr+=d*Pt,dr+=d*Tt,Qr+=d*Ct,ir+=d*lt,ai+=d*qt,Oi+=d*Ft,d=z[15],Se+=d*St,Ce+=d*vt,He+=d*It,Oe+=d*xt,Ve+=d*Et,We+=d*_t,et+=d*Lt,tt+=d*jt,Qe+=d*Ot,rr+=d*Mt,dr+=d*Pt,Qr+=d*Tt,ir+=d*Ct,ai+=d*lt,Oi+=d*qt,Hi+=d*Ft,ae+=38*Ce,fe+=38*He,Ie+=38*Oe,Be+=38*Ve,ke+=38*We,je+=38*et,gt+=38*tt,yt+=38*Qe,qe+=38*rr,xe+=38*dr,Ne+=38*Qr,$e+=38*ir,Fe+=38*ai,Pe+=38*Oi,Ue+=38*Hi,R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=Be+R+65535,R=Math.floor(d/65536),Be=d-R*65536,d=ke+R+65535,R=Math.floor(d/65536),ke=d-R*65536,d=je+R+65535,R=Math.floor(d/65536),je=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=yt+R+65535,R=Math.floor(d/65536),yt=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=Ne+R+65535,R=Math.floor(d/65536),Ne=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=Be+R+65535,R=Math.floor(d/65536),Be=d-R*65536,d=ke+R+65535,R=Math.floor(d/65536),ke=d-R*65536,d=je+R+65535,R=Math.floor(d/65536),je=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=yt+R+65535,R=Math.floor(d/65536),yt=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=Ne+R+65535,R=Math.floor(d/65536),Ne=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),B[0]=ae,B[1]=fe,B[2]=Ie,B[3]=Be,B[4]=ke,B[5]=je,B[6]=gt,B[7]=yt,B[8]=qe,B[9]=xe,B[10]=Ne,B[11]=$e,B[12]=Fe,B[13]=Pe,B[14]=Ue,B[15]=Se}function w(B,z){u(B,z,z)}function G(B,z){const U=o();let d;for(d=0;d<16;d++)U[d]=z[d];for(d=253;d>=0;d--)w(U,U),d!==2&&d!==4&&u(U,U,z);for(d=0;d<16;d++)B[d]=U[d]}function W(B,z){const U=o();let d;for(d=0;d<16;d++)U[d]=z[d];for(d=250;d>=0;d--)w(U,U),d!==1&&u(U,U,z);for(d=0;d<16;d++)B[d]=U[d]}function se(B,z){const U=o(),d=o(),R=o(),ae=o(),fe=o(),Ie=o(),Be=o(),ke=o(),je=o();E(U,B[1],B[0]),E(je,z[1],z[0]),u(U,U,je),T(d,B[0],B[1]),T(je,z[0],z[1]),u(d,d,je),u(R,B[3],z[3]),u(R,R,p),u(ae,B[2],z[2]),T(ae,ae,ae),E(fe,d,U),E(Ie,ae,R),T(Be,ae,R),T(ke,d,U),u(B[0],fe,Ie),u(B[1],ke,Be),u(B[2],Be,Ie),u(B[3],fe,ke)}function ue(B,z,U){for(let d=0;d<4;d++)F(B[d],z[d],U)}function de(B,z){const U=o(),d=o(),R=o();G(R,z[2]),u(U,z[0],R),u(d,z[1],R),H(B,d),B[31]^=M(U)<<7}function b(B,z,U){x(B[0],l),x(B[1],f),x(B[2],f),x(B[3],l);for(let d=255;d>=0;--d){const R=U[d/8|0]>>(d&7)&1;ue(B,z,R),se(z,B),se(B,B),ue(B,z,R)}}function A(B,z){const U=[o(),o(),o(),o()];x(U[0],v),x(U[1],D),x(U[2],f),u(U[3],v,D),b(B,U,z)}function ee(B){if(B.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const z=(0,t.hash)(B);z[0]&=248,z[31]&=127,z[31]|=64;const U=new Uint8Array(32),d=[o(),o(),o(),o()];A(d,z),de(U,d);const R=new Uint8Array(64);return R.set(B),R.set(U,32),{publicKey:U,secretKey:R}}i.generateKeyPairFromSeed=ee;function Q(B){const z=(0,e.randomBytes)(32,B),U=ee(z);return(0,s.wipe)(z),U}i.generateKeyPair=Q;function k(B){if(B.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}i.extractPublicKeyFromSecretKey=k;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(B,z){let U,d,R,ae;for(d=63;d>=32;--d){for(U=0,R=d-32,ae=d-12;R<ae;++R)z[R]+=U-16*z[d]*V[R-(d-32)],U=Math.floor((z[R]+128)/256),z[R]-=U*256;z[R]+=U,z[d]=0}for(U=0,R=0;R<32;R++)z[R]+=U-(z[31]>>4)*V[R],U=z[R]>>8,z[R]&=255;for(R=0;R<32;R++)z[R]-=U*V[R];for(d=0;d<32;d++)z[d+1]+=z[d]>>8,B[d]=z[d]&255}function re(B){const z=new Float64Array(64);for(let U=0;U<64;U++)z[U]=B[U];for(let U=0;U<64;U++)B[U]=0;J(B,z)}function we(B,z){const U=new Float64Array(64),d=[o(),o(),o(),o()],R=(0,t.hash)(B.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const ae=new Uint8Array(64);ae.set(R.subarray(32),32);const fe=new t.SHA512;fe.update(ae.subarray(32)),fe.update(z);const Ie=fe.digest();fe.clean(),re(Ie),A(d,Ie),de(ae,d),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(B.subarray(32)),fe.update(z);const Be=fe.digest();re(Be);for(let ke=0;ke<32;ke++)U[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let je=0;je<32;je++)U[ke+je]+=Be[ke]*R[je];return J(ae.subarray(32),U),ae}i.sign=we;function oe(B,z){const U=o(),d=o(),R=o(),ae=o(),fe=o(),Ie=o(),Be=o();return x(B[2],f),C(B[1],z),w(R,B[1]),u(ae,R,g),E(R,R,B[2]),T(ae,B[2],ae),w(fe,ae),w(Ie,fe),u(Be,Ie,fe),u(U,Be,R),u(U,U,ae),W(U,U),u(U,U,R),u(U,U,ae),u(U,U,ae),u(B[0],U,ae),w(d,B[0]),u(d,d,ae),$(d,R)&&u(B[0],B[0],S),w(d,B[0]),u(d,d,ae),$(d,R)?-1:(M(B[0])===z[31]>>7&&E(B[0],l,B[0]),u(B[3],B[0],B[1]),0)}function be(B,z,U){const d=new Uint8Array(32),R=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(ae,B))return!1;const fe=new t.SHA512;fe.update(U.subarray(0,32)),fe.update(B),fe.update(z);const Ie=fe.digest();return re(Ie),b(R,ae,Ie),A(ae,U.subarray(32)),se(R,ae),de(d,R),!ie(U,d)}i.verify=be;function le(B){let z=[o(),o(),o(),o()];if(oe(z,B))throw new Error("Ed25519: invalid public key");let U=o(),d=o(),R=z[1];T(U,f,R),E(d,f,R),G(d,d),u(U,U,d);let ae=new Uint8Array(32);return H(ae,U),ae}i.convertPublicKeyToX25519=le;function _e(B){const z=(0,t.hash)(B.subarray(0,32));z[0]&=248,z[31]&=127,z[31]|=64;const U=new Uint8Array(z.subarray(0,32));return(0,s.wipe)(z),U}i.convertSecretKeyToX25519=_e})(ih);const qS="EdDSA",FS="JWT",Up=".",Lp="base64url",zS="utf8",BS="utf8",HS=":",KS="did",kS="key",sd="base58btc",VS="z",GS="K36",WS=32;function ra(i){return fr(br(un(i),zS),Lp)}function jp(i){const e=br(GS,sd),t=VS+fr(yu([e,i]),sd);return[KS,kS,t].join(HS)}function YS(i){return fr(i,Lp)}function JS(i){return br([ra(i.header),ra(i.payload)].join(Up),BS)}function QS(i){return[ra(i.header),ra(i.payload),YS(i.signature)].join(Up)}function od(i=Bn.randomBytes(WS)){return ih.generateKeyPairFromSeed(i)}async function XS(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:qS,typ:FS},l=jp(s.publicKey),f=o+t,g={iss:l,sub:i,aud:e,iat:o,exp:f},p=JS({header:c,payload:g}),v=ih.sign(s.secretKey,p);return QS({header:c,payload:g,signature:v})}const ZS="PARSE_ERROR",e2="INVALID_REQUEST",t2="METHOD_NOT_FOUND",r2="INVALID_PARAMS",Mp="INTERNAL_ERROR",nh="SERVER_ERROR",i2=[-32700,-32600,-32601,-32602,-32603],Ds={[ZS]:{code:-32700,message:"Parse error"},[e2]:{code:-32600,message:"Invalid Request"},[t2]:{code:-32601,message:"Method not found"},[r2]:{code:-32602,message:"Invalid params"},[Mp]:{code:-32603,message:"Internal error"},[nh]:{code:-32e3,message:"Server error"}},qp=nh;function n2(i){return i2.includes(i)}function ad(i){return Object.keys(Ds).includes(i)?Ds[i]:Ds[qp]}function s2(i){const e=Object.values(Ds).find(t=>t.code===i);return e||Ds[qp]}function Fp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var zp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ru=function(i,e){return Ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Ru(i,e)};function o2(i,e){Ru(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nu=function(){return Nu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Nu.apply(this,arguments)};function a2(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function c2(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function u2(i,e){return function(t,s){e(t,s,i)}}function h2(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function l2(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function f2(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function d2(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function p2(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function $u(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function g2(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Bp(arguments[e]));return i}function y2(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function As(i){return this instanceof As?(this.v=i,this):new As(i)}function v2(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,F){c.push([S,x,O,F])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof As?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function _2(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:As(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function m2(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof $u=="function"?$u(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function w2(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function b2(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function E2(i){return i&&i.__esModule?i:{default:i}}function D2(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function S2(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const I2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nu},__asyncDelegator:_2,__asyncGenerator:v2,__asyncValues:m2,__await:As,__awaiter:l2,__classPrivateFieldGet:D2,__classPrivateFieldSet:S2,__createBinding:d2,__decorate:c2,__exportStar:p2,__extends:o2,__generator:f2,__importDefault:E2,__importStar:b2,__makeTemplateObject:w2,__metadata:h2,__param:u2,__read:Bp,__rest:a2,__spread:g2,__spreadArrays:y2,__values:$u},Symbol.toStringTag,{value:"Module"})),x2=zn(I2);var mi={},cd;function O2(){if(cd)return mi;cd=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowserCryptoAvailable=mi.getSubtleCrypto=mi.getBrowerCrypto=void 0;function i(){return(Jr===null||Jr===void 0?void 0:Jr.crypto)||(Jr===null||Jr===void 0?void 0:Jr.msCrypto)||{}}mi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}mi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return mi.isBrowserCryptoAvailable=t,mi}var wi={},ud;function P2(){if(ud)return wi;ud=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.isBrowser=wi.isNode=wi.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}wi.isReactNative=i;function e(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}wi.isNode=e;function t(){return!i()&&!e()}return wi.isBrowser=t,wi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=x2;e.__exportStar(O2(),i),e.__exportStar(P2(),i)})(zp);function sh(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Hp(i=6){return BigInt(sh(i))}function Fn(i,e,t){return{id:t||sh(),jsonrpc:"2.0",method:i,params:e}}function da(i,e){return{id:i,jsonrpc:"2.0",result:e}}function pa(i,e,t){return{id:i,jsonrpc:"2.0",error:C2(e,t)}}function C2(i,e){return typeof i>"u"?ad(Mp):(typeof i=="string"&&(i=Object.assign(Object.assign({},ad(nh)),{message:i})),typeof e<"u"&&(i.data=e),n2(i.code)&&(i=s2(i.code)),i)}class A2{}class T2 extends A2{constructor(){super()}}class R2 extends T2{constructor(e){super()}}const N2="^https?:",$2="^wss?:";function U2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Kp(i,e){const t=U2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function hd(i){return Kp(i,N2)}function ld(i){return Kp(i,$2)}function L2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function kp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function oh(i){return kp(i)&&"method"in i}function ga(i){return kp(i)&&(Si(i)||Yr(i))}function Si(i){return"result"in i}function Yr(i){return"error"in i}class Ii extends R2{constructor(e){super(e),this.events=new zr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Fn(e.method,e.params||[],e.id||Hp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Yr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ga(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const j2=()=>typeof WebSocket<"u"?WebSocket:typeof st<"u"&&typeof st.WebSocket<"u"?st.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),M2=()=>typeof WebSocket<"u"||typeof st<"u"&&typeof st.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",fd=i=>i.split("?")[0],dd=10,q2=j2();let F2=class{constructor(e){if(this.url=e,this.events=new zr.EventEmitter,this.registering=!1,!ld(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(un(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!ld(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=zp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!L2(e)},l=new q2(e,[],c);M2()?l.onerror=f=>{const g=f;s(this.emitError(g.error))}:l.on("error",f=>{s(this.emitError(f))}),l.onopen=()=>{this.onOpen(l),t(l)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ls(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=pa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Fp(e,fd(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>dd&&this.events.setMaxListeners(dd)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${fd(this.url)}`));return this.events.emit("register_error",t),t}};var ia={exports:{}};ia.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",g="[object Array]",p="[object AsyncFunction]",v="[object Boolean]",D="[object Date]",S="[object Error]",x="[object Function]",O="[object GeneratorFunction]",F="[object Map]",H="[object Number]",ie="[object Null]",$="[object Object]",M="[object Promise]",C="[object Proxy]",T="[object RegExp]",E="[object Set]",u="[object String]",w="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",se="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",b="[object Float64Array]",A="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",k="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",we=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[b]=le[A]=le[ee]=le[Q]=le[k]=le[V]=le[J]=le[re]=!0,le[f]=le[g]=le[se]=le[v]=le[ue]=le[D]=le[S]=le[x]=le[F]=le[H]=le[$]=le[T]=le[E]=le[u]=le[W]=!1;var _e=typeof Jr=="object"&&Jr&&Jr.Object===Object&&Jr,B=typeof self=="object"&&self&&self.Object===Object&&self,z=_e||B||Function("return this")(),U=e&&!e.nodeType&&e,d=U&&!0&&i&&!i.nodeType&&i,R=d&&d.exports===U,ae=R&&_e.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function Be(I,L){for(var te=-1,pe=I==null?0:I.length,ct=0,Te=[];++te<pe;){var dt=I[te];L(dt,te,I)&&(Te[ct++]=dt)}return Te}function ke(I,L){for(var te=-1,pe=L.length,ct=I.length;++te<pe;)I[ct+te]=L[te];return I}function je(I,L){for(var te=-1,pe=I==null?0:I.length;++te<pe;)if(L(I[te],te,I))return!0;return!1}function gt(I,L){for(var te=-1,pe=Array(I);++te<I;)pe[te]=L(te);return pe}function yt(I){return function(L){return I(L)}}function qe(I,L){return I.has(L)}function xe(I,L){return I==null?void 0:I[L]}function Ne(I){var L=-1,te=Array(I.size);return I.forEach(function(pe,ct){te[++L]=[ct,pe]}),te}function $e(I,L){return function(te){return I(L(te))}}function Fe(I){var L=-1,te=Array(I.size);return I.forEach(function(pe){te[++L]=pe}),te}var Pe=Array.prototype,Ue=Function.prototype,Se=Object.prototype,Ce=z["__core-js_shared__"],He=Ue.toString,Oe=Se.hasOwnProperty,Ve=function(){var I=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),We=Se.toString,et=RegExp("^"+He.call(Oe).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=R?z.Buffer:void 0,Qe=z.Symbol,rr=z.Uint8Array,dr=Se.propertyIsEnumerable,Qr=Pe.splice,ir=Qe?Qe.toStringTag:void 0,ai=Object.getOwnPropertySymbols,Oi=tt?tt.isBuffer:void 0,Hi=$e(Object.keys,Object),St=Er(z,"DataView"),vt=Er(z,"Map"),It=Er(z,"Promise"),xt=Er(z,"Set"),Et=Er(z,"WeakMap"),_t=Er(Object,"create"),Lt=ui(St),jt=ui(vt),Ot=ui(It),Mt=ui(xt),Pt=ui(Et),Tt=Qe?Qe.prototype:void 0,Ct=Tt?Tt.valueOf:void 0;function lt(I){var L=-1,te=I==null?0:I.length;for(this.clear();++L<te;){var pe=I[L];this.set(pe[0],pe[1])}}function qt(){this.__data__=_t?_t(null):{},this.size=0}function Ft(I){var L=this.has(I)&&delete this.__data__[I];return this.size-=L?1:0,L}function _a(I){var L=this.__data__;if(_t){var te=L[I];return te===s?void 0:te}return Oe.call(L,I)?L[I]:void 0}function ma(I){var L=this.__data__;return _t?L[I]!==void 0:Oe.call(L,I)}function wa(I,L){var te=this.__data__;return this.size+=this.has(I)?0:1,te[I]=_t&&L===void 0?s:L,this}lt.prototype.clear=qt,lt.prototype.delete=Ft,lt.prototype.get=_a,lt.prototype.has=ma,lt.prototype.set=wa;function Tr(I){var L=-1,te=I==null?0:I.length;for(this.clear();++L<te;){var pe=I[L];this.set(pe[0],pe[1])}}function ba(){this.__data__=[],this.size=0}function Ea(I){var L=this.__data__,te=Ki(L,I);if(te<0)return!1;var pe=L.length-1;return te==pe?L.pop():Qr.call(L,te,1),--this.size,!0}function Da(I){var L=this.__data__,te=Ki(L,I);return te<0?void 0:L[te][1]}function Sa(I){return Ki(this.__data__,I)>-1}function Ia(I,L){var te=this.__data__,pe=Ki(te,I);return pe<0?(++this.size,te.push([I,L])):te[pe][1]=L,this}Tr.prototype.clear=ba,Tr.prototype.delete=Ea,Tr.prototype.get=Da,Tr.prototype.has=Sa,Tr.prototype.set=Ia;function ci(I){var L=-1,te=I==null?0:I.length;for(this.clear();++L<te;){var pe=I[L];this.set(pe[0],pe[1])}}function gn(){this.size=0,this.__data__={hash:new lt,map:new(vt||Tr),string:new lt}}function xa(I){var L=Pi(this,I).delete(I);return this.size-=L?1:0,L}function yn(I){return Pi(this,I).get(I)}function Oa(I){return Pi(this,I).has(I)}function Pa(I,L){var te=Pi(this,I),pe=te.size;return te.set(I,L),this.size+=te.size==pe?0:1,this}ci.prototype.clear=gn,ci.prototype.delete=xa,ci.prototype.get=yn,ci.prototype.has=Oa,ci.prototype.set=Pa;function vn(I){var L=-1,te=I==null?0:I.length;for(this.__data__=new ci;++L<te;)this.add(I[L])}function Ms(I){return this.__data__.set(I,s),this}function qs(I){return this.__data__.has(I)}vn.prototype.add=vn.prototype.push=Ms,vn.prototype.has=qs;function Br(I){var L=this.__data__=new Tr(I);this.size=L.size}function Ca(){this.__data__=new Tr,this.size=0}function Aa(I){var L=this.__data__,te=L.delete(I);return this.size=L.size,te}function Ta(I){return this.__data__.get(I)}function Ra(I){return this.__data__.has(I)}function Fs(I,L){var te=this.__data__;if(te instanceof Tr){var pe=te.__data__;if(!vt||pe.length<t-1)return pe.push([I,L]),this.size=++te.size,this;te=this.__data__=new ci(pe)}return te.set(I,L),this.size=te.size,this}Br.prototype.clear=Ca,Br.prototype.delete=Aa,Br.prototype.get=Ta,Br.prototype.has=Ra,Br.prototype.set=Fs;function zs(I,L){var te=wn(I),pe=!te&&Zs(I),ct=!te&&!pe&&Jn(I),Te=!te&&!pe&&!ct&&ro(I),dt=te||pe||ct||Te,zt=dt?gt(I.length,String):[],Xe=zt.length;for(var ut in I)(L||Oe.call(I,ut))&&!(dt&&(ut=="length"||ct&&(ut=="offset"||ut=="parent")||Te&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||Ws(ut,Xe)))&&zt.push(ut);return zt}function Ki(I,L){for(var te=I.length;te--;)if(Xs(I[te][0],L))return te;return-1}function Wn(I,L,te){var pe=L(I);return wn(I)?pe:ke(pe,te(I))}function ki(I){return I==null?I===void 0?G:ie:ir&&ir in Object(I)?Vs(I):Ua(I)}function Yn(I){return Gi(I)&&ki(I)==f}function Vi(I,L,te,pe,ct){return I===L?!0:I==null||L==null||!Gi(I)&&!Gi(L)?I!==I&&L!==L:Bs(I,L,te,pe,Vi,ct)}function Bs(I,L,te,pe,ct,Te){var dt=wn(I),zt=wn(L),Xe=dt?g:Xr(I),ut=zt?g:Xr(L);Xe=Xe==f?$:Xe,ut=ut==f?$:ut;var Rt=Xe==$,pr=ut==$,Bt=Xe==ut;if(Bt&&Jn(I)){if(!Jn(L))return!1;dt=!0,Rt=!1}if(Bt&&!Rt)return Te||(Te=new Br),dt||ro(I)?_n(I,L,te,pe,ct,Te):$a(I,L,Xe,te,pe,ct,Te);if(!(te&o)){var pt=Rt&&Oe.call(I,"__wrapped__"),nr=pr&&Oe.call(L,"__wrapped__");if(pt||nr){var Hr=pt?I.value():I,Rr=nr?L.value():L;return Te||(Te=new Br),ct(Hr,Rr,te,pe,Te)}}return Bt?(Te||(Te=new Br),ks(I,L,te,pe,ct,Te)):!1}function Na(I){if(!to(I)||Js(I))return!1;var L=bn(I)?et:oe;return L.test(ui(I))}function Hs(I){return Gi(I)&&eo(I.length)&&!!le[ki(I)]}function Ks(I){if(!Qs(I))return Hi(I);var L=[];for(var te in Object(I))Oe.call(I,te)&&te!="constructor"&&L.push(te);return L}function _n(I,L,te,pe,ct,Te){var dt=te&o,zt=I.length,Xe=L.length;if(zt!=Xe&&!(dt&&Xe>zt))return!1;var ut=Te.get(I);if(ut&&Te.get(L))return ut==L;var Rt=-1,pr=!0,Bt=te&c?new vn:void 0;for(Te.set(I,L),Te.set(L,I);++Rt<zt;){var pt=I[Rt],nr=L[Rt];if(pe)var Hr=dt?pe(nr,pt,Rt,L,I,Te):pe(pt,nr,Rt,I,L,Te);if(Hr!==void 0){if(Hr)continue;pr=!1;break}if(Bt){if(!je(L,function(Rr,Zr){if(!qe(Bt,Zr)&&(pt===Rr||ct(pt,Rr,te,pe,Te)))return Bt.push(Zr)})){pr=!1;break}}else if(!(pt===nr||ct(pt,nr,te,pe,Te))){pr=!1;break}}return Te.delete(I),Te.delete(L),pr}function $a(I,L,te,pe,ct,Te,dt){switch(te){case ue:if(I.byteLength!=L.byteLength||I.byteOffset!=L.byteOffset)return!1;I=I.buffer,L=L.buffer;case se:return!(I.byteLength!=L.byteLength||!Te(new rr(I),new rr(L)));case v:case D:case H:return Xs(+I,+L);case S:return I.name==L.name&&I.message==L.message;case T:case u:return I==L+"";case F:var zt=Ne;case E:var Xe=pe&o;if(zt||(zt=Fe),I.size!=L.size&&!Xe)return!1;var ut=dt.get(I);if(ut)return ut==L;pe|=c,dt.set(I,L);var Rt=_n(zt(I),zt(L),pe,ct,Te,dt);return dt.delete(I),Rt;case w:if(Ct)return Ct.call(I)==Ct.call(L)}return!1}function ks(I,L,te,pe,ct,Te){var dt=te&o,zt=mn(I),Xe=zt.length,ut=mn(L),Rt=ut.length;if(Xe!=Rt&&!dt)return!1;for(var pr=Xe;pr--;){var Bt=zt[pr];if(!(dt?Bt in L:Oe.call(L,Bt)))return!1}var pt=Te.get(I);if(pt&&Te.get(L))return pt==L;var nr=!0;Te.set(I,L),Te.set(L,I);for(var Hr=dt;++pr<Xe;){Bt=zt[pr];var Rr=I[Bt],Zr=L[Bt];if(pe)var Qn=dt?pe(Zr,Rr,Bt,L,I,Te):pe(Rr,Zr,Bt,I,L,Te);if(!(Qn===void 0?Rr===Zr||ct(Rr,Zr,te,pe,Te):Qn)){nr=!1;break}Hr||(Hr=Bt=="constructor")}if(nr&&!Hr){var Wi=I.constructor,kt=L.constructor;Wi!=kt&&"constructor"in I&&"constructor"in L&&!(typeof Wi=="function"&&Wi instanceof Wi&&typeof kt=="function"&&kt instanceof kt)&&(nr=!1)}return Te.delete(I),Te.delete(L),nr}function mn(I){return Wn(I,Ma,Gs)}function Pi(I,L){var te=I.__data__;return Ys(L)?te[typeof L=="string"?"string":"hash"]:te.map}function Er(I,L){var te=xe(I,L);return Na(te)?te:void 0}function Vs(I){var L=Oe.call(I,ir),te=I[ir];try{I[ir]=void 0;var pe=!0}catch{}var ct=We.call(I);return pe&&(L?I[ir]=te:delete I[ir]),ct}var Gs=ai?function(I){return I==null?[]:(I=Object(I),Be(ai(I),function(L){return dr.call(I,L)}))}:at,Xr=ki;(St&&Xr(new St(new ArrayBuffer(1)))!=ue||vt&&Xr(new vt)!=F||It&&Xr(It.resolve())!=M||xt&&Xr(new xt)!=E||Et&&Xr(new Et)!=W)&&(Xr=function(I){var L=ki(I),te=L==$?I.constructor:void 0,pe=te?ui(te):"";if(pe)switch(pe){case Lt:return ue;case jt:return F;case Ot:return M;case Mt:return E;case Pt:return W}return L});function Ws(I,L){return L=L??l,!!L&&(typeof I=="number"||be.test(I))&&I>-1&&I%1==0&&I<L}function Ys(I){var L=typeof I;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?I!=="__proto__":I===null}function Js(I){return!!Ve&&Ve in I}function Qs(I){var L=I&&I.constructor,te=typeof L=="function"&&L.prototype||Se;return I===te}function Ua(I){return We.call(I)}function ui(I){if(I!=null){try{return He.call(I)}catch{}try{return I+""}catch{}}return""}function Xs(I,L){return I===L||I!==I&&L!==L}var Zs=Yn(function(){return arguments}())?Yn:function(I){return Gi(I)&&Oe.call(I,"callee")&&!dr.call(I,"callee")},wn=Array.isArray;function La(I){return I!=null&&eo(I.length)&&!bn(I)}var Jn=Oi||ot;function ja(I,L){return Vi(I,L)}function bn(I){if(!to(I))return!1;var L=ki(I);return L==x||L==O||L==p||L==C}function eo(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=l}function to(I){var L=typeof I;return I!=null&&(L=="object"||L=="function")}function Gi(I){return I!=null&&typeof I=="object"}var ro=Ie?yt(Ie):Hs;function Ma(I){return La(I)?zs(I):Ks(I)}function at(){return[]}function ot(){return!1}i.exports=ja})(ia,ia.exports);var z2=ia.exports;const B2=Hu(z2);function H2(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],l=[],f={},g=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:g,headers:{keys:function(){return c},entries:function(){return l},get:function(v){return f[v.toLowerCase()]},has:function(v){return v.toLowerCase()in f}}}};for(var p in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,D,S){c.push(D=D.toLowerCase()),l.push([D,S]),f[D]=f[D]?f[D]+","+S:S}),t(g())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}const K2=Object.freeze(Object.defineProperty({__proto__:null,default:H2},Symbol.toStringTag,{value:"Module"})),pd=zn(K2);var k2=self.fetch||(self.fetch=pd.default||pd);const V2=Hu(k2);var G2={};function W2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var F=0,H=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,F++;for(var M=($-ie)*v+1>>>0,C=new Uint8Array(M);ie!==$;){for(var T=O[ie],E=0,u=M-1;(T!==0||E<H)&&u!==-1;u--,E++)T+=256*C[u]>>>0,C[u]=T%f>>>0,T=T/f>>>0;if(T!==0)throw new Error("Non-zero carry");H=E,ie++}for(var w=M-H;w!==M&&C[w]===0;)w++;for(var G=g.repeat(F);w<M;++w)G+=i.charAt(C[w]);return G}function S(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var F=0;if(O[F]!==" "){for(var H=0,ie=0;O[F]===g;)H++,F++;for(var $=(O.length-F)*p+1>>>0,M=new Uint8Array($);O[F];){var C=t[O.charCodeAt(F)];if(C===255)return;for(var T=0,E=$-1;(C!==0||T<ie)&&E!==-1;E--,T++)C+=f*M[E]>>>0,M[E]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");ie=T,F++}if(O[F]!==" "){for(var u=$-ie;u!==$&&M[u]===0;)u++;for(var w=new Uint8Array(H+($-u)),G=H;u!==$;)w[G++]=M[u++];return w}}}function x(O){var F=S(O);if(F)return F;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:x}}var Y2=W2,J2=Y2;const Vp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Q2=i=>new TextEncoder().encode(i),X2=i=>new TextDecoder().decode(i);class Z2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class e6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Gp(this,e)}}class t6{constructor(e){this.decoders=e}or(e){return Gp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Gp=(i,e)=>new t6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class r6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Z2(e,t,s),this.decoder=new e6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ya=({name:i,prefix:e,encode:t,decode:s})=>new r6(i,e,t,s),js=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=J2(t,e);return ya({prefix:i,name:e,encode:s,decode:c=>Vp(o(c))})},i6=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const D=o[i[v]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|D,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},n6=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Qt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ya({prefix:e,name:i,encode(o){return n6(o,s,t)},decode(o){return i6(o,s,t,i)}}),s6=ya({prefix:"\0",name:"identity",encode:i=>X2(i),decode:i=>Q2(i)});var o6=Object.freeze({__proto__:null,identity:s6});const a6=Qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var c6=Object.freeze({__proto__:null,base2:a6});const u6=Qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var h6=Object.freeze({__proto__:null,base8:u6});const l6=js({prefix:"9",name:"base10",alphabet:"0123456789"});var f6=Object.freeze({__proto__:null,base10:l6});const d6=Qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),p6=Qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var g6=Object.freeze({__proto__:null,base16:d6,base16upper:p6});const y6=Qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v6=Qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_6=Qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),m6=Qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),w6=Qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),b6=Qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),E6=Qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),D6=Qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),S6=Qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var I6=Object.freeze({__proto__:null,base32:y6,base32upper:v6,base32pad:_6,base32padupper:m6,base32hex:w6,base32hexupper:b6,base32hexpad:E6,base32hexpadupper:D6,base32z:S6});const x6=js({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),O6=js({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var P6=Object.freeze({__proto__:null,base36:x6,base36upper:O6});const C6=js({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),A6=js({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var T6=Object.freeze({__proto__:null,base58btc:C6,base58flickr:A6});const R6=Qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),N6=Qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$6=Qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),U6=Qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var L6=Object.freeze({__proto__:null,base64:R6,base64pad:N6,base64url:$6,base64urlpad:U6});const Wp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),j6=Wp.reduce((i,e,t)=>(i[t]=e,i),[]),M6=Wp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function q6(i){return i.reduce((e,t)=>(e+=j6[t],e),"")}function F6(i){const e=[];for(const t of i){const s=M6[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const z6=ya({prefix:"🚀",name:"base256emoji",encode:q6,decode:F6});var B6=Object.freeze({__proto__:null,base256emoji:z6}),H6=Yp,gd=128,K6=127,k6=~K6,V6=Math.pow(2,31);function Yp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=V6;)e[t++]=i&255|gd,i/=128;for(;i&k6;)e[t++]=i&255|gd,i>>>=7;return e[t]=i|0,Yp.bytes=t-s+1,e}var G6=Uu,W6=128,yd=127;function Uu(i,s){var t=0,s=s||0,o=0,c=s,l,f=i.length;do{if(c>=f)throw Uu.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&yd)<<o:(l&yd)*Math.pow(2,o),o+=7}while(l>=W6);return Uu.bytes=c-s,t}var Y6=Math.pow(2,7),J6=Math.pow(2,14),Q6=Math.pow(2,21),X6=Math.pow(2,28),Z6=Math.pow(2,35),eI=Math.pow(2,42),tI=Math.pow(2,49),rI=Math.pow(2,56),iI=Math.pow(2,63),nI=function(i){return i<Y6?1:i<J6?2:i<Q6?3:i<X6?4:i<Z6?5:i<eI?6:i<tI?7:i<rI?8:i<iI?9:10},sI={encode:H6,decode:G6,encodingLength:nI},Jp=sI;const vd=(i,e,t=0)=>(Jp.encode(i,e,t),e),_d=i=>Jp.encodingLength(i),Lu=(i,e)=>{const t=e.byteLength,s=_d(i),o=s+_d(t),c=new Uint8Array(o+t);return vd(i,c,0),vd(t,c,s),c.set(e,o),new oI(i,t,e,c)};class oI{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Qp=({name:i,code:e,encode:t})=>new aI(i,e,t);class aI{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Lu(this.code,t):t.then(s=>Lu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Xp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),cI=Qp({name:"sha2-256",code:18,encode:Xp("SHA-256")}),uI=Qp({name:"sha2-512",code:19,encode:Xp("SHA-512")});var hI=Object.freeze({__proto__:null,sha256:cI,sha512:uI});const Zp=0,lI="identity",eg=Vp,fI=i=>Lu(Zp,eg(i)),dI={code:Zp,name:lI,encode:eg,digest:fI};var pI=Object.freeze({__proto__:null,identity:dI});new TextEncoder,new TextDecoder;const md={...o6,...c6,...h6,...f6,...g6,...I6,...P6,...T6,...L6,...B6};({...hI,...pI});function tg(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function gI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?tg(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function rg(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const wd=rg("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),ru=rg("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=gI(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),yI={utf8:wd,"utf-8":wd,hex:md.base16,latin1:ru,ascii:ru,binary:ru,...md};function vI(i,e="utf8"){const t=yI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tg(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const ig="wc",_I=2,ah="core",qi=`${ig}@2:${ah}:`,mI={name:ah,logger:"error"},wI={database:":memory:"},bI="crypto",bd="client_ed25519_seed",EI=ve.ONE_DAY,DI="keychain",SI="0.3",II="messages",xI="0.3",OI=ve.SIX_HOURS,PI="publisher",ng="irn",CI="error",sg="wss://relay.walletconnect.com",Ed="wss://relay.walletconnect.org",AI="relayer",tr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},TI="_subscription",bi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},RI=ve.ONE_SECOND,NI="2.11.2",$I=1e4,UI="0.3",LI="WALLETCONNECT_CLIENT_ID",Wr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},jI="subscription",MI="0.3",qI=ve.FIVE_SECONDS*1e3,FI="pairing",zI="0.3",vs={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},bs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ni={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},BI="history",HI="0.3",KI="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},kI="0.3",iu="verify-api",Mn="https://verify.walletconnect.com",ju="https://verify.walletconnect.org",VI=[Mn,ju],GI="echo",WI="https://echo.walletconnect.com";class YI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=DI,this.version=SI,this.initialized=!1,this.storagePrefix=qi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,bp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ep(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class JI{constructor(e,t,s){this.core=e,this.logger=t,this.name=bI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=od(o);return jp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=ME();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=od(c),f=Du();return await XS(f,o,EI,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),g=qE(f,c);return this.setSymKey(g,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||FE(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=wp(l),g=un(c);if($f(f)){const S=f.senderPublicKey,x=f.receiverPublicKey;o=await this.generateSharedKey(S,x)}const p=this.getSymKey(o),{type:v,senderPublicKey:D}=f;return BE({type:v,symKey:p,message:g,senderPublicKey:D})},this.decode=async(o,c,l)=>{this.isInitialized();const f=kE(c,l);if($f(f)){const g=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(g,p)}try{const g=this.getSymKey(o),p=HE({symKey:g,encoded:c});return Ls(p)}catch(g){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=o=>{const c=ea(o);return Ns(c.type)},this.getPayloadSenderPublicKey=o=>{const c=ea(o);return c.senderPublicKey?fr(c.senderPublicKey,lr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new YI(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(bd)}catch{e=Du(),await this.keychain.set(bd,e)}return vI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class QI extends CS{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=II,this.version=xI,this.initialized=!1,this.storagePrefix=qi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=qn(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=qn(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,bp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ep(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class XI extends AS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new zr.EventEmitter,this.name=PI,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||OI,g=Su(c),p=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,D=(c==null?void 0:c.id)||Hp().toString(),S={topic:s,message:o,opts:{ttl:f,relay:g,prompt:p,tag:v,id:D}},x=setTimeout(()=>this.queue.set(D,S),this.publishTimeout);try{await await xs(this.rpcPublish(s,o,f,g,p,v,D),this.publishTimeout,`Failed to publish payload, please try again. id:${D} tag:${v}`),this.removeRequestFromQueue(D),this.relayer.events.emit(tr.publish,S)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(D),O;return}finally{clearTimeout(x)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,f){var g,p,v,D;const S={method:Yo(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return hr((g=S.params)==null?void 0:g.prompt)&&((p=S.params)==null||delete p.prompt),hr((v=S.params)==null?void 0:v.tag)&&((D=S.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tr.connection_stalled);return}this.checkQueue()}),this.relayer.on(tr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class ZI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var ex=Object.defineProperty,tx=Object.defineProperties,rx=Object.getOwnPropertyDescriptors,Dd=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,Sd=(i,e,t)=>e in i?ex(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,_s=(i,e)=>{for(var t in e||(e={}))ix.call(e,t)&&Sd(i,t,e[t]);if(Dd)for(var t of Dd(e))nx.call(e,t)&&Sd(i,t,e[t]);return i},nu=(i,e)=>tx(i,rx(e));class sx extends NS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new ZI,this.events=new zr.EventEmitter,this.name=jI,this.version=MI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=qi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Su(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,l)=>{const f=new ve.Watch;f.start(o);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(o),c(!0)),f.elapsed(o)>=qI&&(clearInterval(g),f.stop(o),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Su(s);await this.rpcUnsubscribe(e,t,o);const c=wt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Yo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}return qn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Yo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Yo(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,nu(_s({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,_s({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,_s({},t)),this.topicMap.set(t.topic,e),this.events.emit(Wr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Wr.deleted,nu(_s({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Wr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Wr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);oi(t)&&this.onBatchSubscribe(t.map((s,o)=>nu(_s({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(tr.connect,async()=>{await this.onConnect()}),this.relayer.on(tr.disconnect,()=>{this.onDisconnect()}),this.events.on(Wr.created,async e=>{const t=Wr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Wr.deleted,async e=>{const t=Wr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var ox=Object.defineProperty,Id=Object.getOwnPropertySymbols,ax=Object.prototype.hasOwnProperty,cx=Object.prototype.propertyIsEnumerable,xd=(i,e,t)=>e in i?ox(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ux=(i,e)=>{for(var t in e||(e={}))ax.call(e,t)&&xd(i,t,e[t]);if(Id)for(var t of Id(e))cx.call(e,t)&&xd(i,t,e[t]);return i};class hx extends TS{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new zr.EventEmitter,this.name=AI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(tr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(tr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(bi.payload,this.onPayloadHandler),this.provider.on(bi.connect,this.onConnectHandler),this.provider.on(bi.disconnect,this.onDisconnectHandler),this.provider.on(bi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||CI})),this.messages=new QI(this.logger,e.core),this.subscriber=new sx(this,this.logger),this.publisher=new XI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||sg,this.projectId=e.projectId,this.bundleId=QE(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ed}...`),await this.restartTransport(Ed)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},$I)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const l=f=>{f.topic===e&&(this.subscriber.off(Wr.created,l),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Wr.created,l)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await xs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Wr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await xs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(bi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await kf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ii(new F2(i3({sdkVersion:NI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),oh(e)){if(!e.method.endsWith(TI))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ux({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else ga(e)&&this.events.emit(tr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=da(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(bi.payload,this.onPayloadHandler),this.provider.off(bi.connect,this.onConnectHandler),this.provider.off(bi.disconnect,this.onDisconnectHandler),this.provider.off(bi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(tr.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await kf();Q3(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(tr.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(RI)))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var lx=Object.defineProperty,Od=Object.getOwnPropertySymbols,fx=Object.prototype.hasOwnProperty,dx=Object.prototype.propertyIsEnumerable,Pd=(i,e,t)=>e in i?lx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Cd=(i,e)=>{for(var t in e||(e={}))fx.call(e,t)&&Pd(i,t,e[t]);if(Od)for(var t of Od(e))dx.call(e,t)&&Pd(i,t,e[t]);return i};class va extends RS{constructor(e,t,s,o=qi,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=UI,this.cached=[],this.initialized=!1,this.storagePrefix=qi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!hr(l)?this.map.set(this.getKey(l),l):P3(l)?this.map.set(l.id,l):C3(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(g=>B2(f[g],l[g]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const g=Cd(Cd({},this.getData(l)),f);this.map.set(l,g),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class px{constructor(e,t){this.core=e,this.logger=t,this.name=FI,this.version=zI,this.events=new Ku,this.initialized=!1,this.storagePrefix=qi,this.ignoredPayloadTypes=[ln],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Du(),o=await this.core.crypto.setSymKey(s),c=Pr(ve.FIVE_MINUTES),l={protocol:ng},f={topic:o,expiry:c,relay:l,active:!1},g=m3({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l,expiryTimestamp:f}=Ff(s.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const p=f||Pr(ve.FIVE_MINUTES),v={topic:o,relay:l,expiry:p,active:!1};return await this.pairings.set(o,v),this.core.expirer.set(o,p),s.activatePairing&&await this.activate({topic:o}),this.events.emit(bs.create,v),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l})),v},this.activate=async({topic:s})=>{this.isInitialized();const o=Pr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:g}=jn();this.events.once(Ut("pairing_ping",c),({error:p})=>{p?g(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",wt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=Fn(o,c),f=await this.core.crypto.encode(s,l),g=vs[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,g),l.id},this.sendResult=async(s,o,c)=>{const l=da(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=vs[g.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=pa(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=vs[g.request.method]?vs[g.request.method].res:vs.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,wt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Mi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(bs.ping,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Si(o)?this.events.emit(Ut("pairing_ping",c),{}):Yr(o)&&this.events.emit(Ut("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(bs.delete,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=wt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(wt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!wr(s)){const{message:l}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!O3(s.uri)){const{message:l}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}const c=Ff(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:l}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:l}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(l)}},this.isValidPing=async s=>{if(!wr(s)){const{message:c}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!wr(s)){const{message:c}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Mi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new va(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{oh(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ga(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async e=>{const{topic:t}=Sp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(bs.expire,{topic:t}))})}}class gx extends PS{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new zr.EventEmitter,this.name=BI,this.version=HI,this.cached=[],this.initialized=!1,this.storagePrefix=qi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Pr(ve.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ni.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Yr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ni.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ni.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Fn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ni.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ni.created,e=>{const t=ni.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ni.updated,e=>{const t=ni.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ni.deleted,e=>{const t=ni.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yx extends $S{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new zr.EventEmitter,this.name=KI,this.version=kI,this.cached=[],this.initialized=!1,this.storagePrefix=qi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Fr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return n3(e);if(typeof e=="number")return s3(e);const{message:t}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Fr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,e=>{const t=Fr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.expired,e=>{const t=Fr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.deleted,e=>{const t=Fr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class vx extends US{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=iu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Kn()||!kn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=ju;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),c=await this.fetchAttestation(s.attestationId,ju)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),l=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(iu))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=iu,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Mn;return VI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Mn}`),o=Mn),o},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=Mn,this.abortController=new AbortController,this.isDevEnv=eh()&&G2.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class _x extends LS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=GI,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:l,enableEncrypted:f=!1}=s,g=`${WI}/${this.projectId}/clients`;await V2(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(t,this.context)}}var mx=Object.defineProperty,Ad=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,Td=(i,e,t)=>e in i?mx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Rd=(i,e)=>{for(var t in e||(e={}))wx.call(e,t)&&Td(i,t,e[t]);if(Ad)for(var t of Ad(e))bx.call(e,t)&&Td(i,t,e[t]);return i};class ch extends OS{constructor(e){super(e),this.protocol=ig,this.version=_I,this.name=ah,this.events=new zr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||sg,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||mI.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new Gn.HeartBeat,this.crypto=new JI(this,this.logger,e==null?void 0:e.keychain),this.history=new gx(this,this.logger),this.expirer=new yx(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new TD(Rd(Rd({},wI),e==null?void 0:e.storageOptions)),this.relayer=new hx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new px(this,this.logger),this.verify=new vx(this.projectId||"",this.logger),this.echoClient=new _x(this.projectId||"",this.logger)}static async init(e){const t=new ch(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(LI,s),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Ex=ch,og="wc",ag=2,cg="client",uh=`${og}@${ag}:${cg}:`,su={name:cg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Nd="WALLETCONNECT_DEEPLINK_CHOICE",Dx="proposal",ug="Proposal expired",Sx="session",Vo=ve.SEVEN_DAYS,Ix="engine",Ei={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},ou={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},Di={idle:"IDLE",active:"ACTIVE"},xx="request",Ox=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Px=Object.defineProperty,Cx=Object.defineProperties,Ax=Object.getOwnPropertyDescriptors,$d=Object.getOwnPropertySymbols,Tx=Object.prototype.hasOwnProperty,Rx=Object.prototype.propertyIsEnumerable,Ud=(i,e,t)=>e in i?Px(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ur=(i,e)=>{for(var t in e||(e={}))Tx.call(e,t)&&Ud(i,t,e[t]);if($d)for(var t of $d(e))Rx.call(e,t)&&Ud(i,t,e[t]);return i},Ln=(i,e)=>Cx(i,Ax(e));class Nx extends MS{constructor(e){super(e),this.name=Ix,this.events=new Ku,this.initialized=!1,this.ignoredPayloadTypes=[ln],this.requestQueue={state:Di.idle,queue:[]},this.sessionRequestQueue={state:Di.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Ei)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=Ln(ur({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:g}=s;let p=o,v,D=!1;if(p&&(D=this.client.core.pairing.pairings.get(p).active),!p||!D){const{topic:C,uri:T}=await this.client.core.pairing.create();p=C,v=T}const S=await this.client.core.crypto.generateKeyPair(),x=Ei.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,O=Pr(x),F=ur({requiredNamespaces:c,optionalNamespaces:l,relays:g??[{protocol:ng}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:O},f&&{sessionProperties:f}),{reject:H,resolve:ie,done:$}=jn(x,ug);if(this.events.once(Ut("session_connect"),async({error:C,session:T})=>{if(C)H(C);else if(T){T.self.publicKey=S;const E=Ln(ur({},T),{requiredNamespaces:F.requiredNamespaces,optionalNamespaces:F.optionalNamespaces});await this.client.session.set(T.topic,E),await this.setExpiry(T.topic,T.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:T.peer.metadata}),ie(E)}}),!p){const{message:C}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(C)}const M=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:F,throwOnFailedPublish:!0});return await this.setProposal(M,ur({id:M},F)),{uri:v,approval:$}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:p,requiredNamespaces:v,optionalNamespaces:D}=f;g=g||"";const S=await this.client.core.crypto.generateKeyPair(),x=p.publicKey,O=await this.client.core.crypto.generateSharedKey(S,x);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.sendResult({id:s,topic:g,result:{relay:{protocol:o??"irn"},responderPublicKey:S}}),await this.client.proposal.delete(s,wt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const F=ur({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:g,controller:{publicKey:S,metadata:this.client.metadata},expiry:Pr(Vo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(O);const H=Ln(ur({},F),{topic:O,requiredNamespaces:v,optionalNamespaces:D,pairingTopic:g,acknowledged:!1,self:F.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:S});await this.client.session.set(O,H);try{await this.sendRequest({topic:O,method:"wc_sessionSettle",params:F,throwOnFailedPublish:!0})}catch(ie){throw this.client.logger.error(ie),this.client.session.delete(O,wt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),ie}return await this.setExpiry(O,Pr(Vo)),{topic:O,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(O)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,wt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:g}=jn();return this.events.once(Ut("session_update",c),({error:p})=>{p?g(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=jn();return this.events.once(Ut("session_extend",o),({error:g})=>{g?f(g):l()}),await this.setExpiry(s,Pr(Vo)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l=Ei.wc_sessionRequest.req.ttl}=t,f=sh(),{done:g,resolve:p,reject:v}=jn(l,"Request expired. Please try again.");return this.events.once(Ut("session_request",f),({error:D,result:S})=>{D?v(D):p(S)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:Ln(ur({},o),{expiryTimestamp:Pr(l)}),chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(S=>v(S)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),D()}),new Promise(async D=>{const S=await a3(this.client.core.storage,Nd);o3({id:f,topic:c,wcDeepLink:S}),D()}),g()]).then(D=>D[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Si(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Yr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=jn();this.events.once(Ut("session_ping",o),({error:g})=>{g?f(g):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:wt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>I3(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:l=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,wt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Nd).catch(g=>this.client.logger.warn(g)),this.getPendingSessionRequests().forEach(g=>{g.topic===s&&this.deletePendingSessionRequest(g.id,wt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:l,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,wt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=Di.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Pr(Ei.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:l}=t,f=c.request.expiryTimestamp||Pr(Ei.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:l}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:p}=t,v=Fn(o,c,g);if(kn()&&Ox.includes(o)){const x=qn(JSON.stringify(v));this.client.core.verify.register({attestationId:x})}const D=await this.client.core.crypto.encode(s,v),S=Ei[o].req;return l&&(S.ttl=l),f&&(S.id=f),this.client.core.history.set(s,v),p?(S.internal=Ln(ur({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,D,S)):this.client.core.relayer.publish(s,D,S).catch(x=>this.client.logger.error(x)),v.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=da(s,c),g=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),v=Ei[p.request.method].res;l?(v.internal=Ln(ur({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,g,v)):this.client.core.relayer.publish(o,g,v).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=pa(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),g=Ei[f.request.method].res;this.client.core.relayer.publish(s,l,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Mi(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Mi(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Di.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Di.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(ur({},s.params));const l=o.expiryTimestamp||Pr(Ei.wc_sessionPropose.req.ttl),f=ur({id:c,pairingTopic:t,expiryTimestamp:l},o);await this.setProposal(c,f);const g=qn(JSON.stringify(s)),p=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Si(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const p=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const v=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:t})}else Yr(s)&&(await this.client.proposal.delete(o,wt("USER_DISCONNECTED")),this.events.emit(Ut("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:g,namespaces:p,sessionProperties:v,pairingTopic:D}=s.params,S=ur({topic:t,relay:l,expiry:g,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},v&&{sessionProperties:v});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(Ut("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Si(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ut("session_approve",o),{})):Yr(s)&&(await this.client.session.delete(t,wt("USER_DISCONNECTED")),this.events.emit(Ut("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=Ho.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ur({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Ho.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Si(s)?this.events.emit(Ut("session_update",o),{}):Yr(s)&&this.events.emit(Ut("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Pr(Vo)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Si(s)?this.events.emit(Ut("session_extend",o),{}):Yr(s)&&this.events.emit(Ut("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Si(s)?this.events.emit(Ut("session_ping",o),{}):Yr(s)&&this.events.emit(Ut("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(tr.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:wt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(ur({topic:t},c));const l=qn(JSON.stringify(Fn("wc_sessionRequest",c,o))),f=this.client.session.get(t),g=await this.getVerifyContext(l,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:g};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Si(s)?this.events.emit(Ut("session_request",o),{result:s.result}):Yr(s)&&this.events.emit(Ut("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=Ho.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ur({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Ho.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Di.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Ut("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Di.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Di.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,Fn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!wr(t)){const{message:g}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(hr(s)||await this.isValidPairingTopic(s),!j3(f,!0)){const{message:g}=ce("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!hr(o)&&Os(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!hr(c)&&Os(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),hr(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=L3(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!wr(t))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=Wc(o,"approve()");if(g)throw new Error(g.message);const p=Hf(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Wt(c,!0)){const{message:v}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}hr(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!wr(t)){const{message:c}=ce("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!q3(o)){const{message:c}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!wr(t)){const{message:p}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!xp(s)){const{message:p}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=A3(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=Wc(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Mi(l)){const{message:p}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!wr(t)){const{message:g}=ce("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Wc(o,"update()");if(l)throw new Error(l.message);const f=Hf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!wr(t)){const{message:o}=ce("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!wr(t)){const{message:g}=ce("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Bf(f,c)){const{message:g}=ce("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!F3(o)){const{message:g}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!H3(f,c,o.method)){const{message:g}=ce("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(l&&!G3(l,ou)){const{message:g}=ce("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${ou.min} and ${ou.max}`);throw new Error(g)}},this.isValidRespond=async t=>{var s;if(!wr(t)){const{message:l}=ce("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(l)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(l){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),l}if(!z3(c)){const{message:l}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async t=>{if(!wr(t)){const{message:o}=ce("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!wr(t)){const{message:f}=ce("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Bf(l,c)){const{message:f}=ce("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!B3(o)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!K3(l,c,o.name)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!wr(t)){const{message:o}=ce("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Mn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{oh(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ga(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async e=>{const{topic:t,id:s}=Sp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(bs.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ce("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:t}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!M3(e)){const{message:t}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Mi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class $x extends va{constructor(e,t){super(e,t,Dx,uh),this.core=e,this.logger=t}}let Ux=class extends va{constructor(e,t){super(e,t,Sx,uh),this.core=e,this.logger=t}};class Lx extends va{constructor(e,t){super(e,t,xx,uh,s=>s.id),this.core=e,this.logger=t}}let jx=class hg extends jS{constructor(e){super(e),this.protocol=og,this.version=ag,this.name=su.name,this.events=new zr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||su.name,this.metadata=(e==null?void 0:e.metadata)||ZE();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||su.logger}));this.core=(e==null?void 0:e.core)||new Ex(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new Ux(this.core,this.logger),this.proposal=new $x(this.core,this.logger),this.pendingRequest=new Lx(this.core,this.logger),this.engine=new Nx(this)}static async init(e){const t=new hg(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Mu={exports:{}};(function(i,e){var t=typeof self<"u"?self:Jr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(b){return b&&DataView.prototype.isPrototypeOf(b)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(b){return b&&p.indexOf(Object.prototype.toString.call(b))>-1};function D(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function S(b){return typeof b!="string"&&(b=String(b)),b}function x(b){var A={next:function(){var ee=b.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(A[Symbol.iterator]=function(){return A}),A}function O(b){this.map={},b instanceof O?b.forEach(function(A,ee){this.append(ee,A)},this):Array.isArray(b)?b.forEach(function(A){this.append(A[0],A[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(A){this.append(A,b[A])},this)}O.prototype.append=function(b,A){b=D(b),A=S(A);var ee=this.map[b];this.map[b]=ee?ee+", "+A:A},O.prototype.delete=function(b){delete this.map[D(b)]},O.prototype.get=function(b){return b=D(b),this.has(b)?this.map[b]:null},O.prototype.has=function(b){return this.map.hasOwnProperty(D(b))},O.prototype.set=function(b,A){this.map[D(b)]=S(A)},O.prototype.forEach=function(b,A){for(var ee in this.map)this.map.hasOwnProperty(ee)&&b.call(A,this.map[ee],ee,this)},O.prototype.keys=function(){var b=[];return this.forEach(function(A,ee){b.push(ee)}),x(b)},O.prototype.values=function(){var b=[];return this.forEach(function(A){b.push(A)}),x(b)},O.prototype.entries=function(){var b=[];return this.forEach(function(A,ee){b.push([ee,A])}),x(b)},f.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function F(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function H(b){return new Promise(function(A,ee){b.onload=function(){A(b.result)},b.onerror=function(){ee(b.error)}})}function ie(b){var A=new FileReader,ee=H(A);return A.readAsArrayBuffer(b),ee}function $(b){var A=new FileReader,ee=H(A);return A.readAsText(b),ee}function M(b){for(var A=new Uint8Array(b),ee=new Array(A.length),Q=0;Q<A.length;Q++)ee[Q]=String.fromCharCode(A[Q]);return ee.join("")}function C(b){if(b.slice)return b.slice(0);var A=new Uint8Array(b.byteLength);return A.set(new Uint8Array(b)),A.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:f.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:f.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():f.arrayBuffer&&f.blob&&g(b)?(this._bodyArrayBuffer=C(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||v(b))?this._bodyArrayBuffer=C(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var b=F(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?F(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var b=F(this);if(b)return b;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(b){var A=b.toUpperCase();return E.indexOf(A)>-1?A:b}function w(b,A){A=A||{};var ee=A.body;if(b instanceof w){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,A.headers||(this.headers=new O(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ee&&b._bodyInit!=null&&(ee=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new O(A.headers)),this.method=u(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function G(b){var A=new FormData;return b.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),k=Q.shift().replace(/\+/g," "),V=Q.join("=").replace(/\+/g," ");A.append(decodeURIComponent(k),decodeURIComponent(V))}}),A}function W(b){var A=new O,ee=b.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var k=Q.split(":"),V=k.shift().trim();if(V){var J=k.join(":").trim();A.append(V,J)}}),A}T.call(w.prototype);function se(b,A){A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in A?A.statusText:"OK",this.headers=new O(A.headers),this.url=A.url||"",this._initBody(b)}T.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},se.error=function(){var b=new se(null,{status:0,statusText:""});return b.type="error",b};var ue=[301,302,303,307,308];se.redirect=function(b,A){if(ue.indexOf(A)===-1)throw new RangeError("Invalid status code");return new se(null,{status:A,headers:{location:b}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(A,ee){this.message=A,this.name=ee;var Q=Error(A);this.stack=Q.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function de(b,A){return new Promise(function(ee,Q){var k=new w(b,A);if(k.signal&&k.signal.aborted)return Q(new l.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:W(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var we="response"in V?V.response:V.responseText;ee(new se(we,re))},V.onerror=function(){Q(new TypeError("Network request failed"))},V.ontimeout=function(){Q(new TypeError("Network request failed"))},V.onabort=function(){Q(new l.DOMException("Aborted","AbortError"))},V.open(k.method,k.url,!0),k.credentials==="include"?V.withCredentials=!0:k.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),k.headers.forEach(function(re,we){V.setRequestHeader(we,re)}),k.signal&&(k.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&k.signal.removeEventListener("abort",J)}),V.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=O,c.Request=w,c.Response=se),l.Headers=O,l.Request=w,l.Response=se,l.fetch=de,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Mu,Mu.exports);var Mx=Mu.exports;const Ld=Hu(Mx),qx={Accept:"application/json","Content-Type":"application/json"},Fx="POST",jd={headers:qx,method:Fx},Md=10;class Bi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new zr.EventEmitter,this.isAvailable=!1,this.registering=!1,!hd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=un(e),c=await(await Ld(this.url,Object.assign(Object.assign({},jd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!hd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=un({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ld(e,Object.assign(Object.assign({},jd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ls(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=pa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Fp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Md&&this.events.setMaxListeners(Md)}}const qd="error",zx="wss://relay.walletconnect.com",Bx="wc",Hx="universal_provider",Fd=`${Bx}@2:${Hx}:`,Kx="https://rpc.walletconnect.com/v1/",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},qu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",D=1,S=2,x=4,O=1,F=2,H=1,ie=2,$=4,M=8,C=16,T=32,E=64,u=128,w=256,G=512,W=30,se="...",ue=800,de=16,b=1,A=2,ee=3,Q=1/0,k=9007199254740991,V=17976931348623157e292,J=NaN,re=4294967295,we=re-1,oe=re>>>1,be=[["ary",u],["bind",H],["bindKey",ie],["curry",M],["curryRight",C],["flip",G],["partial",T],["partialRight",E],["rearg",w]],le="[object Arguments]",_e="[object Array]",B="[object AsyncFunction]",z="[object Boolean]",U="[object Date]",d="[object DOMException]",R="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",Be="[object Number]",ke="[object Null]",je="[object Object]",gt="[object Promise]",yt="[object Proxy]",qe="[object RegExp]",xe="[object Set]",Ne="[object String]",$e="[object Symbol]",Fe="[object Undefined]",Pe="[object WeakMap]",Ue="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",rr="[object Uint16Array]",dr="[object Uint32Array]",Qr=/\b__p \+= '';/g,ir=/\b(__p \+=) '' \+/g,ai=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oi=/&(?:amp|lt|gt|quot|#39);/g,Hi=/[&<>"']/g,St=RegExp(Oi.source),vt=RegExp(Hi.source),It=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,Et=/<%=([\s\S]+?)%>/g,_t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lt=/^\w*$/,jt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(Ot.source),Pt=/^\s+/,Tt=/\s/,Ct=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,qt=/,? & /,Ft=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_a=/[()=,{}\[\]\/\s]/,ma=/\\(\\)?/g,wa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tr=/\w*$/,ba=/^[-+]0x[0-9a-f]+$/i,Ea=/^0b[01]+$/i,Da=/^\[object .+?Constructor\]$/,Sa=/^0o[0-7]+$/i,Ia=/^(?:0|[1-9]\d*)$/,ci=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gn=/($^)/,xa=/['\n\r\u2028\u2029\\]/g,yn="\\ud800-\\udfff",Oa="\\u0300-\\u036f",Pa="\\ufe20-\\ufe2f",vn="\\u20d0-\\u20ff",Ms=Oa+Pa+vn,qs="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",Ca="\\xac\\xb1\\xd7\\xf7",Aa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ta="\\u2000-\\u206f",Ra=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fs="A-Z\\xc0-\\xd6\\xd8-\\xde",zs="\\ufe0e\\ufe0f",Ki=Ca+Aa+Ta+Ra,Wn="['’]",ki="["+yn+"]",Yn="["+Ki+"]",Vi="["+Ms+"]",Bs="\\d+",Na="["+qs+"]",Hs="["+Br+"]",Ks="[^"+yn+Ki+Bs+qs+Br+Fs+"]",_n="\\ud83c[\\udffb-\\udfff]",$a="(?:"+Vi+"|"+_n+")",ks="[^"+yn+"]",mn="(?:\\ud83c[\\udde6-\\uddff]){2}",Pi="[\\ud800-\\udbff][\\udc00-\\udfff]",Er="["+Fs+"]",Vs="\\u200d",Gs="(?:"+Hs+"|"+Ks+")",Xr="(?:"+Er+"|"+Ks+")",Ws="(?:"+Wn+"(?:d|ll|m|re|s|t|ve))?",Ys="(?:"+Wn+"(?:D|LL|M|RE|S|T|VE))?",Js=$a+"?",Qs="["+zs+"]?",Ua="(?:"+Vs+"(?:"+[ks,mn,Pi].join("|")+")"+Qs+Js+")*",ui="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zs=Qs+Js+Ua,wn="(?:"+[Na,mn,Pi].join("|")+")"+Zs,La="(?:"+[ks+Vi+"?",Vi,mn,Pi,ki].join("|")+")",Jn=RegExp(Wn,"g"),ja=RegExp(Vi,"g"),bn=RegExp(_n+"(?="+_n+")|"+La+Zs,"g"),eo=RegExp([Er+"?"+Hs+"+"+Ws+"(?="+[Yn,Er,"$"].join("|")+")",Xr+"+"+Ys+"(?="+[Yn,Er+Gs,"$"].join("|")+")",Er+"?"+Gs+"+"+Ws,Er+"+"+Ys,Xs,ui,Bs,wn].join("|"),"g"),to=RegExp("["+Vs+yn+Ms+zs+"]"),Gi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ro=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ma=-1,at={};at[He]=at[Oe]=at[Ve]=at[We]=at[et]=at[tt]=at[Qe]=at[rr]=at[dr]=!0,at[le]=at[_e]=at[Se]=at[z]=at[Ce]=at[U]=at[R]=at[ae]=at[Ie]=at[Be]=at[je]=at[qe]=at[xe]=at[Ne]=at[Pe]=!1;var ot={};ot[le]=ot[_e]=ot[Se]=ot[Ce]=ot[z]=ot[U]=ot[He]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[Ie]=ot[Be]=ot[je]=ot[qe]=ot[xe]=ot[Ne]=ot[$e]=ot[tt]=ot[Qe]=ot[rr]=ot[dr]=!0,ot[R]=ot[ae]=ot[Pe]=!1;var I={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,Te=parseInt,dt=typeof ms=="object"&&ms&&ms.Object===Object&&ms,zt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=dt||zt||Function("return this")(),ut=e&&!e.nodeType&&e,Rt=ut&&!0&&i&&!i.nodeType&&i,pr=Rt&&Rt.exports===ut,Bt=pr&&dt.process,pt=function(){try{var j=Rt&&Rt.require&&Rt.require("util").types;return j||Bt&&Bt.binding&&Bt.binding("util")}catch{}}(),nr=pt&&pt.isArrayBuffer,Hr=pt&&pt.isDate,Rr=pt&&pt.isMap,Zr=pt&&pt.isRegExp,Qn=pt&&pt.isSet,Wi=pt&&pt.isTypedArray;function kt(j,Y,K){switch(K.length){case 0:return j.call(Y);case 1:return j.call(Y,K[0]);case 2:return j.call(Y,K[0],K[1]);case 3:return j.call(Y,K[0],K[1],K[2])}return j.apply(Y,K)}function dg(j,Y,K,ge){for(var Ae=-1,rt=j==null?0:j.length;++Ae<rt;){var Ht=j[Ae];Y(ge,Ht,K(Ht),j)}return ge}function Nr(j,Y){for(var K=-1,ge=j==null?0:j.length;++K<ge&&Y(j[K],K,j)!==!1;);return j}function pg(j,Y){for(var K=j==null?0:j.length;K--&&Y(j[K],K,j)!==!1;);return j}function fh(j,Y){for(var K=-1,ge=j==null?0:j.length;++K<ge;)if(!Y(j[K],K,j))return!1;return!0}function Ci(j,Y){for(var K=-1,ge=j==null?0:j.length,Ae=0,rt=[];++K<ge;){var Ht=j[K];Y(Ht,K,j)&&(rt[Ae++]=Ht)}return rt}function io(j,Y){var K=j==null?0:j.length;return!!K&&En(j,Y,0)>-1}function qa(j,Y,K){for(var ge=-1,Ae=j==null?0:j.length;++ge<Ae;)if(K(Y,j[ge]))return!0;return!1}function mt(j,Y){for(var K=-1,ge=j==null?0:j.length,Ae=Array(ge);++K<ge;)Ae[K]=Y(j[K],K,j);return Ae}function Ai(j,Y){for(var K=-1,ge=Y.length,Ae=j.length;++K<ge;)j[Ae+K]=Y[K];return j}function Fa(j,Y,K,ge){var Ae=-1,rt=j==null?0:j.length;for(ge&&rt&&(K=j[++Ae]);++Ae<rt;)K=Y(K,j[Ae],Ae,j);return K}function gg(j,Y,K,ge){var Ae=j==null?0:j.length;for(ge&&Ae&&(K=j[--Ae]);Ae--;)K=Y(K,j[Ae],Ae,j);return K}function za(j,Y){for(var K=-1,ge=j==null?0:j.length;++K<ge;)if(Y(j[K],K,j))return!0;return!1}var yg=Ba("length");function vg(j){return j.split("")}function _g(j){return j.match(Ft)||[]}function dh(j,Y,K){var ge;return K(j,function(Ae,rt,Ht){if(Y(Ae,rt,Ht))return ge=rt,!1}),ge}function no(j,Y,K,ge){for(var Ae=j.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ae;)if(Y(j[rt],rt,j))return rt;return-1}function En(j,Y,K){return Y===Y?Ag(j,Y,K):no(j,ph,K)}function mg(j,Y,K,ge){for(var Ae=K-1,rt=j.length;++Ae<rt;)if(ge(j[Ae],Y))return Ae;return-1}function ph(j){return j!==j}function gh(j,Y){var K=j==null?0:j.length;return K?Ka(j,Y)/K:J}function Ba(j){return function(Y){return Y==null?t:Y[j]}}function Ha(j){return function(Y){return j==null?t:j[Y]}}function yh(j,Y,K,ge,Ae){return Ae(j,function(rt,Ht,ht){K=ge?(ge=!1,rt):Y(K,rt,Ht,ht)}),K}function wg(j,Y){var K=j.length;for(j.sort(Y);K--;)j[K]=j[K].value;return j}function Ka(j,Y){for(var K,ge=-1,Ae=j.length;++ge<Ae;){var rt=Y(j[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function ka(j,Y){for(var K=-1,ge=Array(j);++K<j;)ge[K]=Y(K);return ge}function bg(j,Y){return mt(Y,function(K){return[K,j[K]]})}function vh(j){return j&&j.slice(0,bh(j)+1).replace(Pt,"")}function Dr(j){return function(Y){return j(Y)}}function Va(j,Y){return mt(Y,function(K){return j[K]})}function Xn(j,Y){return j.has(Y)}function _h(j,Y){for(var K=-1,ge=j.length;++K<ge&&En(Y,j[K],0)>-1;);return K}function mh(j,Y){for(var K=j.length;K--&&En(Y,j[K],0)>-1;);return K}function Eg(j,Y){for(var K=j.length,ge=0;K--;)j[K]===Y&&++ge;return ge}var Dg=Ha(I),Sg=Ha(L);function Ig(j){return"\\"+pe[j]}function xg(j,Y){return j==null?t:j[Y]}function Dn(j){return to.test(j)}function Og(j){return Gi.test(j)}function Pg(j){for(var Y,K=[];!(Y=j.next()).done;)K.push(Y.value);return K}function Ga(j){var Y=-1,K=Array(j.size);return j.forEach(function(ge,Ae){K[++Y]=[Ae,ge]}),K}function wh(j,Y){return function(K){return j(Y(K))}}function Ti(j,Y){for(var K=-1,ge=j.length,Ae=0,rt=[];++K<ge;){var Ht=j[K];(Ht===Y||Ht===v)&&(j[K]=v,rt[Ae++]=K)}return rt}function so(j){var Y=-1,K=Array(j.size);return j.forEach(function(ge){K[++Y]=ge}),K}function Cg(j){var Y=-1,K=Array(j.size);return j.forEach(function(ge){K[++Y]=[ge,ge]}),K}function Ag(j,Y,K){for(var ge=K-1,Ae=j.length;++ge<Ae;)if(j[ge]===Y)return ge;return-1}function Tg(j,Y,K){for(var ge=K+1;ge--;)if(j[ge]===Y)return ge;return ge}function Sn(j){return Dn(j)?Ng(j):yg(j)}function Kr(j){return Dn(j)?$g(j):vg(j)}function bh(j){for(var Y=j.length;Y--&&Tt.test(j.charAt(Y)););return Y}var Rg=Ha(te);function Ng(j){for(var Y=bn.lastIndex=0;bn.test(j);)++Y;return Y}function $g(j){return j.match(bn)||[]}function Ug(j){return j.match(eo)||[]}var Lg=function j(Y){Y=Y==null?Xe:In.defaults(Xe.Object(),Y,In.pick(Xe,ro));var K=Y.Array,ge=Y.Date,Ae=Y.Error,rt=Y.Function,Ht=Y.Math,ht=Y.Object,Wa=Y.RegExp,jg=Y.String,$r=Y.TypeError,oo=K.prototype,Mg=rt.prototype,xn=ht.prototype,ao=Y["__core-js_shared__"],co=Mg.toString,nt=xn.hasOwnProperty,qg=0,Eh=function(){var r=/[^.]+$/.exec(ao&&ao.keys&&ao.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),uo=xn.toString,Fg=co.call(ht),zg=Xe._,Bg=Wa("^"+co.call(nt).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ho=pr?Y.Buffer:t,Ri=Y.Symbol,lo=Y.Uint8Array,Dh=ho?ho.allocUnsafe:t,fo=wh(ht.getPrototypeOf,ht),Sh=ht.create,Ih=xn.propertyIsEnumerable,po=oo.splice,xh=Ri?Ri.isConcatSpreadable:t,Zn=Ri?Ri.iterator:t,Yi=Ri?Ri.toStringTag:t,go=function(){try{var r=en(ht,"defineProperty");return r({},"",{}),r}catch{}}(),Hg=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,Kg=ge&&ge.now!==Xe.Date.now&&ge.now,kg=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,yo=Ht.ceil,vo=Ht.floor,Ya=ht.getOwnPropertySymbols,Vg=ho?ho.isBuffer:t,Oh=Y.isFinite,Gg=oo.join,Wg=wh(ht.keys,ht),Kt=Ht.max,Xt=Ht.min,Yg=ge.now,Jg=Y.parseInt,Ph=Ht.random,Qg=oo.reverse,Ja=en(Y,"DataView"),es=en(Y,"Map"),Qa=en(Y,"Promise"),On=en(Y,"Set"),ts=en(Y,"WeakMap"),rs=en(ht,"create"),_o=ts&&new ts,Pn={},Xg=tn(Ja),Zg=tn(es),e0=tn(Qa),t0=tn(On),r0=tn(ts),mo=Ri?Ri.prototype:t,is=mo?mo.valueOf:t,Ch=mo?mo.toString:t;function _(r){if(At(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof Ur)return r;if(nt.call(r,"__wrapped__"))return Al(r)}return new Ur(r)}var Cn=function(){function r(){}return function(n){if(!Dt(n))return{};if(Sh)return Sh(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function wo(){}function Ur(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}_.templateSettings={escape:It,evaluate:xt,interpolate:Et,variable:"",imports:{_}},_.prototype=wo.prototype,_.prototype.constructor=_,Ur.prototype=Cn(wo.prototype),Ur.prototype.constructor=Ur;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function i0(){var r=new Ye(this.__wrapped__);return r.__actions__=gr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=gr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=gr(this.__views__),r}function n0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function s0(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),h=n<0,y=a?r.length:0,m=vy(0,y,this.__views__),P=m.start,N=m.end,q=N-P,X=h?N:P-1,Z=this.__iteratees__,ne=Z.length,he=0,ye=Xt(q,this.__takeCount__);if(!a||!h&&y==q&&ye==q)return Zh(r,this.__actions__);var Ee=[];e:for(;q--&&he<ye;){X+=n;for(var ze=-1,De=r[X];++ze<ne;){var Ge=Z[ze],Ze=Ge.iteratee,xr=Ge.type,ar=Ze(De);if(xr==A)De=ar;else if(!ar){if(xr==b)continue e;break e}}Ee[he++]=De}return Ee}Ye.prototype=Cn(wo.prototype),Ye.prototype.constructor=Ye;function Ji(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function o0(){this.__data__=rs?rs(null):{},this.size=0}function a0(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function c0(r){var n=this.__data__;if(rs){var a=n[r];return a===g?t:a}return nt.call(n,r)?n[r]:t}function u0(r){var n=this.__data__;return rs?n[r]!==t:nt.call(n,r)}function h0(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=rs&&n===t?g:n,this}Ji.prototype.clear=o0,Ji.prototype.delete=a0,Ji.prototype.get=c0,Ji.prototype.has=u0,Ji.prototype.set=h0;function hi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function l0(){this.__data__=[],this.size=0}function f0(r){var n=this.__data__,a=bo(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():po.call(n,a,1),--this.size,!0}function d0(r){var n=this.__data__,a=bo(n,r);return a<0?t:n[a][1]}function p0(r){return bo(this.__data__,r)>-1}function g0(r,n){var a=this.__data__,h=bo(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}hi.prototype.clear=l0,hi.prototype.delete=f0,hi.prototype.get=d0,hi.prototype.has=p0,hi.prototype.set=g0;function li(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function y0(){this.size=0,this.__data__={hash:new Ji,map:new(es||hi),string:new Ji}}function v0(r){var n=No(this,r).delete(r);return this.size-=n?1:0,n}function _0(r){return No(this,r).get(r)}function m0(r){return No(this,r).has(r)}function w0(r,n){var a=No(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}li.prototype.clear=y0,li.prototype.delete=v0,li.prototype.get=_0,li.prototype.has=m0,li.prototype.set=w0;function Qi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new li;++n<a;)this.add(r[n])}function b0(r){return this.__data__.set(r,g),this}function E0(r){return this.__data__.has(r)}Qi.prototype.add=Qi.prototype.push=b0,Qi.prototype.has=E0;function kr(r){var n=this.__data__=new hi(r);this.size=n.size}function D0(){this.__data__=new hi,this.size=0}function S0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function I0(r){return this.__data__.get(r)}function x0(r){return this.__data__.has(r)}function O0(r,n){var a=this.__data__;if(a instanceof hi){var h=a.__data__;if(!es||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new li(h)}return a.set(r,n),this.size=a.size,this}kr.prototype.clear=D0,kr.prototype.delete=S0,kr.prototype.get=I0,kr.prototype.has=x0,kr.prototype.set=O0;function Ah(r,n){var a=Re(r),h=!a&&rn(r),y=!a&&!h&&ji(r),m=!a&&!h&&!y&&Nn(r),P=a||h||y||m,N=P?ka(r.length,jg):[],q=N.length;for(var X in r)(n||nt.call(r,X))&&!(P&&(X=="length"||y&&(X=="offset"||X=="parent")||m&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||gi(X,q)))&&N.push(X);return N}function Th(r){var n=r.length;return n?r[cc(0,n-1)]:t}function P0(r,n){return $o(gr(r),Xi(n,0,r.length))}function C0(r){return $o(gr(r))}function Xa(r,n,a){(a!==t&&!Vr(r[n],a)||a===t&&!(n in r))&&fi(r,n,a)}function ns(r,n,a){var h=r[n];(!(nt.call(r,n)&&Vr(h,a))||a===t&&!(n in r))&&fi(r,n,a)}function bo(r,n){for(var a=r.length;a--;)if(Vr(r[a][0],n))return a;return-1}function A0(r,n,a,h){return Ni(r,function(y,m,P){n(h,y,a(y),P)}),h}function Rh(r,n){return r&&ti(n,Vt(n),r)}function T0(r,n){return r&&ti(n,vr(n),r)}function fi(r,n,a){n=="__proto__"&&go?go(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Za(r,n){for(var a=-1,h=n.length,y=K(h),m=r==null;++a<h;)y[a]=m?t:Nc(r,n[a]);return y}function Xi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Lr(r,n,a,h,y,m){var P,N=n&D,q=n&S,X=n&x;if(a&&(P=y?a(r,h,y,m):a(r)),P!==t)return P;if(!Dt(r))return r;var Z=Re(r);if(Z){if(P=my(r),!N)return gr(r,P)}else{var ne=Zt(r),he=ne==ae||ne==fe;if(ji(r))return rl(r,N);if(ne==je||ne==le||he&&!y){if(P=q||he?{}:bl(r),!N)return q?cy(r,T0(P,r)):ay(r,Rh(P,r))}else{if(!ot[ne])return y?r:{};P=wy(r,ne,N)}}m||(m=new kr);var ye=m.get(r);if(ye)return ye;m.set(r,P),Jl(r)?r.forEach(function(De){P.add(Lr(De,n,a,De,r,m))}):Wl(r)&&r.forEach(function(De,Ge){P.set(Ge,Lr(De,n,a,Ge,r,m))});var Ee=X?q?mc:_c:q?vr:Vt,ze=Z?t:Ee(r);return Nr(ze||r,function(De,Ge){ze&&(Ge=De,De=r[Ge]),ns(P,Ge,Lr(De,n,a,Ge,r,m))}),P}function R0(r){var n=Vt(r);return function(a){return Nh(a,r,n)}}function Nh(r,n,a){var h=a.length;if(r==null)return!h;for(r=ht(r);h--;){var y=a[h],m=n[y],P=r[y];if(P===t&&!(y in r)||!m(P))return!1}return!0}function $h(r,n,a){if(typeof r!="function")throw new $r(l);return ls(function(){r.apply(t,a)},n)}function ss(r,n,a,h){var y=-1,m=io,P=!0,N=r.length,q=[],X=n.length;if(!N)return q;a&&(n=mt(n,Dr(a))),h?(m=qa,P=!1):n.length>=o&&(m=Xn,P=!1,n=new Qi(n));e:for(;++y<N;){var Z=r[y],ne=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,P&&ne===ne){for(var he=X;he--;)if(n[he]===ne)continue e;q.push(Z)}else m(n,ne,h)||q.push(Z)}return q}var Ni=al(ei),Uh=al(tc,!0);function N0(r,n){var a=!0;return Ni(r,function(h,y,m){return a=!!n(h,y,m),a}),a}function Eo(r,n,a){for(var h=-1,y=r.length;++h<y;){var m=r[h],P=n(m);if(P!=null&&(N===t?P===P&&!Ir(P):a(P,N)))var N=P,q=m}return q}function $0(r,n,a,h){var y=r.length;for(a=Me(a),a<0&&(a=-a>y?0:y+a),h=h===t||h>y?y:Me(h),h<0&&(h+=y),h=a>h?0:Xl(h);a<h;)r[a++]=n;return r}function Lh(r,n){var a=[];return Ni(r,function(h,y,m){n(h,y,m)&&a.push(h)}),a}function Yt(r,n,a,h,y){var m=-1,P=r.length;for(a||(a=Ey),y||(y=[]);++m<P;){var N=r[m];n>0&&a(N)?n>1?Yt(N,n-1,a,h,y):Ai(y,N):h||(y[y.length]=N)}return y}var ec=cl(),jh=cl(!0);function ei(r,n){return r&&ec(r,n,Vt)}function tc(r,n){return r&&jh(r,n,Vt)}function Do(r,n){return Ci(n,function(a){return yi(r[a])})}function Zi(r,n){n=Ui(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[ri(n[a++])];return a&&a==h?r:t}function Mh(r,n,a){var h=n(r);return Re(r)?h:Ai(h,a(r))}function sr(r){return r==null?r===t?Fe:ke:Yi&&Yi in ht(r)?yy(r):Cy(r)}function rc(r,n){return r>n}function U0(r,n){return r!=null&&nt.call(r,n)}function L0(r,n){return r!=null&&n in ht(r)}function j0(r,n,a){return r>=Xt(n,a)&&r<Kt(n,a)}function ic(r,n,a){for(var h=a?qa:io,y=r[0].length,m=r.length,P=m,N=K(m),q=1/0,X=[];P--;){var Z=r[P];P&&n&&(Z=mt(Z,Dr(n))),q=Xt(Z.length,q),N[P]=!a&&(n||y>=120&&Z.length>=120)?new Qi(P&&Z):t}Z=r[0];var ne=-1,he=N[0];e:for(;++ne<y&&X.length<q;){var ye=Z[ne],Ee=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Xn(he,Ee):h(X,Ee,a))){for(P=m;--P;){var ze=N[P];if(!(ze?Xn(ze,Ee):h(r[P],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function M0(r,n,a,h){return ei(r,function(y,m,P){n(h,a(y),m,P)}),h}function os(r,n,a){n=Ui(n,r),r=Il(r,n);var h=r==null?r:r[ri(Mr(n))];return h==null?t:kt(h,r,a)}function qh(r){return At(r)&&sr(r)==le}function q0(r){return At(r)&&sr(r)==Se}function F0(r){return At(r)&&sr(r)==U}function as(r,n,a,h,y){return r===n?!0:r==null||n==null||!At(r)&&!At(n)?r!==r&&n!==n:z0(r,n,a,h,as,y)}function z0(r,n,a,h,y,m){var P=Re(r),N=Re(n),q=P?_e:Zt(r),X=N?_e:Zt(n);q=q==le?je:q,X=X==le?je:X;var Z=q==je,ne=X==je,he=q==X;if(he&&ji(r)){if(!ji(n))return!1;P=!0,Z=!1}if(he&&!Z)return m||(m=new kr),P||Nn(r)?_l(r,n,a,h,y,m):py(r,n,q,a,h,y,m);if(!(a&O)){var ye=Z&&nt.call(r,"__wrapped__"),Ee=ne&&nt.call(n,"__wrapped__");if(ye||Ee){var ze=ye?r.value():r,De=Ee?n.value():n;return m||(m=new kr),y(ze,De,a,h,m)}}return he?(m||(m=new kr),gy(r,n,a,h,y,m)):!1}function B0(r){return At(r)&&Zt(r)==Ie}function nc(r,n,a,h){var y=a.length,m=y,P=!h;if(r==null)return!m;for(r=ht(r);y--;){var N=a[y];if(P&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++y<m;){N=a[y];var q=N[0],X=r[q],Z=N[1];if(P&&N[2]){if(X===t&&!(q in r))return!1}else{var ne=new kr;if(h)var he=h(X,Z,q,r,n,ne);if(!(he===t?as(Z,X,O|F,h,ne):he))return!1}}return!0}function Fh(r){if(!Dt(r)||Sy(r))return!1;var n=yi(r)?Bg:Da;return n.test(tn(r))}function H0(r){return At(r)&&sr(r)==qe}function K0(r){return At(r)&&Zt(r)==xe}function k0(r){return At(r)&&Fo(r.length)&&!!at[sr(r)]}function zh(r){return typeof r=="function"?r:r==null?_r:typeof r=="object"?Re(r)?Kh(r[0],r[1]):Hh(r):hf(r)}function sc(r){if(!hs(r))return Wg(r);var n=[];for(var a in ht(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function V0(r){if(!Dt(r))return Py(r);var n=hs(r),a=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||a.push(h);return a}function oc(r,n){return r<n}function Bh(r,n){var a=-1,h=yr(r)?K(r.length):[];return Ni(r,function(y,m,P){h[++a]=n(y,m,P)}),h}function Hh(r){var n=bc(r);return n.length==1&&n[0][2]?Dl(n[0][0],n[0][1]):function(a){return a===r||nc(a,r,n)}}function Kh(r,n){return Dc(r)&&El(n)?Dl(ri(r),n):function(a){var h=Nc(a,r);return h===t&&h===n?$c(a,r):as(n,h,O|F)}}function So(r,n,a,h,y){r!==n&&ec(n,function(m,P){if(y||(y=new kr),Dt(m))G0(r,n,P,a,So,h,y);else{var N=h?h(Ic(r,P),m,P+"",r,n,y):t;N===t&&(N=m),Xa(r,P,N)}},vr)}function G0(r,n,a,h,y,m,P){var N=Ic(r,a),q=Ic(n,a),X=P.get(q);if(X){Xa(r,a,X);return}var Z=m?m(N,q,a+"",r,n,P):t,ne=Z===t;if(ne){var he=Re(q),ye=!he&&ji(q),Ee=!he&&!ye&&Nn(q);Z=q,he||ye||Ee?Re(N)?Z=N:Nt(N)?Z=gr(N):ye?(ne=!1,Z=rl(q,!0)):Ee?(ne=!1,Z=il(q,!0)):Z=[]:fs(q)||rn(q)?(Z=N,rn(N)?Z=Zl(N):(!Dt(N)||yi(N))&&(Z=bl(q))):ne=!1}ne&&(P.set(q,Z),y(Z,q,h,m,P),P.delete(q)),Xa(r,a,Z)}function kh(r,n){var a=r.length;if(a)return n+=n<0?a:0,gi(n,a)?r[n]:t}function Vh(r,n,a){n.length?n=mt(n,function(m){return Re(m)?function(P){return Zi(P,m.length===1?m[0]:m)}:m}):n=[_r];var h=-1;n=mt(n,Dr(me()));var y=Bh(r,function(m,P,N){var q=mt(n,function(X){return X(m)});return{criteria:q,index:++h,value:m}});return wg(y,function(m,P){return oy(m,P,a)})}function W0(r,n){return Gh(r,n,function(a,h){return $c(r,h)})}function Gh(r,n,a){for(var h=-1,y=n.length,m={};++h<y;){var P=n[h],N=Zi(r,P);a(N,P)&&cs(m,Ui(P,r),N)}return m}function Y0(r){return function(n){return Zi(n,r)}}function ac(r,n,a,h){var y=h?mg:En,m=-1,P=n.length,N=r;for(r===n&&(n=gr(n)),a&&(N=mt(r,Dr(a)));++m<P;)for(var q=0,X=n[m],Z=a?a(X):X;(q=y(N,Z,q,h))>-1;)N!==r&&po.call(N,q,1),po.call(r,q,1);return r}function Wh(r,n){for(var a=r?n.length:0,h=a-1;a--;){var y=n[a];if(a==h||y!==m){var m=y;gi(y)?po.call(r,y,1):lc(r,y)}}return r}function cc(r,n){return r+vo(Ph()*(n-r+1))}function J0(r,n,a,h){for(var y=-1,m=Kt(yo((n-r)/(a||1)),0),P=K(m);m--;)P[h?m:++y]=r,r+=a;return P}function uc(r,n){var a="";if(!r||n<1||n>k)return a;do n%2&&(a+=r),n=vo(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return xc(Sl(r,n,_r),r+"")}function Q0(r){return Th($n(r))}function X0(r,n){var a=$n(r);return $o(a,Xi(n,0,a.length))}function cs(r,n,a,h){if(!Dt(r))return r;n=Ui(n,r);for(var y=-1,m=n.length,P=m-1,N=r;N!=null&&++y<m;){var q=ri(n[y]),X=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return r;if(y!=P){var Z=N[q];X=h?h(Z,q,N):t,X===t&&(X=Dt(Z)?Z:gi(n[y+1])?[]:{})}ns(N,q,X),N=N[q]}return r}var Yh=_o?function(r,n){return _o.set(r,n),r}:_r,Z0=go?function(r,n){return go(r,"toString",{configurable:!0,enumerable:!1,value:Lc(n),writable:!0})}:_r;function ey(r){return $o($n(r))}function jr(r,n,a){var h=-1,y=r.length;n<0&&(n=-n>y?0:y+n),a=a>y?y:a,a<0&&(a+=y),y=n>a?0:a-n>>>0,n>>>=0;for(var m=K(y);++h<y;)m[h]=r[h+n];return m}function ty(r,n){var a;return Ni(r,function(h,y,m){return a=n(h,y,m),!a}),!!a}function Io(r,n,a){var h=0,y=r==null?h:r.length;if(typeof n=="number"&&n===n&&y<=oe){for(;h<y;){var m=h+y>>>1,P=r[m];P!==null&&!Ir(P)&&(a?P<=n:P<n)?h=m+1:y=m}return y}return hc(r,n,_r,a)}function hc(r,n,a,h){var y=0,m=r==null?0:r.length;if(m===0)return 0;n=a(n);for(var P=n!==n,N=n===null,q=Ir(n),X=n===t;y<m;){var Z=vo((y+m)/2),ne=a(r[Z]),he=ne!==t,ye=ne===null,Ee=ne===ne,ze=Ir(ne);if(P)var De=h||Ee;else X?De=Ee&&(h||he):N?De=Ee&&he&&(h||!ye):q?De=Ee&&he&&!ye&&(h||!ze):ye||ze?De=!1:De=h?ne<=n:ne<n;De?y=Z+1:m=Z}return Xt(m,we)}function Jh(r,n){for(var a=-1,h=r.length,y=0,m=[];++a<h;){var P=r[a],N=n?n(P):P;if(!a||!Vr(N,q)){var q=N;m[y++]=P===0?0:P}}return m}function Qh(r){return typeof r=="number"?r:Ir(r)?J:+r}function Sr(r){if(typeof r=="string")return r;if(Re(r))return mt(r,Sr)+"";if(Ir(r))return Ch?Ch.call(r):"";var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function $i(r,n,a){var h=-1,y=io,m=r.length,P=!0,N=[],q=N;if(a)P=!1,y=qa;else if(m>=o){var X=n?null:fy(r);if(X)return so(X);P=!1,y=Xn,q=new Qi}else q=n?[]:N;e:for(;++h<m;){var Z=r[h],ne=n?n(Z):Z;if(Z=a||Z!==0?Z:0,P&&ne===ne){for(var he=q.length;he--;)if(q[he]===ne)continue e;n&&q.push(ne),N.push(Z)}else y(q,ne,a)||(q!==N&&q.push(ne),N.push(Z))}return N}function lc(r,n){return n=Ui(n,r),r=Il(r,n),r==null||delete r[ri(Mr(n))]}function Xh(r,n,a,h){return cs(r,n,a(Zi(r,n)),h)}function xo(r,n,a,h){for(var y=r.length,m=h?y:-1;(h?m--:++m<y)&&n(r[m],m,r););return a?jr(r,h?0:m,h?m+1:y):jr(r,h?m+1:0,h?y:m)}function Zh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),Fa(n,function(h,y){return y.func.apply(y.thisArg,Ai([h],y.args))},a)}function fc(r,n,a){var h=r.length;if(h<2)return h?$i(r[0]):[];for(var y=-1,m=K(h);++y<h;)for(var P=r[y],N=-1;++N<h;)N!=y&&(m[y]=ss(m[y]||P,r[N],n,a));return $i(Yt(m,1),n,a)}function el(r,n,a){for(var h=-1,y=r.length,m=n.length,P={};++h<y;){var N=h<m?n[h]:t;a(P,r[h],N)}return P}function dc(r){return Nt(r)?r:[]}function pc(r){return typeof r=="function"?r:_r}function Ui(r,n){return Re(r)?r:Dc(r,n)?[r]:Cl(it(r))}var ry=Ke;function Li(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:jr(r,n,a)}var tl=Hg||function(r){return Xe.clearTimeout(r)};function rl(r,n){if(n)return r.slice();var a=r.length,h=Dh?Dh(a):new r.constructor(a);return r.copy(h),h}function gc(r){var n=new r.constructor(r.byteLength);return new lo(n).set(new lo(r)),n}function iy(r,n){var a=n?gc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function ny(r){var n=new r.constructor(r.source,Tr.exec(r));return n.lastIndex=r.lastIndex,n}function sy(r){return is?ht(is.call(r)):{}}function il(r,n){var a=n?gc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function nl(r,n){if(r!==n){var a=r!==t,h=r===null,y=r===r,m=Ir(r),P=n!==t,N=n===null,q=n===n,X=Ir(n);if(!N&&!X&&!m&&r>n||m&&P&&q&&!N&&!X||h&&P&&q||!a&&q||!y)return 1;if(!h&&!m&&!X&&r<n||X&&a&&y&&!h&&!m||N&&a&&y||!P&&y||!q)return-1}return 0}function oy(r,n,a){for(var h=-1,y=r.criteria,m=n.criteria,P=y.length,N=a.length;++h<P;){var q=nl(y[h],m[h]);if(q){if(h>=N)return q;var X=a[h];return q*(X=="desc"?-1:1)}}return r.index-n.index}function sl(r,n,a,h){for(var y=-1,m=r.length,P=a.length,N=-1,q=n.length,X=Kt(m-P,0),Z=K(q+X),ne=!h;++N<q;)Z[N]=n[N];for(;++y<P;)(ne||y<m)&&(Z[a[y]]=r[y]);for(;X--;)Z[N++]=r[y++];return Z}function ol(r,n,a,h){for(var y=-1,m=r.length,P=-1,N=a.length,q=-1,X=n.length,Z=Kt(m-N,0),ne=K(Z+X),he=!h;++y<Z;)ne[y]=r[y];for(var ye=y;++q<X;)ne[ye+q]=n[q];for(;++P<N;)(he||y<m)&&(ne[ye+a[P]]=r[y++]);return ne}function gr(r,n){var a=-1,h=r.length;for(n||(n=K(h));++a<h;)n[a]=r[a];return n}function ti(r,n,a,h){var y=!a;a||(a={});for(var m=-1,P=n.length;++m<P;){var N=n[m],q=h?h(a[N],r[N],N,a,r):t;q===t&&(q=r[N]),y?fi(a,N,q):ns(a,N,q)}return a}function ay(r,n){return ti(r,Ec(r),n)}function cy(r,n){return ti(r,ml(r),n)}function Oo(r,n){return function(a,h){var y=Re(a)?dg:A0,m=n?n():{};return y(a,r,me(h,2),m)}}function An(r){return Ke(function(n,a){var h=-1,y=a.length,m=y>1?a[y-1]:t,P=y>2?a[2]:t;for(m=r.length>3&&typeof m=="function"?(y--,m):t,P&&or(a[0],a[1],P)&&(m=y<3?t:m,y=1),n=ht(n);++h<y;){var N=a[h];N&&r(n,N,h,m)}return n})}function al(r,n){return function(a,h){if(a==null)return a;if(!yr(a))return r(a,h);for(var y=a.length,m=n?y:-1,P=ht(a);(n?m--:++m<y)&&h(P[m],m,P)!==!1;);return a}}function cl(r){return function(n,a,h){for(var y=-1,m=ht(n),P=h(n),N=P.length;N--;){var q=P[r?N:++y];if(a(m[q],q,m)===!1)break}return n}}function uy(r,n,a){var h=n&H,y=us(r);function m(){var P=this&&this!==Xe&&this instanceof m?y:r;return P.apply(h?a:this,arguments)}return m}function ul(r){return function(n){n=it(n);var a=Dn(n)?Kr(n):t,h=a?a[0]:n.charAt(0),y=a?Li(a,1).join(""):n.slice(1);return h[r]()+y}}function Tn(r){return function(n){return Fa(cf(af(n).replace(Jn,"")),r,"")}}function us(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=Cn(r.prototype),h=r.apply(a,n);return Dt(h)?h:a}}function hy(r,n,a){var h=us(r);function y(){for(var m=arguments.length,P=K(m),N=m,q=Rn(y);N--;)P[N]=arguments[N];var X=m<3&&P[0]!==q&&P[m-1]!==q?[]:Ti(P,q);if(m-=X.length,m<a)return pl(r,n,Po,y.placeholder,t,P,X,t,t,a-m);var Z=this&&this!==Xe&&this instanceof y?h:r;return kt(Z,this,P)}return y}function hl(r){return function(n,a,h){var y=ht(n);if(!yr(n)){var m=me(a,3);n=Vt(n),a=function(N){return m(y[N],N,y)}}var P=r(n,a,h);return P>-1?y[m?n[P]:P]:t}}function ll(r){return pi(function(n){var a=n.length,h=a,y=Ur.prototype.thru;for(r&&n.reverse();h--;){var m=n[h];if(typeof m!="function")throw new $r(l);if(y&&!P&&Ro(m)=="wrapper")var P=new Ur([],!0)}for(h=P?h:a;++h<a;){m=n[h];var N=Ro(m),q=N=="wrapper"?wc(m):t;q&&Sc(q[0])&&q[1]==(u|M|T|w)&&!q[4].length&&q[9]==1?P=P[Ro(q[0])].apply(P,q[3]):P=m.length==1&&Sc(m)?P[N]():P.thru(m)}return function(){var X=arguments,Z=X[0];if(P&&X.length==1&&Re(Z))return P.plant(Z).value();for(var ne=0,he=a?n[ne].apply(this,X):Z;++ne<a;)he=n[ne].call(this,he);return he}})}function Po(r,n,a,h,y,m,P,N,q,X){var Z=n&u,ne=n&H,he=n&ie,ye=n&(M|C),Ee=n&G,ze=he?t:us(r);function De(){for(var Ge=arguments.length,Ze=K(Ge),xr=Ge;xr--;)Ze[xr]=arguments[xr];if(ye)var ar=Rn(De),Or=Eg(Ze,ar);if(h&&(Ze=sl(Ze,h,y,ye)),m&&(Ze=ol(Ze,m,P,ye)),Ge-=Or,ye&&Ge<X){var $t=Ti(Ze,ar);return pl(r,n,Po,De.placeholder,a,Ze,$t,N,q,X-Ge)}var Gr=ne?a:this,_i=he?Gr[r]:r;return Ge=Ze.length,N?Ze=Ay(Ze,N):Ee&&Ge>1&&Ze.reverse(),Z&&q<Ge&&(Ze.length=q),this&&this!==Xe&&this instanceof De&&(_i=ze||us(_i)),_i.apply(Gr,Ze)}return De}function fl(r,n){return function(a,h){return M0(a,r,n(h),{})}}function Co(r,n){return function(a,h){var y;if(a===t&&h===t)return n;if(a!==t&&(y=a),h!==t){if(y===t)return h;typeof a=="string"||typeof h=="string"?(a=Sr(a),h=Sr(h)):(a=Qh(a),h=Qh(h)),y=r(a,h)}return y}}function yc(r){return pi(function(n){return n=mt(n,Dr(me())),Ke(function(a){var h=this;return r(n,function(y){return kt(y,h,a)})})})}function Ao(r,n){n=n===t?" ":Sr(n);var a=n.length;if(a<2)return a?uc(n,r):n;var h=uc(n,yo(r/Sn(n)));return Dn(n)?Li(Kr(h),0,r).join(""):h.slice(0,r)}function ly(r,n,a,h){var y=n&H,m=us(r);function P(){for(var N=-1,q=arguments.length,X=-1,Z=h.length,ne=K(Z+q),he=this&&this!==Xe&&this instanceof P?m:r;++X<Z;)ne[X]=h[X];for(;q--;)ne[X++]=arguments[++N];return kt(he,y?a:this,ne)}return P}function dl(r){return function(n,a,h){return h&&typeof h!="number"&&or(n,a,h)&&(a=h=t),n=vi(n),a===t?(a=n,n=0):a=vi(a),h=h===t?n<a?1:-1:vi(h),J0(n,a,h,r)}}function To(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=qr(n),a=qr(a)),r(n,a)}}function pl(r,n,a,h,y,m,P,N,q,X){var Z=n&M,ne=Z?P:t,he=Z?t:P,ye=Z?m:t,Ee=Z?t:m;n|=Z?T:E,n&=~(Z?E:T),n&$||(n&=~(H|ie));var ze=[r,n,y,ye,ne,Ee,he,N,q,X],De=a.apply(t,ze);return Sc(r)&&xl(De,ze),De.placeholder=h,Ol(De,r,n)}function vc(r){var n=Ht[r];return function(a,h){if(a=qr(a),h=h==null?0:Xt(Me(h),292),h&&Oh(a)){var y=(it(a)+"e").split("e"),m=n(y[0]+"e"+(+y[1]+h));return y=(it(m)+"e").split("e"),+(y[0]+"e"+(+y[1]-h))}return n(a)}}var fy=On&&1/so(new On([,-0]))[1]==Q?function(r){return new On(r)}:qc;function gl(r){return function(n){var a=Zt(n);return a==Ie?Ga(n):a==xe?Cg(n):bg(n,r(n))}}function di(r,n,a,h,y,m,P,N){var q=n&ie;if(!q&&typeof r!="function")throw new $r(l);var X=h?h.length:0;if(X||(n&=~(T|E),h=y=t),P=P===t?P:Kt(Me(P),0),N=N===t?N:Me(N),X-=y?y.length:0,n&E){var Z=h,ne=y;h=y=t}var he=q?t:wc(r),ye=[r,n,a,h,y,Z,ne,m,P,N];if(he&&Oy(ye,he),r=ye[0],n=ye[1],a=ye[2],h=ye[3],y=ye[4],N=ye[9]=ye[9]===t?q?0:r.length:Kt(ye[9]-X,0),!N&&n&(M|C)&&(n&=~(M|C)),!n||n==H)var Ee=uy(r,n,a);else n==M||n==C?Ee=hy(r,n,N):(n==T||n==(H|T))&&!y.length?Ee=ly(r,n,a,h):Ee=Po.apply(t,ye);var ze=he?Yh:xl;return Ol(ze(Ee,ye),r,n)}function yl(r,n,a,h){return r===t||Vr(r,xn[a])&&!nt.call(h,a)?n:r}function vl(r,n,a,h,y,m){return Dt(r)&&Dt(n)&&(m.set(n,r),So(r,n,t,vl,m),m.delete(n)),r}function dy(r){return fs(r)?t:r}function _l(r,n,a,h,y,m){var P=a&O,N=r.length,q=n.length;if(N!=q&&!(P&&q>N))return!1;var X=m.get(r),Z=m.get(n);if(X&&Z)return X==n&&Z==r;var ne=-1,he=!0,ye=a&F?new Qi:t;for(m.set(r,n),m.set(n,r);++ne<N;){var Ee=r[ne],ze=n[ne];if(h)var De=P?h(ze,Ee,ne,n,r,m):h(Ee,ze,ne,r,n,m);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!za(n,function(Ge,Ze){if(!Xn(ye,Ze)&&(Ee===Ge||y(Ee,Ge,a,h,m)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===ze||y(Ee,ze,a,h,m))){he=!1;break}}return m.delete(r),m.delete(n),he}function py(r,n,a,h,y,m,P){switch(a){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!m(new lo(r),new lo(n)));case z:case U:case Be:return Vr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case qe:case Ne:return r==n+"";case Ie:var N=Ga;case xe:var q=h&O;if(N||(N=so),r.size!=n.size&&!q)return!1;var X=P.get(r);if(X)return X==n;h|=F,P.set(r,n);var Z=_l(N(r),N(n),h,y,m,P);return P.delete(r),Z;case $e:if(is)return is.call(r)==is.call(n)}return!1}function gy(r,n,a,h,y,m){var P=a&O,N=_c(r),q=N.length,X=_c(n),Z=X.length;if(q!=Z&&!P)return!1;for(var ne=q;ne--;){var he=N[ne];if(!(P?he in n:nt.call(n,he)))return!1}var ye=m.get(r),Ee=m.get(n);if(ye&&Ee)return ye==n&&Ee==r;var ze=!0;m.set(r,n),m.set(n,r);for(var De=P;++ne<q;){he=N[ne];var Ge=r[he],Ze=n[he];if(h)var xr=P?h(Ze,Ge,he,n,r,m):h(Ge,Ze,he,r,n,m);if(!(xr===t?Ge===Ze||y(Ge,Ze,a,h,m):xr)){ze=!1;break}De||(De=he=="constructor")}if(ze&&!De){var ar=r.constructor,Or=n.constructor;ar!=Or&&"constructor"in r&&"constructor"in n&&!(typeof ar=="function"&&ar instanceof ar&&typeof Or=="function"&&Or instanceof Or)&&(ze=!1)}return m.delete(r),m.delete(n),ze}function pi(r){return xc(Sl(r,t,Nl),r+"")}function _c(r){return Mh(r,Vt,Ec)}function mc(r){return Mh(r,vr,ml)}var wc=_o?function(r){return _o.get(r)}:qc;function Ro(r){for(var n=r.name+"",a=Pn[n],h=nt.call(Pn,n)?a.length:0;h--;){var y=a[h],m=y.func;if(m==null||m==r)return y.name}return n}function Rn(r){var n=nt.call(_,"placeholder")?_:r;return n.placeholder}function me(){var r=_.iteratee||jc;return r=r===jc?zh:r,arguments.length?r(arguments[0],arguments[1]):r}function No(r,n){var a=r.__data__;return Dy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function bc(r){for(var n=Vt(r),a=n.length;a--;){var h=n[a],y=r[h];n[a]=[h,y,El(y)]}return n}function en(r,n){var a=xg(r,n);return Fh(a)?a:t}function yy(r){var n=nt.call(r,Yi),a=r[Yi];try{r[Yi]=t;var h=!0}catch{}var y=uo.call(r);return h&&(n?r[Yi]=a:delete r[Yi]),y}var Ec=Ya?function(r){return r==null?[]:(r=ht(r),Ci(Ya(r),function(n){return Ih.call(r,n)}))}:Fc,ml=Ya?function(r){for(var n=[];r;)Ai(n,Ec(r)),r=fo(r);return n}:Fc,Zt=sr;(Ja&&Zt(new Ja(new ArrayBuffer(1)))!=Ce||es&&Zt(new es)!=Ie||Qa&&Zt(Qa.resolve())!=gt||On&&Zt(new On)!=xe||ts&&Zt(new ts)!=Pe)&&(Zt=function(r){var n=sr(r),a=n==je?r.constructor:t,h=a?tn(a):"";if(h)switch(h){case Xg:return Ce;case Zg:return Ie;case e0:return gt;case t0:return xe;case r0:return Pe}return n});function vy(r,n,a){for(var h=-1,y=a.length;++h<y;){var m=a[h],P=m.size;switch(m.type){case"drop":r+=P;break;case"dropRight":n-=P;break;case"take":n=Xt(n,r+P);break;case"takeRight":r=Kt(r,n-P);break}}return{start:r,end:n}}function _y(r){var n=r.match(lt);return n?n[1].split(qt):[]}function wl(r,n,a){n=Ui(n,r);for(var h=-1,y=n.length,m=!1;++h<y;){var P=ri(n[h]);if(!(m=r!=null&&a(r,P)))break;r=r[P]}return m||++h!=y?m:(y=r==null?0:r.length,!!y&&Fo(y)&&gi(P,y)&&(Re(r)||rn(r)))}function my(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function bl(r){return typeof r.constructor=="function"&&!hs(r)?Cn(fo(r)):{}}function wy(r,n,a){var h=r.constructor;switch(n){case Se:return gc(r);case z:case U:return new h(+r);case Ce:return iy(r,a);case He:case Oe:case Ve:case We:case et:case tt:case Qe:case rr:case dr:return il(r,a);case Ie:return new h;case Be:case Ne:return new h(r);case qe:return ny(r);case xe:return new h;case $e:return sy(r)}}function by(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Ct,`{
/* [wrapped with `+n+`] */
`)}function Ey(r){return Re(r)||rn(r)||!!(xh&&r&&r[xh])}function gi(r,n){var a=typeof r;return n=n??k,!!n&&(a=="number"||a!="symbol"&&Ia.test(r))&&r>-1&&r%1==0&&r<n}function or(r,n,a){if(!Dt(a))return!1;var h=typeof n;return(h=="number"?yr(a)&&gi(n,a.length):h=="string"&&n in a)?Vr(a[n],r):!1}function Dc(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Ir(r)?!0:Lt.test(r)||!_t.test(r)||n!=null&&r in ht(n)}function Dy(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Sc(r){var n=Ro(r),a=_[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var h=wc(a);return!!h&&r===h[0]}function Sy(r){return!!Eh&&Eh in r}var Iy=ao?yi:zc;function hs(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||xn;return r===a}function El(r){return r===r&&!Dt(r)}function Dl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ht(a))}}function xy(r){var n=Mo(r,function(h){return a.size===p&&a.clear(),h}),a=n.cache;return n}function Oy(r,n){var a=r[1],h=n[1],y=a|h,m=y<(H|ie|u),P=h==u&&a==M||h==u&&a==w&&r[7].length<=n[8]||h==(u|w)&&n[7].length<=n[8]&&a==M;if(!(m||P))return r;h&H&&(r[2]=n[2],y|=a&H?0:$);var N=n[3];if(N){var q=r[3];r[3]=q?sl(q,N,n[4]):N,r[4]=q?Ti(r[3],v):n[4]}return N=n[5],N&&(q=r[5],r[5]=q?ol(q,N,n[6]):N,r[6]=q?Ti(r[5],v):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:Xt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=y,r}function Py(r){var n=[];if(r!=null)for(var a in ht(r))n.push(a);return n}function Cy(r){return uo.call(r)}function Sl(r,n,a){return n=Kt(n===t?r.length-1:n,0),function(){for(var h=arguments,y=-1,m=Kt(h.length-n,0),P=K(m);++y<m;)P[y]=h[n+y];y=-1;for(var N=K(n+1);++y<n;)N[y]=h[y];return N[n]=a(P),kt(r,this,N)}}function Il(r,n){return n.length<2?r:Zi(r,jr(n,0,-1))}function Ay(r,n){for(var a=r.length,h=Xt(n.length,a),y=gr(r);h--;){var m=n[h];r[h]=gi(m,a)?y[m]:t}return r}function Ic(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var xl=Pl(Yh),ls=kg||function(r,n){return Xe.setTimeout(r,n)},xc=Pl(Z0);function Ol(r,n,a){var h=n+"";return xc(r,by(h,Ty(_y(h),a)))}function Pl(r){var n=0,a=0;return function(){var h=Yg(),y=de-(h-a);if(a=h,y>0){if(++n>=ue)return arguments[0]}else n=0;return r.apply(t,arguments)}}function $o(r,n){var a=-1,h=r.length,y=h-1;for(n=n===t?h:n;++a<n;){var m=cc(a,y),P=r[m];r[m]=r[a],r[a]=P}return r.length=n,r}var Cl=xy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(jt,function(a,h,y,m){n.push(y?m.replace(ma,"$1"):h||a)}),n});function ri(r){if(typeof r=="string"||Ir(r))return r;var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function tn(r){if(r!=null){try{return co.call(r)}catch{}try{return r+""}catch{}}return""}function Ty(r,n){return Nr(be,function(a){var h="_."+a[0];n&a[1]&&!io(r,h)&&r.push(h)}),r.sort()}function Al(r){if(r instanceof Ye)return r.clone();var n=new Ur(r.__wrapped__,r.__chain__);return n.__actions__=gr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function Ry(r,n,a){(a?or(r,n,a):n===t)?n=1:n=Kt(Me(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var y=0,m=0,P=K(yo(h/n));y<h;)P[m++]=jr(r,y,y+=n);return P}function Ny(r){for(var n=-1,a=r==null?0:r.length,h=0,y=[];++n<a;){var m=r[n];m&&(y[h++]=m)}return y}function $y(){var r=arguments.length;if(!r)return[];for(var n=K(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return Ai(Re(a)?gr(a):[a],Yt(n,1))}var Uy=Ke(function(r,n){return Nt(r)?ss(r,Yt(n,1,Nt,!0)):[]}),Ly=Ke(function(r,n){var a=Mr(n);return Nt(a)&&(a=t),Nt(r)?ss(r,Yt(n,1,Nt,!0),me(a,2)):[]}),jy=Ke(function(r,n){var a=Mr(n);return Nt(a)&&(a=t),Nt(r)?ss(r,Yt(n,1,Nt,!0),t,a):[]});function My(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),jr(r,n<0?0:n,h)):[]}function qy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),n=h-n,jr(r,0,n<0?0:n)):[]}function Fy(r,n){return r&&r.length?xo(r,me(n,3),!0,!0):[]}function zy(r,n){return r&&r.length?xo(r,me(n,3),!0):[]}function By(r,n,a,h){var y=r==null?0:r.length;return y?(a&&typeof a!="number"&&or(r,n,a)&&(a=0,h=y),$0(r,n,a,h)):[]}function Tl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=a==null?0:Me(a);return y<0&&(y=Kt(h+y,0)),no(r,me(n,3),y)}function Rl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=h-1;return a!==t&&(y=Me(a),y=a<0?Kt(h+y,0):Xt(y,h-1)),no(r,me(n,3),y,!0)}function Nl(r){var n=r==null?0:r.length;return n?Yt(r,1):[]}function Hy(r){var n=r==null?0:r.length;return n?Yt(r,Q):[]}function Ky(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:Me(n),Yt(r,n)):[]}function ky(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var y=r[n];h[y[0]]=y[1]}return h}function $l(r){return r&&r.length?r[0]:t}function Vy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=a==null?0:Me(a);return y<0&&(y=Kt(h+y,0)),En(r,n,y)}function Gy(r){var n=r==null?0:r.length;return n?jr(r,0,-1):[]}var Wy=Ke(function(r){var n=mt(r,dc);return n.length&&n[0]===r[0]?ic(n):[]}),Yy=Ke(function(r){var n=Mr(r),a=mt(r,dc);return n===Mr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?ic(a,me(n,2)):[]}),Jy=Ke(function(r){var n=Mr(r),a=mt(r,dc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?ic(a,t,n):[]});function Qy(r,n){return r==null?"":Gg.call(r,n)}function Mr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Xy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=h;return a!==t&&(y=Me(a),y=y<0?Kt(h+y,0):Xt(y,h-1)),n===n?Tg(r,n,y):no(r,ph,y,!0)}function Zy(r,n){return r&&r.length?kh(r,Me(n)):t}var ev=Ke(Ul);function Ul(r,n){return r&&r.length&&n&&n.length?ac(r,n):r}function tv(r,n,a){return r&&r.length&&n&&n.length?ac(r,n,me(a,2)):r}function rv(r,n,a){return r&&r.length&&n&&n.length?ac(r,n,t,a):r}var iv=pi(function(r,n){var a=r==null?0:r.length,h=Za(r,n);return Wh(r,mt(n,function(y){return gi(y,a)?+y:y}).sort(nl)),h});function nv(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,y=[],m=r.length;for(n=me(n,3);++h<m;){var P=r[h];n(P,h,r)&&(a.push(P),y.push(h))}return Wh(r,y),a}function Oc(r){return r==null?r:Qg.call(r)}function sv(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&or(r,n,a)?(n=0,a=h):(n=n==null?0:Me(n),a=a===t?h:Me(a)),jr(r,n,a)):[]}function ov(r,n){return Io(r,n)}function av(r,n,a){return hc(r,n,me(a,2))}function cv(r,n){var a=r==null?0:r.length;if(a){var h=Io(r,n);if(h<a&&Vr(r[h],n))return h}return-1}function uv(r,n){return Io(r,n,!0)}function hv(r,n,a){return hc(r,n,me(a,2),!0)}function lv(r,n){var a=r==null?0:r.length;if(a){var h=Io(r,n,!0)-1;if(Vr(r[h],n))return h}return-1}function fv(r){return r&&r.length?Jh(r):[]}function dv(r,n){return r&&r.length?Jh(r,me(n,2)):[]}function pv(r){var n=r==null?0:r.length;return n?jr(r,1,n):[]}function gv(r,n,a){return r&&r.length?(n=a||n===t?1:Me(n),jr(r,0,n<0?0:n)):[]}function yv(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),n=h-n,jr(r,n<0?0:n,h)):[]}function vv(r,n){return r&&r.length?xo(r,me(n,3),!1,!0):[]}function _v(r,n){return r&&r.length?xo(r,me(n,3)):[]}var mv=Ke(function(r){return $i(Yt(r,1,Nt,!0))}),wv=Ke(function(r){var n=Mr(r);return Nt(n)&&(n=t),$i(Yt(r,1,Nt,!0),me(n,2))}),bv=Ke(function(r){var n=Mr(r);return n=typeof n=="function"?n:t,$i(Yt(r,1,Nt,!0),t,n)});function Ev(r){return r&&r.length?$i(r):[]}function Dv(r,n){return r&&r.length?$i(r,me(n,2)):[]}function Sv(r,n){return n=typeof n=="function"?n:t,r&&r.length?$i(r,t,n):[]}function Pc(r){if(!(r&&r.length))return[];var n=0;return r=Ci(r,function(a){if(Nt(a))return n=Kt(a.length,n),!0}),ka(n,function(a){return mt(r,Ba(a))})}function Ll(r,n){if(!(r&&r.length))return[];var a=Pc(r);return n==null?a:mt(a,function(h){return kt(n,t,h)})}var Iv=Ke(function(r,n){return Nt(r)?ss(r,n):[]}),xv=Ke(function(r){return fc(Ci(r,Nt))}),Ov=Ke(function(r){var n=Mr(r);return Nt(n)&&(n=t),fc(Ci(r,Nt),me(n,2))}),Pv=Ke(function(r){var n=Mr(r);return n=typeof n=="function"?n:t,fc(Ci(r,Nt),t,n)}),Cv=Ke(Pc);function Av(r,n){return el(r||[],n||[],ns)}function Tv(r,n){return el(r||[],n||[],cs)}var Rv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Ll(r,a)});function jl(r){var n=_(r);return n.__chain__=!0,n}function Nv(r,n){return n(r),r}function Uo(r,n){return n(r)}var $v=pi(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,y=function(m){return Za(m,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!gi(a)?this.thru(y):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:Uo,args:[y],thisArg:t}),new Ur(h,this.__chain__).thru(function(m){return n&&!m.length&&m.push(t),m}))});function Uv(){return jl(this)}function Lv(){return new Ur(this.value(),this.__chain__)}function jv(){this.__values__===t&&(this.__values__=Ql(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function Mv(){return this}function qv(r){for(var n,a=this;a instanceof wo;){var h=Al(a);h.__index__=0,h.__values__=t,n?y.__wrapped__=h:n=h;var y=h;a=a.__wrapped__}return y.__wrapped__=r,n}function Fv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:Uo,args:[Oc],thisArg:t}),new Ur(n,this.__chain__)}return this.thru(Oc)}function zv(){return Zh(this.__wrapped__,this.__actions__)}var Bv=Oo(function(r,n,a){nt.call(r,a)?++r[a]:fi(r,a,1)});function Hv(r,n,a){var h=Re(r)?fh:N0;return a&&or(r,n,a)&&(n=t),h(r,me(n,3))}function Kv(r,n){var a=Re(r)?Ci:Lh;return a(r,me(n,3))}var kv=hl(Tl),Vv=hl(Rl);function Gv(r,n){return Yt(Lo(r,n),1)}function Wv(r,n){return Yt(Lo(r,n),Q)}function Yv(r,n,a){return a=a===t?1:Me(a),Yt(Lo(r,n),a)}function Ml(r,n){var a=Re(r)?Nr:Ni;return a(r,me(n,3))}function ql(r,n){var a=Re(r)?pg:Uh;return a(r,me(n,3))}var Jv=Oo(function(r,n,a){nt.call(r,a)?r[a].push(n):fi(r,a,[n])});function Qv(r,n,a,h){r=yr(r)?r:$n(r),a=a&&!h?Me(a):0;var y=r.length;return a<0&&(a=Kt(y+a,0)),zo(r)?a<=y&&r.indexOf(n,a)>-1:!!y&&En(r,n,a)>-1}var Xv=Ke(function(r,n,a){var h=-1,y=typeof n=="function",m=yr(r)?K(r.length):[];return Ni(r,function(P){m[++h]=y?kt(n,P,a):os(P,n,a)}),m}),Zv=Oo(function(r,n,a){fi(r,a,n)});function Lo(r,n){var a=Re(r)?mt:Bh;return a(r,me(n,3))}function e_(r,n,a,h){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),Vh(r,n,a))}var t_=Oo(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function r_(r,n,a){var h=Re(r)?Fa:yh,y=arguments.length<3;return h(r,me(n,4),a,y,Ni)}function i_(r,n,a){var h=Re(r)?gg:yh,y=arguments.length<3;return h(r,me(n,4),a,y,Uh)}function n_(r,n){var a=Re(r)?Ci:Lh;return a(r,qo(me(n,3)))}function s_(r){var n=Re(r)?Th:Q0;return n(r)}function o_(r,n,a){(a?or(r,n,a):n===t)?n=1:n=Me(n);var h=Re(r)?P0:X0;return h(r,n)}function a_(r){var n=Re(r)?C0:ey;return n(r)}function c_(r){if(r==null)return 0;if(yr(r))return zo(r)?Sn(r):r.length;var n=Zt(r);return n==Ie||n==xe?r.size:sc(r).length}function u_(r,n,a){var h=Re(r)?za:ty;return a&&or(r,n,a)&&(n=t),h(r,me(n,3))}var h_=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&or(r,n[0],n[1])?n=[]:a>2&&or(n[0],n[1],n[2])&&(n=[n[0]]),Vh(r,Yt(n,1),[])}),jo=Kg||function(){return Xe.Date.now()};function l_(r,n){if(typeof n!="function")throw new $r(l);return r=Me(r),function(){if(--r<1)return n.apply(this,arguments)}}function Fl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,di(r,u,t,t,t,t,n)}function zl(r,n){var a;if(typeof n!="function")throw new $r(l);return r=Me(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Cc=Ke(function(r,n,a){var h=H;if(a.length){var y=Ti(a,Rn(Cc));h|=T}return di(r,h,n,a,y)}),Bl=Ke(function(r,n,a){var h=H|ie;if(a.length){var y=Ti(a,Rn(Bl));h|=T}return di(n,h,r,a,y)});function Hl(r,n,a){n=a?t:n;var h=di(r,M,t,t,t,t,t,n);return h.placeholder=Hl.placeholder,h}function Kl(r,n,a){n=a?t:n;var h=di(r,C,t,t,t,t,t,n);return h.placeholder=Kl.placeholder,h}function kl(r,n,a){var h,y,m,P,N,q,X=0,Z=!1,ne=!1,he=!0;if(typeof r!="function")throw new $r(l);n=qr(n)||0,Dt(a)&&(Z=!!a.leading,ne="maxWait"in a,m=ne?Kt(qr(a.maxWait)||0,n):m,he="trailing"in a?!!a.trailing:he);function ye($t){var Gr=h,_i=y;return h=y=t,X=$t,P=r.apply(_i,Gr),P}function Ee($t){return X=$t,N=ls(Ge,n),Z?ye($t):P}function ze($t){var Gr=$t-q,_i=$t-X,lf=n-Gr;return ne?Xt(lf,m-_i):lf}function De($t){var Gr=$t-q,_i=$t-X;return q===t||Gr>=n||Gr<0||ne&&_i>=m}function Ge(){var $t=jo();if(De($t))return Ze($t);N=ls(Ge,ze($t))}function Ze($t){return N=t,he&&h?ye($t):(h=y=t,P)}function xr(){N!==t&&tl(N),X=0,h=q=y=N=t}function ar(){return N===t?P:Ze(jo())}function Or(){var $t=jo(),Gr=De($t);if(h=arguments,y=this,q=$t,Gr){if(N===t)return Ee(q);if(ne)return tl(N),N=ls(Ge,n),ye(q)}return N===t&&(N=ls(Ge,n)),P}return Or.cancel=xr,Or.flush=ar,Or}var f_=Ke(function(r,n){return $h(r,1,n)}),d_=Ke(function(r,n,a){return $h(r,qr(n)||0,a)});function p_(r){return di(r,G)}function Mo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new $r(l);var a=function(){var h=arguments,y=n?n.apply(this,h):h[0],m=a.cache;if(m.has(y))return m.get(y);var P=r.apply(this,h);return a.cache=m.set(y,P)||m,P};return a.cache=new(Mo.Cache||li),a}Mo.Cache=li;function qo(r){if(typeof r!="function")throw new $r(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function g_(r){return zl(2,r)}var y_=ry(function(r,n){n=n.length==1&&Re(n[0])?mt(n[0],Dr(me())):mt(Yt(n,1),Dr(me()));var a=n.length;return Ke(function(h){for(var y=-1,m=Xt(h.length,a);++y<m;)h[y]=n[y].call(this,h[y]);return kt(r,this,h)})}),Ac=Ke(function(r,n){var a=Ti(n,Rn(Ac));return di(r,T,t,n,a)}),Vl=Ke(function(r,n){var a=Ti(n,Rn(Vl));return di(r,E,t,n,a)}),v_=pi(function(r,n){return di(r,w,t,t,t,n)});function __(r,n){if(typeof r!="function")throw new $r(l);return n=n===t?n:Me(n),Ke(r,n)}function m_(r,n){if(typeof r!="function")throw new $r(l);return n=n==null?0:Kt(Me(n),0),Ke(function(a){var h=a[n],y=Li(a,0,n);return h&&Ai(y,h),kt(r,this,y)})}function w_(r,n,a){var h=!0,y=!0;if(typeof r!="function")throw new $r(l);return Dt(a)&&(h="leading"in a?!!a.leading:h,y="trailing"in a?!!a.trailing:y),kl(r,n,{leading:h,maxWait:n,trailing:y})}function b_(r){return Fl(r,1)}function E_(r,n){return Ac(pc(n),r)}function D_(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function S_(r){return Lr(r,x)}function I_(r,n){return n=typeof n=="function"?n:t,Lr(r,x,n)}function x_(r){return Lr(r,D|x)}function O_(r,n){return n=typeof n=="function"?n:t,Lr(r,D|x,n)}function P_(r,n){return n==null||Nh(r,n,Vt(n))}function Vr(r,n){return r===n||r!==r&&n!==n}var C_=To(rc),A_=To(function(r,n){return r>=n}),rn=qh(function(){return arguments}())?qh:function(r){return At(r)&&nt.call(r,"callee")&&!Ih.call(r,"callee")},Re=K.isArray,T_=nr?Dr(nr):q0;function yr(r){return r!=null&&Fo(r.length)&&!yi(r)}function Nt(r){return At(r)&&yr(r)}function R_(r){return r===!0||r===!1||At(r)&&sr(r)==z}var ji=Vg||zc,N_=Hr?Dr(Hr):F0;function $_(r){return At(r)&&r.nodeType===1&&!fs(r)}function U_(r){if(r==null)return!0;if(yr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||ji(r)||Nn(r)||rn(r)))return!r.length;var n=Zt(r);if(n==Ie||n==xe)return!r.size;if(hs(r))return!sc(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function L_(r,n){return as(r,n)}function j_(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?as(r,n,t,a):!!h}function Tc(r){if(!At(r))return!1;var n=sr(r);return n==R||n==d||typeof r.message=="string"&&typeof r.name=="string"&&!fs(r)}function M_(r){return typeof r=="number"&&Oh(r)}function yi(r){if(!Dt(r))return!1;var n=sr(r);return n==ae||n==fe||n==B||n==yt}function Gl(r){return typeof r=="number"&&r==Me(r)}function Fo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=k}function Dt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function At(r){return r!=null&&typeof r=="object"}var Wl=Rr?Dr(Rr):B0;function q_(r,n){return r===n||nc(r,n,bc(n))}function F_(r,n,a){return a=typeof a=="function"?a:t,nc(r,n,bc(n),a)}function z_(r){return Yl(r)&&r!=+r}function B_(r){if(Iy(r))throw new Ae(c);return Fh(r)}function H_(r){return r===null}function K_(r){return r==null}function Yl(r){return typeof r=="number"||At(r)&&sr(r)==Be}function fs(r){if(!At(r)||sr(r)!=je)return!1;var n=fo(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&co.call(a)==Fg}var Rc=Zr?Dr(Zr):H0;function k_(r){return Gl(r)&&r>=-k&&r<=k}var Jl=Qn?Dr(Qn):K0;function zo(r){return typeof r=="string"||!Re(r)&&At(r)&&sr(r)==Ne}function Ir(r){return typeof r=="symbol"||At(r)&&sr(r)==$e}var Nn=Wi?Dr(Wi):k0;function V_(r){return r===t}function G_(r){return At(r)&&Zt(r)==Pe}function W_(r){return At(r)&&sr(r)==Ue}var Y_=To(oc),J_=To(function(r,n){return r<=n});function Ql(r){if(!r)return[];if(yr(r))return zo(r)?Kr(r):gr(r);if(Zn&&r[Zn])return Pg(r[Zn]());var n=Zt(r),a=n==Ie?Ga:n==xe?so:$n;return a(r)}function vi(r){if(!r)return r===0?r:0;if(r=qr(r),r===Q||r===-Q){var n=r<0?-1:1;return n*V}return r===r?r:0}function Me(r){var n=vi(r),a=n%1;return n===n?a?n-a:n:0}function Xl(r){return r?Xi(Me(r),0,re):0}function qr(r){if(typeof r=="number")return r;if(Ir(r))return J;if(Dt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Dt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=vh(r);var a=Ea.test(r);return a||Sa.test(r)?Te(r.slice(2),a?2:8):ba.test(r)?J:+r}function Zl(r){return ti(r,vr(r))}function Q_(r){return r?Xi(Me(r),-k,k):r===0?r:0}function it(r){return r==null?"":Sr(r)}var X_=An(function(r,n){if(hs(n)||yr(n)){ti(n,Vt(n),r);return}for(var a in n)nt.call(n,a)&&ns(r,a,n[a])}),ef=An(function(r,n){ti(n,vr(n),r)}),Bo=An(function(r,n,a,h){ti(n,vr(n),r,h)}),Z_=An(function(r,n,a,h){ti(n,Vt(n),r,h)}),em=pi(Za);function tm(r,n){var a=Cn(r);return n==null?a:Rh(a,n)}var rm=Ke(function(r,n){r=ht(r);var a=-1,h=n.length,y=h>2?n[2]:t;for(y&&or(n[0],n[1],y)&&(h=1);++a<h;)for(var m=n[a],P=vr(m),N=-1,q=P.length;++N<q;){var X=P[N],Z=r[X];(Z===t||Vr(Z,xn[X])&&!nt.call(r,X))&&(r[X]=m[X])}return r}),im=Ke(function(r){return r.push(t,vl),kt(tf,t,r)});function nm(r,n){return dh(r,me(n,3),ei)}function sm(r,n){return dh(r,me(n,3),tc)}function om(r,n){return r==null?r:ec(r,me(n,3),vr)}function am(r,n){return r==null?r:jh(r,me(n,3),vr)}function cm(r,n){return r&&ei(r,me(n,3))}function um(r,n){return r&&tc(r,me(n,3))}function hm(r){return r==null?[]:Do(r,Vt(r))}function lm(r){return r==null?[]:Do(r,vr(r))}function Nc(r,n,a){var h=r==null?t:Zi(r,n);return h===t?a:h}function fm(r,n){return r!=null&&wl(r,n,U0)}function $c(r,n){return r!=null&&wl(r,n,L0)}var dm=fl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=uo.call(n)),r[n]=a},Lc(_r)),pm=fl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=uo.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},me),gm=Ke(os);function Vt(r){return yr(r)?Ah(r):sc(r)}function vr(r){return yr(r)?Ah(r,!0):V0(r)}function ym(r,n){var a={};return n=me(n,3),ei(r,function(h,y,m){fi(a,n(h,y,m),h)}),a}function vm(r,n){var a={};return n=me(n,3),ei(r,function(h,y,m){fi(a,y,n(h,y,m))}),a}var _m=An(function(r,n,a){So(r,n,a)}),tf=An(function(r,n,a,h){So(r,n,a,h)}),mm=pi(function(r,n){var a={};if(r==null)return a;var h=!1;n=mt(n,function(m){return m=Ui(m,r),h||(h=m.length>1),m}),ti(r,mc(r),a),h&&(a=Lr(a,D|S|x,dy));for(var y=n.length;y--;)lc(a,n[y]);return a});function wm(r,n){return rf(r,qo(me(n)))}var bm=pi(function(r,n){return r==null?{}:W0(r,n)});function rf(r,n){if(r==null)return{};var a=mt(mc(r),function(h){return[h]});return n=me(n),Gh(r,a,function(h,y){return n(h,y[0])})}function Em(r,n,a){n=Ui(n,r);var h=-1,y=n.length;for(y||(y=1,r=t);++h<y;){var m=r==null?t:r[ri(n[h])];m===t&&(h=y,m=a),r=yi(m)?m.call(r):m}return r}function Dm(r,n,a){return r==null?r:cs(r,n,a)}function Sm(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:cs(r,n,a,h)}var nf=gl(Vt),sf=gl(vr);function Im(r,n,a){var h=Re(r),y=h||ji(r)||Nn(r);if(n=me(n,4),a==null){var m=r&&r.constructor;y?a=h?new m:[]:Dt(r)?a=yi(m)?Cn(fo(r)):{}:a={}}return(y?Nr:ei)(r,function(P,N,q){return n(a,P,N,q)}),a}function xm(r,n){return r==null?!0:lc(r,n)}function Om(r,n,a){return r==null?r:Xh(r,n,pc(a))}function Pm(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Xh(r,n,pc(a),h)}function $n(r){return r==null?[]:Va(r,Vt(r))}function Cm(r){return r==null?[]:Va(r,vr(r))}function Am(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=qr(a),a=a===a?a:0),n!==t&&(n=qr(n),n=n===n?n:0),Xi(qr(r),n,a)}function Tm(r,n,a){return n=vi(n),a===t?(a=n,n=0):a=vi(a),r=qr(r),j0(r,n,a)}function Rm(r,n,a){if(a&&typeof a!="boolean"&&or(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=vi(r),n===t?(n=r,r=0):n=vi(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var y=Ph();return Xt(r+y*(n-r+ct("1e-"+((y+"").length-1))),n)}return cc(r,n)}var Nm=Tn(function(r,n,a){return n=n.toLowerCase(),r+(a?of(n):n)});function of(r){return Uc(it(r).toLowerCase())}function af(r){return r=it(r),r&&r.replace(ci,Dg).replace(ja,"")}function $m(r,n,a){r=it(r),n=Sr(n);var h=r.length;a=a===t?h:Xi(Me(a),0,h);var y=a;return a-=n.length,a>=0&&r.slice(a,y)==n}function Um(r){return r=it(r),r&&vt.test(r)?r.replace(Hi,Sg):r}function Lm(r){return r=it(r),r&&Mt.test(r)?r.replace(Ot,"\\$&"):r}var jm=Tn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),Mm=Tn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),qm=ul("toLowerCase");function Fm(r,n,a){r=it(r),n=Me(n);var h=n?Sn(r):0;if(!n||h>=n)return r;var y=(n-h)/2;return Ao(vo(y),a)+r+Ao(yo(y),a)}function zm(r,n,a){r=it(r),n=Me(n);var h=n?Sn(r):0;return n&&h<n?r+Ao(n-h,a):r}function Bm(r,n,a){r=it(r),n=Me(n);var h=n?Sn(r):0;return n&&h<n?Ao(n-h,a)+r:r}function Hm(r,n,a){return a||n==null?n=0:n&&(n=+n),Jg(it(r).replace(Pt,""),n||0)}function Km(r,n,a){return(a?or(r,n,a):n===t)?n=1:n=Me(n),uc(it(r),n)}function km(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Vm=Tn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function Gm(r,n,a){return a&&typeof a!="number"&&or(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!Rc(n))&&(n=Sr(n),!n&&Dn(r))?Li(Kr(r),0,a):r.split(n,a)):[]}var Wm=Tn(function(r,n,a){return r+(a?" ":"")+Uc(n)});function Ym(r,n,a){return r=it(r),a=a==null?0:Xi(Me(a),0,r.length),n=Sr(n),r.slice(a,a+n.length)==n}function Jm(r,n,a){var h=_.templateSettings;a&&or(r,n,a)&&(n=t),r=it(r),n=Bo({},n,h,yl);var y=Bo({},n.imports,h.imports,yl),m=Vt(y),P=Va(y,m),N,q,X=0,Z=n.interpolate||gn,ne="__p += '",he=Wa((n.escape||gn).source+"|"+Z.source+"|"+(Z===Et?wa:gn).source+"|"+(n.evaluate||gn).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ma+"]")+`
`;r.replace(he,function(De,Ge,Ze,xr,ar,Or){return Ze||(Ze=xr),ne+=r.slice(X,Or).replace(xa,Ig),Ge&&(N=!0,ne+=`' +
__e(`+Ge+`) +
'`),ar&&(q=!0,ne+=`';
`+ar+`;
__p += '`),Ze&&(ne+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=Or+De.length,De}),ne+=`';
`;var Ee=nt.call(n,"variable")&&n.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(_a.test(Ee))throw new Ae(f);ne=(q?ne.replace(Qr,""):ne).replace(ir,"$1").replace(ai,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var ze=uf(function(){return rt(m,ye+"return "+ne).apply(t,P)});if(ze.source=ne,Tc(ze))throw ze;return ze}function Qm(r){return it(r).toLowerCase()}function Xm(r){return it(r).toUpperCase()}function Zm(r,n,a){if(r=it(r),r&&(a||n===t))return vh(r);if(!r||!(n=Sr(n)))return r;var h=Kr(r),y=Kr(n),m=_h(h,y),P=mh(h,y)+1;return Li(h,m,P).join("")}function ew(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,bh(r)+1);if(!r||!(n=Sr(n)))return r;var h=Kr(r),y=mh(h,Kr(n))+1;return Li(h,0,y).join("")}function tw(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(Pt,"");if(!r||!(n=Sr(n)))return r;var h=Kr(r),y=_h(h,Kr(n));return Li(h,y).join("")}function rw(r,n){var a=W,h=se;if(Dt(n)){var y="separator"in n?n.separator:y;a="length"in n?Me(n.length):a,h="omission"in n?Sr(n.omission):h}r=it(r);var m=r.length;if(Dn(r)){var P=Kr(r);m=P.length}if(a>=m)return r;var N=a-Sn(h);if(N<1)return h;var q=P?Li(P,0,N).join(""):r.slice(0,N);if(y===t)return q+h;if(P&&(N+=q.length-N),Rc(y)){if(r.slice(N).search(y)){var X,Z=q;for(y.global||(y=Wa(y.source,it(Tr.exec(y))+"g")),y.lastIndex=0;X=y.exec(Z);)var ne=X.index;q=q.slice(0,ne===t?N:ne)}}else if(r.indexOf(Sr(y),N)!=N){var he=q.lastIndexOf(y);he>-1&&(q=q.slice(0,he))}return q+h}function iw(r){return r=it(r),r&&St.test(r)?r.replace(Oi,Rg):r}var nw=Tn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Uc=ul("toUpperCase");function cf(r,n,a){return r=it(r),n=a?t:n,n===t?Og(r)?Ug(r):_g(r):r.match(n)||[]}var uf=Ke(function(r,n){try{return kt(r,t,n)}catch(a){return Tc(a)?a:new Ae(a)}}),sw=pi(function(r,n){return Nr(n,function(a){a=ri(a),fi(r,a,Cc(r[a],r))}),r});function ow(r){var n=r==null?0:r.length,a=me();return r=n?mt(r,function(h){if(typeof h[1]!="function")throw new $r(l);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var y=-1;++y<n;){var m=r[y];if(kt(m[0],this,h))return kt(m[1],this,h)}})}function aw(r){return R0(Lr(r,D))}function Lc(r){return function(){return r}}function cw(r,n){return r==null||r!==r?n:r}var uw=ll(),hw=ll(!0);function _r(r){return r}function jc(r){return zh(typeof r=="function"?r:Lr(r,D))}function lw(r){return Hh(Lr(r,D))}function fw(r,n){return Kh(r,Lr(n,D))}var dw=Ke(function(r,n){return function(a){return os(a,r,n)}}),pw=Ke(function(r,n){return function(a){return os(r,a,n)}});function Mc(r,n,a){var h=Vt(n),y=Do(n,h);a==null&&!(Dt(n)&&(y.length||!h.length))&&(a=n,n=r,r=this,y=Do(n,Vt(n)));var m=!(Dt(a)&&"chain"in a)||!!a.chain,P=yi(r);return Nr(y,function(N){var q=n[N];r[N]=q,P&&(r.prototype[N]=function(){var X=this.__chain__;if(m||X){var Z=r(this.__wrapped__),ne=Z.__actions__=gr(this.__actions__);return ne.push({func:q,args:arguments,thisArg:r}),Z.__chain__=X,Z}return q.apply(r,Ai([this.value()],arguments))})}),r}function gw(){return Xe._===this&&(Xe._=zg),this}function qc(){}function yw(r){return r=Me(r),Ke(function(n){return kh(n,r)})}var vw=yc(mt),_w=yc(fh),mw=yc(za);function hf(r){return Dc(r)?Ba(ri(r)):Y0(r)}function ww(r){return function(n){return r==null?t:Zi(r,n)}}var bw=dl(),Ew=dl(!0);function Fc(){return[]}function zc(){return!1}function Dw(){return{}}function Sw(){return""}function Iw(){return!0}function xw(r,n){if(r=Me(r),r<1||r>k)return[];var a=re,h=Xt(r,re);n=me(n),r-=re;for(var y=ka(h,n);++a<r;)n(a);return y}function Ow(r){return Re(r)?mt(r,ri):Ir(r)?[r]:gr(Cl(it(r)))}function Pw(r){var n=++qg;return it(r)+n}var Cw=Co(function(r,n){return r+n},0),Aw=vc("ceil"),Tw=Co(function(r,n){return r/n},1),Rw=vc("floor");function Nw(r){return r&&r.length?Eo(r,_r,rc):t}function $w(r,n){return r&&r.length?Eo(r,me(n,2),rc):t}function Uw(r){return gh(r,_r)}function Lw(r,n){return gh(r,me(n,2))}function jw(r){return r&&r.length?Eo(r,_r,oc):t}function Mw(r,n){return r&&r.length?Eo(r,me(n,2),oc):t}var qw=Co(function(r,n){return r*n},1),Fw=vc("round"),zw=Co(function(r,n){return r-n},0);function Bw(r){return r&&r.length?Ka(r,_r):0}function Hw(r,n){return r&&r.length?Ka(r,me(n,2)):0}return _.after=l_,_.ary=Fl,_.assign=X_,_.assignIn=ef,_.assignInWith=Bo,_.assignWith=Z_,_.at=em,_.before=zl,_.bind=Cc,_.bindAll=sw,_.bindKey=Bl,_.castArray=D_,_.chain=jl,_.chunk=Ry,_.compact=Ny,_.concat=$y,_.cond=ow,_.conforms=aw,_.constant=Lc,_.countBy=Bv,_.create=tm,_.curry=Hl,_.curryRight=Kl,_.debounce=kl,_.defaults=rm,_.defaultsDeep=im,_.defer=f_,_.delay=d_,_.difference=Uy,_.differenceBy=Ly,_.differenceWith=jy,_.drop=My,_.dropRight=qy,_.dropRightWhile=Fy,_.dropWhile=zy,_.fill=By,_.filter=Kv,_.flatMap=Gv,_.flatMapDeep=Wv,_.flatMapDepth=Yv,_.flatten=Nl,_.flattenDeep=Hy,_.flattenDepth=Ky,_.flip=p_,_.flow=uw,_.flowRight=hw,_.fromPairs=ky,_.functions=hm,_.functionsIn=lm,_.groupBy=Jv,_.initial=Gy,_.intersection=Wy,_.intersectionBy=Yy,_.intersectionWith=Jy,_.invert=dm,_.invertBy=pm,_.invokeMap=Xv,_.iteratee=jc,_.keyBy=Zv,_.keys=Vt,_.keysIn=vr,_.map=Lo,_.mapKeys=ym,_.mapValues=vm,_.matches=lw,_.matchesProperty=fw,_.memoize=Mo,_.merge=_m,_.mergeWith=tf,_.method=dw,_.methodOf=pw,_.mixin=Mc,_.negate=qo,_.nthArg=yw,_.omit=mm,_.omitBy=wm,_.once=g_,_.orderBy=e_,_.over=vw,_.overArgs=y_,_.overEvery=_w,_.overSome=mw,_.partial=Ac,_.partialRight=Vl,_.partition=t_,_.pick=bm,_.pickBy=rf,_.property=hf,_.propertyOf=ww,_.pull=ev,_.pullAll=Ul,_.pullAllBy=tv,_.pullAllWith=rv,_.pullAt=iv,_.range=bw,_.rangeRight=Ew,_.rearg=v_,_.reject=n_,_.remove=nv,_.rest=__,_.reverse=Oc,_.sampleSize=o_,_.set=Dm,_.setWith=Sm,_.shuffle=a_,_.slice=sv,_.sortBy=h_,_.sortedUniq=fv,_.sortedUniqBy=dv,_.split=Gm,_.spread=m_,_.tail=pv,_.take=gv,_.takeRight=yv,_.takeRightWhile=vv,_.takeWhile=_v,_.tap=Nv,_.throttle=w_,_.thru=Uo,_.toArray=Ql,_.toPairs=nf,_.toPairsIn=sf,_.toPath=Ow,_.toPlainObject=Zl,_.transform=Im,_.unary=b_,_.union=mv,_.unionBy=wv,_.unionWith=bv,_.uniq=Ev,_.uniqBy=Dv,_.uniqWith=Sv,_.unset=xm,_.unzip=Pc,_.unzipWith=Ll,_.update=Om,_.updateWith=Pm,_.values=$n,_.valuesIn=Cm,_.without=Iv,_.words=cf,_.wrap=E_,_.xor=xv,_.xorBy=Ov,_.xorWith=Pv,_.zip=Cv,_.zipObject=Av,_.zipObjectDeep=Tv,_.zipWith=Rv,_.entries=nf,_.entriesIn=sf,_.extend=ef,_.extendWith=Bo,Mc(_,_),_.add=Cw,_.attempt=uf,_.camelCase=Nm,_.capitalize=of,_.ceil=Aw,_.clamp=Am,_.clone=S_,_.cloneDeep=x_,_.cloneDeepWith=O_,_.cloneWith=I_,_.conformsTo=P_,_.deburr=af,_.defaultTo=cw,_.divide=Tw,_.endsWith=$m,_.eq=Vr,_.escape=Um,_.escapeRegExp=Lm,_.every=Hv,_.find=kv,_.findIndex=Tl,_.findKey=nm,_.findLast=Vv,_.findLastIndex=Rl,_.findLastKey=sm,_.floor=Rw,_.forEach=Ml,_.forEachRight=ql,_.forIn=om,_.forInRight=am,_.forOwn=cm,_.forOwnRight=um,_.get=Nc,_.gt=C_,_.gte=A_,_.has=fm,_.hasIn=$c,_.head=$l,_.identity=_r,_.includes=Qv,_.indexOf=Vy,_.inRange=Tm,_.invoke=gm,_.isArguments=rn,_.isArray=Re,_.isArrayBuffer=T_,_.isArrayLike=yr,_.isArrayLikeObject=Nt,_.isBoolean=R_,_.isBuffer=ji,_.isDate=N_,_.isElement=$_,_.isEmpty=U_,_.isEqual=L_,_.isEqualWith=j_,_.isError=Tc,_.isFinite=M_,_.isFunction=yi,_.isInteger=Gl,_.isLength=Fo,_.isMap=Wl,_.isMatch=q_,_.isMatchWith=F_,_.isNaN=z_,_.isNative=B_,_.isNil=K_,_.isNull=H_,_.isNumber=Yl,_.isObject=Dt,_.isObjectLike=At,_.isPlainObject=fs,_.isRegExp=Rc,_.isSafeInteger=k_,_.isSet=Jl,_.isString=zo,_.isSymbol=Ir,_.isTypedArray=Nn,_.isUndefined=V_,_.isWeakMap=G_,_.isWeakSet=W_,_.join=Qy,_.kebabCase=jm,_.last=Mr,_.lastIndexOf=Xy,_.lowerCase=Mm,_.lowerFirst=qm,_.lt=Y_,_.lte=J_,_.max=Nw,_.maxBy=$w,_.mean=Uw,_.meanBy=Lw,_.min=jw,_.minBy=Mw,_.stubArray=Fc,_.stubFalse=zc,_.stubObject=Dw,_.stubString=Sw,_.stubTrue=Iw,_.multiply=qw,_.nth=Zy,_.noConflict=gw,_.noop=qc,_.now=jo,_.pad=Fm,_.padEnd=zm,_.padStart=Bm,_.parseInt=Hm,_.random=Rm,_.reduce=r_,_.reduceRight=i_,_.repeat=Km,_.replace=km,_.result=Em,_.round=Fw,_.runInContext=j,_.sample=s_,_.size=c_,_.snakeCase=Vm,_.some=u_,_.sortedIndex=ov,_.sortedIndexBy=av,_.sortedIndexOf=cv,_.sortedLastIndex=uv,_.sortedLastIndexBy=hv,_.sortedLastIndexOf=lv,_.startCase=Wm,_.startsWith=Ym,_.subtract=zw,_.sum=Bw,_.sumBy=Hw,_.template=Jm,_.times=xw,_.toFinite=vi,_.toInteger=Me,_.toLength=Xl,_.toLower=Qm,_.toNumber=qr,_.toSafeInteger=Q_,_.toString=it,_.toUpper=Xm,_.trim=Zm,_.trimEnd=ew,_.trimStart=tw,_.truncate=rw,_.unescape=iw,_.uniqueId=Pw,_.upperCase=nw,_.upperFirst=Uc,_.each=Ml,_.eachRight=ql,_.first=$l,Mc(_,function(){var r={};return ei(_,function(n,a){nt.call(_.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),_.VERSION=s,Nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){_[r].placeholder=_}),Nr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Kt(Me(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Xt(a,h.__takeCount__):h.__views__.push({size:Xt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Nr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==b||a==ee;Ye.prototype[r]=function(y){var m=this.clone();return m.__iteratees__.push({iteratee:me(y,3),type:a}),m.__filtered__=m.__filtered__||h,m}}),Nr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Nr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(_r)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return os(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(qo(me(r)))},Ye.prototype.slice=function(r,n){r=Me(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=Me(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},ei(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),y=_[h?"take"+(n=="last"?"Right":""):n],m=h||/^find/.test(n);y&&(_.prototype[n]=function(){var P=this.__wrapped__,N=h?[1]:arguments,q=P instanceof Ye,X=N[0],Z=q||Re(P),ne=function(Ge){var Ze=y.apply(_,Ai([Ge],N));return h&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(q=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=m&&!he,ze=q&&!ye;if(!m&&Z){P=ze?P:new Ye(this);var De=r.apply(P,N);return De.__actions__.push({func:Uo,args:[ne],thisArg:t}),new Ur(De,he)}return Ee&&ze?r.apply(this,N):(De=this.thru(ne),Ee?h?De.value()[0]:De.value():De)})}),Nr(["pop","push","shift","sort","splice","unshift"],function(r){var n=oo[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);_.prototype[r]=function(){var y=arguments;if(h&&!this.__chain__){var m=this.value();return n.apply(Re(m)?m:[],y)}return this[a](function(P){return n.apply(Re(P)?P:[],y)})}}),ei(Ye.prototype,function(r,n){var a=_[n];if(a){var h=a.name+"";nt.call(Pn,h)||(Pn[h]=[]),Pn[h].push({name:n,func:a})}}),Pn[Po(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=i0,Ye.prototype.reverse=n0,Ye.prototype.value=s0,_.prototype.at=$v,_.prototype.chain=Uv,_.prototype.commit=Lv,_.prototype.next=jv,_.prototype.plant=qv,_.prototype.reverse=Fv,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=zv,_.prototype.first=_.prototype.head,Zn&&(_.prototype[Zn]=Mv),_},In=Lg();Rt?((Rt.exports=In)._=In,ut._=In):Xe._=In}).call(ms)})(qu,qu.exports);var kx=Object.defineProperty,Vx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,zd=Object.getOwnPropertySymbols,Wx=Object.prototype.hasOwnProperty,Yx=Object.prototype.propertyIsEnumerable,Bd=(i,e,t)=>e in i?kx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Go=(i,e)=>{for(var t in e||(e={}))Wx.call(e,t)&&Bd(i,t,e[t]);if(zd)for(var t of zd(e))Yx.call(e,t)&&Bd(i,t,e[t]);return i},Jx=(i,e)=>Vx(i,Gx(e));function Fi(i,e,t){var s;const o=UE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${Kx}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function pn(i){return i.includes(":")?i.split(":")[1]:i}function lg(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Qx(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Hd(i={},e={}){const t=Kd(i),s=Kd(e);return qu.exports.merge(t,s)}function Kd(i){var e,t,s,o;const c={};if(!Os(i))return c;for(const[l,f]of Object.entries(i)){const g=th(l)?[l]:f.chains,p=f.methods||[],v=f.events||[],D=f.rpcMap||{},S=ws(l);c[S]=Jx(Go(Go({},c[S]),f),{chains:Gc(g,(e=c[S])==null?void 0:e.chains),methods:Gc(p,(t=c[S])==null?void 0:t.methods),events:Gc(v,(s=c[S])==null?void 0:s.events),rpcMap:Go(Go({},D),(o=c[S])==null?void 0:o.rpcMap)})}return c}function Xx(i){return i.includes(":")?i.split(":")[2]:i}function Zx(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=th(t)?[t]:s.chains?s.chains:lg(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function au(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const fg={},bt=i=>fg[i],cu=(i,e)=>{fg[i]=e};class e5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=pn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class t5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Fi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(pn(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class r5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=pn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class i5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=pn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class n5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=pn(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class s5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=pn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class o5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=pn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ii(new Bi(s,bt("disableProviderPing")))}}class a5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Fi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fi(e,this.namespace);return typeof s>"u"?void 0:new Ii(new Bi(s,bt("disableProviderPing")))}}var c5=Object.defineProperty,u5=Object.defineProperties,h5=Object.getOwnPropertyDescriptors,kd=Object.getOwnPropertySymbols,l5=Object.prototype.hasOwnProperty,f5=Object.prototype.propertyIsEnumerable,Vd=(i,e,t)=>e in i?c5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Wo=(i,e)=>{for(var t in e||(e={}))l5.call(e,t)&&Vd(i,t,e[t]);if(kd)for(var t of kd(e))f5.call(e,t)&&Vd(i,t,e[t]);return i},uu=(i,e)=>u5(i,h5(e));class hh{constructor(e){this.events=new Ku,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||qd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new hh(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Wo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(l=>t(null,da(c,l))).catch(l=>t(l,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:wt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const l=Zx(c.namespaces);this.namespaces=Hd(this.namespaces,l),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==ug)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(oi(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await jx.init({logger:this.providerOpts.logger||qd,relayUrl:this.providerOpts.relayUrl||zx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ws(t)))];cu("client",this.client),cu("events",this.events),cu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=Qx(t,this.session),o=lg(s),c=Hd(this.namespaces,this.optionalNamespaces),l=uu(Wo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new t5({namespace:l});break;case"solana":this.rpcProviders[t]=new r5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new i5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new e5({namespace:l});break;case"cip34":this.rpcProviders[t]=new n5({namespace:l});break;case"elrond":this.rpcProviders[t]=new s5({namespace:l});break;case"multiversx":this.rpcProviders[t]=new o5({namespace:l});break;case"near":this.rpcProviders[t]=new a5({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&oi(o)&&this.events.emit("accountsChanged",o.map(Xx))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=ws(o),f=au(o)!==au(c)?`${l}:${au(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=uu(Wo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",uu(Wo({},wt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>ws(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=ws(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Fd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Fd}/${e}`)}}const d5=hh,p5="wc",g5="ethereum_provider",y5=`${p5}@2:${g5}:`,v5="https://rpc.walletconnect.com/v1/",Fu=["eth_sendTransaction","personal_sign"],_5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],zu=["chainChanged","accountsChanged"],m5=["chainChanged","accountsChanged","message","disconnect","connect"];var w5=Object.defineProperty,b5=Object.defineProperties,E5=Object.getOwnPropertyDescriptors,Gd=Object.getOwnPropertySymbols,D5=Object.prototype.hasOwnProperty,S5=Object.prototype.propertyIsEnumerable,Wd=(i,e,t)=>e in i?w5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Es=(i,e)=>{for(var t in e||(e={}))D5.call(e,t)&&Wd(i,t,e[t]);if(Gd)for(var t of Gd(e))S5.call(e,t)&&Wd(i,t,e[t]);return i},Yd=(i,e)=>b5(i,E5(e));function na(i){return Number(i[0].split(":")[1])}function hu(i){return`0x${i.toString(16)}`}function I5(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=i;if(!oi(e))throw new Error("Invalid chains");const g={chains:e,methods:s||Fu,events:c||zu,rpcMap:Es({},e.length?{[na(e)]:f[na(e)]}:{})},p=c==null?void 0:c.filter(x=>!zu.includes(x)),v=s==null?void 0:s.filter(x=>!Fu.includes(x));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(v!=null&&v.length))return{required:e.length?g:void 0};const D=(p==null?void 0:p.length)&&(v==null?void 0:v.length)||!t,S={chains:[...new Set(D?g.chains.concat(t||[]):t)],methods:[...new Set(g.methods.concat(o!=null&&o.length?o:_5))],events:[...new Set(g.events.concat(l!=null&&l.length?l:m5))],rpcMap:f};return{required:e.length?g:void 0,optional:t.length?S:void 0}}class lh{constructor(){this.events=new zr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=y5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new lh;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=I5(this.rpc);try{const o=await new Promise(async(l,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Yd(Es({namespaces:Es({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=LE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:hu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",hu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Yd(Es({},wt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",hu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Fu:[],g=o.length?(e==null?void 0:e.events)||zu:[],p=(e==null?void 0:e.optionalMethods)||[],v=(e==null?void 0:e.optionalEvents)||[],D=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),S=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(x=>this.formatChainId(x)),optionalChains:c.map(x=>this.formatChainId(x)),methods:f,events:g,optionalMethods:p,optionalEvents:v,rpcMap:D,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:S,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?na(this.rpc.chains):na(this.rpc.optionalChains),this.signer=await d5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await Vw(()=>import("./index-D53tWqTb.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Es({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&oi(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&oi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${v5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const K5=lh;export{K5 as EthereumProvider,m5 as OPTIONAL_EVENTS,_5 as OPTIONAL_METHODS,zu as REQUIRED_EVENTS,Fu as REQUIRED_METHODS,lh as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-D53tWqTb.js","assets/index-DnmWLAUw.js","assets/index-Da-I2dkT.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
